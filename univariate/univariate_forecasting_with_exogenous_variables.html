<!DOCTYPE html> <html lang=en > <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /><meta name=generator  content="Docutils 0.19: https://docutils.sourceforge.io/" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="../_static/javascripts/modernizr.js"></script> <title>Forecasting with Exogenous Regressors &#8212; arch 5.4.0 documentation</title> <link rel=apple-touch-icon  sizes=180x180  href="../_static/images/apple-touch-icon.png"> <link rel=icon  type="image/png" sizes=32x32  href="../_static/images/favicon-32x32.png"> <link rel=icon  type="image/png" sizes=16x16  href="../_static/images/favicon-16x16.png"> <link rel=manifest  href="../_static/images/site.webmanifest"> <link rel=mask-icon  href="../_static/images/safari-pinned-tab.svg" color="#2196f3"> <meta name=msapplication-TileColor  content="#2b5797"> <meta name=msapplication-config  content="../_static/images/browserconfig.xml"> <link rel=stylesheet  type="text/css" href="../_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="../_static/material.css" /> <link rel=stylesheet  type="text/css" href="../_static/nbsphinx-code-cells.css" /> <link rel=stylesheet  type="text/css" href="../_static/css/small_fixes.css" /> <script data-url_root="../" id=documentation_options  src="../_static/documentation_options.js"></script> <script src="../_static/doctools.js"></script> <script src="../_static/sphinx_highlight.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script> <script defer=defer  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <link rel=icon  href="../_static/favicon.ico"/> <link rel=index  title=Index  href="../genindex.html" /> <link rel=search  title=Search  href="../search.html" /> <link rel=next  title="Mean Models" href=mean.html  /> <link rel=prev  title="Volatility Scenarios" href=univariate_volatility_scenarios.html  /> <body dir=ltr data-md-color-primary=blue data-md-color-accent=indigo> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#univariate/univariate_forecasting_with_exogenous_variables" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../index.html" title="arch 5.4.0 documentation" class="md-header-nav__button md-logo"> &nbsp; </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >arch 5.4.0</span> <span class=md-header-nav__topic > Forecasting with Exogenous Regressors </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../search.html" method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source > <a href="https://github.com/bashtage/arch/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > ARCH </div> </a> </div> </div> <div class="md-flex__cell md-flex__cell--shrink dropdown"> <button class=dropdownbutton >Versions</button> <div class="dropdown-content md-hero"> <a title=Release  href="https://bashtage.github.io/arch/">Release</a> <a title=Development  href="https://bashtage.github.io/arch/devel/">Development</a> <a title="RTD (Release)" href="https://arch.readthedocs.io/">RTD (Release)</a> </div> </div> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href=univariate.html  class=md-tabs__link >Univariate Volatility Models</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../index.html" title="arch 5.4.0 documentation" class="md-nav__button md-logo"> <img src="../_static/" alt=" logo" width=48  height=48 > </a> <a href="../index.html" title="arch 5.4.0 documentation">arch 5.4.0</a> </label> <div class=md-nav__source > <a href="https://github.com/bashtage/arch/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > ARCH </div> </a> </div> <ul class=md-nav__list > <li class=md-nav__item > <a href=univariate.html  class=md-nav__link >Univariate Volatility Models</a> <ul class=md-nav__list > <li class=md-nav__item > <a href=introduction.html  class=md-nav__link >Introduction</a> <li class=md-nav__item > <a href=univariate_volatility_modeling.html  class=md-nav__link >Examples</a> <li class=md-nav__item > <a href=forecasting.html  class=md-nav__link >Forecasting</a> <li class=md-nav__item > <a href=univariate_volatility_forecasting.html  class=md-nav__link >Volatility Forecasting</a> <li class=md-nav__item > <a href="univariate_volatility_forecasting.html#Value-at-Risk-Forecasting" class=md-nav__link >Value-at-Risk Forecasting</a> <li class=md-nav__item > <a href=univariate_volatility_scenarios.html  class=md-nav__link >Forecasting Scenarios</a> <li class=md-nav__item > <input class="md-toggle md-nav__toggle" data-md-toggle=toc  type=checkbox  id=__toc > <label class="md-nav__link md-nav__link--active" for=__toc > Forecasting with Exogenous Variables </label> <a href="#" class="md-nav__link md-nav__link--active">Forecasting with Exogenous Variables</a> <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#univariate-univariate-forecasting-with-exogenous-variables--page-root" class=md-nav__link >Forecasting with Exogenous Regressors</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Simulating-data" class=md-nav__link >Simulating data</a> <li class=md-nav__item ><a href="#Plotting-the-data" class=md-nav__link >Plotting the data</a> <li class=md-nav__item ><a href="#Forecasting-the-X-values" class=md-nav__link >Forecasting the X values</a> <li class=md-nav__item ><a href="#Fitting-the-model" class=md-nav__link >Fitting the model</a> <li class=md-nav__item ><a href="#Using-a-dict" class=md-nav__link >Using a <code class="docutils literal notranslate"><span class=pre >dict</span></code></a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Using-DataFrame" class=md-nav__link >Using <code class="docutils literal notranslate"><span class=pre >DataFrame</span></code></a> </ul> </nav> <li class=md-nav__item ><a href="#Using-an-array" class=md-nav__link >Using an <code class="docutils literal notranslate"><span class=pre >array</span></code></a> <li class=md-nav__item ><a href="#Producing-multiple-forecasts" class=md-nav__link >Producing multiple forecasts</a> <li class=md-nav__item ><a href="#x-input-array-sizes" class=md-nav__link ><code class="docutils literal notranslate"><span class=pre >x</span></code> input array sizes</a> <li class=md-nav__item ><a href="#Special-Cases-with-a-single-x-variable" class=md-nav__link >Special Cases with a single <code class="docutils literal notranslate"><span class=pre >x</span></code> variable</a> <li class=md-nav__item ><a href="#Simulation" class=md-nav__link >Simulation</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Static-out-of-sample-x" class=md-nav__link >Static out-of-sample <code class="docutils literal notranslate"><span class=pre >x</span></code></a> <li class=md-nav__item ><a href="#Simulating-the-out-of-sample-x" class=md-nav__link >Simulating the out-of-sample <code class="docutils literal notranslate"><span class=pre >x</span></code></a> </ul> </nav> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../_sources/univariate/univariate_forecasting_with_exogenous_variables.ipynb.txt">Show Source</a> </ul> </nav> <li class=md-nav__item > <a href=mean.html  class=md-nav__link >Mean Models</a> <li class=md-nav__item > <a href=volatility.html  class=md-nav__link >Volatility Processes</a> <li class=md-nav__item > <a href=univariate_using_fixed_variance.html  class=md-nav__link >Using the Fixed Variance Process</a> <li class=md-nav__item > <a href=distribution.html  class=md-nav__link >Distributions</a> <li class=md-nav__item > <a href=results.html  class=md-nav__link >Results</a> <li class=md-nav__item > <a href=utility.html  class=md-nav__link >Utilities</a> <li class=md-nav__item > <a href=background.html  class=md-nav__link >Background and References</a> </ul> <li class=md-nav__item > <a href="../bootstrap/bootstrap.html" class=md-nav__link >Bootstrapping</a> <li class=md-nav__item > <a href="../multiple-comparison/multiple-comparisons.html" class=md-nav__link >Multiple Comparison Problems</a> <li class=md-nav__item > <a href="../unitroot/unitroot.html" class=md-nav__link >Unit Root Testing</a> <li class=md-nav__item > <a href="../unitroot/unitroot.html#cointegration-analysis" class=md-nav__link >Cointegration Analysis</a> <li class=md-nav__item > <a href="../covariance/covariance.html" class=md-nav__link >Long-run Covariance Estimation</a> <li class=md-nav__item > <a href="../api.html" class=md-nav__link >API Reference</a> <li class=md-nav__item > <a href="../changes.html" class=md-nav__link >Change Log</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <label class=md-nav__title  for=__toc >Contents</label> <ul class=md-nav__list  data-md-scrollfix=""> <li class=md-nav__item ><a href="#univariate-univariate-forecasting-with-exogenous-variables--page-root" class=md-nav__link >Forecasting with Exogenous Regressors</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Simulating-data" class=md-nav__link >Simulating data</a> <li class=md-nav__item ><a href="#Plotting-the-data" class=md-nav__link >Plotting the data</a> <li class=md-nav__item ><a href="#Forecasting-the-X-values" class=md-nav__link >Forecasting the X values</a> <li class=md-nav__item ><a href="#Fitting-the-model" class=md-nav__link >Fitting the model</a> <li class=md-nav__item ><a href="#Using-a-dict" class=md-nav__link >Using a <code class="docutils literal notranslate"><span class=pre >dict</span></code></a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Using-DataFrame" class=md-nav__link >Using <code class="docutils literal notranslate"><span class=pre >DataFrame</span></code></a> </ul> </nav> <li class=md-nav__item ><a href="#Using-an-array" class=md-nav__link >Using an <code class="docutils literal notranslate"><span class=pre >array</span></code></a> <li class=md-nav__item ><a href="#Producing-multiple-forecasts" class=md-nav__link >Producing multiple forecasts</a> <li class=md-nav__item ><a href="#x-input-array-sizes" class=md-nav__link ><code class="docutils literal notranslate"><span class=pre >x</span></code> input array sizes</a> <li class=md-nav__item ><a href="#Special-Cases-with-a-single-x-variable" class=md-nav__link >Special Cases with a single <code class="docutils literal notranslate"><span class=pre >x</span></code> variable</a> <li class=md-nav__item ><a href="#Simulation" class=md-nav__link >Simulation</a><nav class=md-nav > <ul class=md-nav__list > <li class=md-nav__item ><a href="#Static-out-of-sample-x" class=md-nav__link >Static out-of-sample <code class="docutils literal notranslate"><span class=pre >x</span></code></a> <li class=md-nav__item ><a href="#Simulating-the-out-of-sample-x" class=md-nav__link >Simulating the out-of-sample <code class="docutils literal notranslate"><span class=pre >x</span></code></a> </ul> </nav> </ul> </nav> <li class=md-nav__item ><a class=md-nav__extra_link  href="../_sources/univariate/univariate_forecasting_with_exogenous_variables.ipynb.txt">Show Source</a> <li id=searchbox  class=md-nav__item > </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <section id=Forecasting-with-Exogenous-Regressors > <h1 id=univariate-univariate-forecasting-with-exogenous-variables--page-root >Forecasting with Exogenous Regressors<a class=headerlink  href="#univariate-univariate-forecasting-with-exogenous-variables--page-root" title="Permalink to this heading">¶</a></h1> <p>This notebook provides examples of the accepted data structures for passing the expected value of exogenous variables when these are included in the mean. For example, consider an AR(1) with 2 exogenous variables. The mean dynamics are</p> <div class="math notranslate nohighlight"> \[Y_t = \phi_0 + \phi_1 Y_{t-1} + \beta_0 X_{0,t} + \beta_1 X_{1,t} + \epsilon_t.\]</div> <p>The <span class="math notranslate nohighlight">\(h\)</span>-step forecast, <span class="math notranslate nohighlight">\(E_{T}[Y_{t+h}]\)</span>, depends on the conditional expectation of <span class="math notranslate nohighlight">\(X_{0,T+h}\)</span> and <span class="math notranslate nohighlight">\(X_{1,T+h}\)</span>,</p> <div class="math notranslate nohighlight"> \[E_{T}[Y_{T+h}] = \phi_0 + \phi_1 E_{T}[Y_{T+h-1}] + \beta_0 E_{T}[X_{0,T+h}] +\beta_1 E_{T}[X_{1,T+h}]\]</div> <p>where <span class="math notranslate nohighlight">\(E_{T}[Y_{T+h-1}]\)</span> has been recursively computed.</p> <p>In order to construct forecasts up to some horizon <span class="math notranslate nohighlight">\(h\)</span>, it is necessary to pass <span class="math notranslate nohighlight">\(2\times h\)</span> values (<span class="math notranslate nohighlight">\(h\)</span> for each series). If using the features of <code class="docutils literal notranslate"><span class=pre >forecast</span></code> that allow many forecast to be specified, it necessary to supply <span class="math notranslate nohighlight">\(n \times 2 \times h\)</span> values.</p> <p>There are two general purpose data structures that can be used for any number of exogenous variables and any number steps ahead:</p> <ul class=simple > <li><p><code class="docutils literal notranslate"><span class=pre >dict</span></code> - The values can be pass using a <code class="docutils literal notranslate"><span class=pre >dict</span></code> where the keys are the variable names and the values are 2-dimensional arrays. This is the most natural generalization of a pandas <code class="docutils literal notranslate"><span class=pre >DataFrame</span></code> to 3-dimensions.</p> <li><p><code class="docutils literal notranslate"><span class=pre >array</span></code> - The vales can alternatively be passed as a 3-d NumPy <code class="docutils literal notranslate"><span class=pre >array</span></code> where dimension 0 tracks the regressor index, dimension 1 is the time period and dimension 2 is the horizon.</p> </ul> <p>When a model contains a single exogenous regressor it is possible to use a 2-d array or <code class="docutils literal notranslate"><span class=pre >DataFrame</span></code> where dim0 tracks the time period where the forecast is generated and dimension 1 tracks the horizon.</p> <p>In the special case where a model contains a single regressor <em>and</em> the horizon is 1, then a 1-d array of pandas Series can be used.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[1]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=c1 ># initial setup</span>
<span class=o >%</span><span class=k >matplotlib</span> inline

<span class=kn >import</span> <span class=nn >matplotlib.pyplot</span> <span class=k >as</span> <span class=nn >plt</span>
<span class=kn >import</span> <span class=nn >numpy</span> <span class=k >as</span> <span class=nn >np</span>
<span class=kn >import</span> <span class=nn >pandas</span> <span class=k >as</span> <span class=nn >pd</span>
<span class=kn >import</span> <span class=nn >seaborn</span>
<span class=kn >from</span> <span class=nn >arch.__future__</span> <span class=kn >import</span> <span class=n >reindexing</span>

<span class=n >seaborn</span><span class=o >.</span><span class=n >set_style</span><span class=p >(</span><span class=s2 >"darkgrid"</span><span class=p >)</span>
<span class=n >plt</span><span class=o >.</span><span class=n >rc</span><span class=p >(</span><span class=s2 >"figure"</span><span class=p >,</span> <span class=n >figsize</span><span class=o >=</span><span class=p >(</span><span class=mi >16</span><span class=p >,</span> <span class=mi >6</span><span class=p >))</span>
<span class=n >plt</span><span class=o >.</span><span class=n >rc</span><span class=p >(</span><span class=s2 >"savefig"</span><span class=p >,</span> <span class=n >dpi</span><span class=o >=</span><span class=mi >90</span><span class=p >)</span>
<span class=n >plt</span><span class=o >.</span><span class=n >rc</span><span class=p >(</span><span class=s2 >"font"</span><span class=p >,</span> <span class=n >family</span><span class=o >=</span><span class=s2 >"sans-serif"</span><span class=p >)</span>
<span class=n >plt</span><span class=o >.</span><span class=n >rc</span><span class=p >(</span><span class=s2 >"font"</span><span class=p >,</span> <span class=n >size</span><span class=o >=</span><span class=mi >14</span><span class=p >)</span>
</pre></div> </div> </div> <section id=Simulating-data > <h2 id=Simulating-data >Simulating data<a class=headerlink  href="#Simulating-data" title="Permalink to this heading">¶</a></h2> <p>Two <span class="math notranslate nohighlight">\(X\)</span> variables are simulated and are assumed to follow independent AR(1) processes. The data is then assumed to follow an ARX(1) with 2 exogenous regressors and GARCH(1,1) errors.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[2]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >arch.univariate</span> <span class=kn >import</span> <span class=n >ARX</span><span class=p >,</span> <span class=n >GARCH</span><span class=p >,</span> <span class=n >ZeroMean</span><span class=p >,</span> <span class=n >arch_model</span>

<span class=n >burn</span> <span class=o >=</span> <span class=mi >250</span>

<span class=n >x_mod</span> <span class=o >=</span> <span class=n >ARX</span><span class=p >(</span><span class=kc >None</span><span class=p >,</span> <span class=n >lags</span><span class=o >=</span><span class=mi >1</span><span class=p >)</span>
<span class=n >x0</span> <span class=o >=</span> <span class=n >x_mod</span><span class=o >.</span><span class=n >simulate</span><span class=p >([</span><span class=mi >1</span><span class=p >,</span> <span class=mf >0.8</span><span class=p >,</span> <span class=mi >1</span><span class=p >],</span> <span class=n >nobs</span><span class=o >=</span><span class=mi >1000</span> <span class=o >+</span> <span class=n >burn</span><span class=p >)</span><span class=o >.</span><span class=n >data</span>
<span class=n >x1</span> <span class=o >=</span> <span class=n >x_mod</span><span class=o >.</span><span class=n >simulate</span><span class=p >([</span><span class=mf >2.5</span><span class=p >,</span> <span class=mf >0.5</span><span class=p >,</span> <span class=mi >1</span><span class=p >],</span> <span class=n >nobs</span><span class=o >=</span><span class=mi >1000</span> <span class=o >+</span> <span class=n >burn</span><span class=p >)</span><span class=o >.</span><span class=n >data</span>

<span class=n >resid_mod</span> <span class=o >=</span> <span class=n >ZeroMean</span><span class=p >(</span><span class=n >volatility</span><span class=o >=</span><span class=n >GARCH</span><span class=p >())</span>
<span class=n >resids</span> <span class=o >=</span> <span class=n >resid_mod</span><span class=o >.</span><span class=n >simulate</span><span class=p >([</span><span class=mf >0.1</span><span class=p >,</span> <span class=mf >0.1</span><span class=p >,</span> <span class=mf >0.8</span><span class=p >],</span> <span class=n >nobs</span><span class=o >=</span><span class=mi >1000</span> <span class=o >+</span> <span class=n >burn</span><span class=p >)</span><span class=o >.</span><span class=n >data</span>

<span class=n >phi1</span> <span class=o >=</span> <span class=mf >0.7</span>
<span class=n >phi0</span> <span class=o >=</span> <span class=mi >3</span>
<span class=n >y</span> <span class=o >=</span> <span class=mi >10</span> <span class=o >+</span> <span class=n >resids</span><span class=o >.</span><span class=n >copy</span><span class=p >()</span>
<span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >1</span><span class=p >,</span> <span class=n >y</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]):</span>
    <span class=n >y</span><span class=p >[</span><span class=n >i</span><span class=p >]</span> <span class=o >=</span> <span class=n >phi0</span> <span class=o >+</span> <span class=n >phi1</span> <span class=o >*</span> <span class=n >y</span><span class=p >[</span><span class=n >i</span> <span class=o >-</span> <span class=mi >1</span><span class=p >]</span> <span class=o >+</span> <span class=mi >2</span> <span class=o >*</span> <span class=n >x0</span><span class=p >[</span><span class=n >i</span><span class=p >]</span> <span class=o >-</span> <span class=mi >2</span> <span class=o >*</span> <span class=n >x1</span><span class=p >[</span><span class=n >i</span><span class=p >]</span> <span class=o >+</span> <span class=n >resids</span><span class=p >[</span><span class=n >i</span><span class=p >]</span>

<span class=n >x0</span> <span class=o >=</span> <span class=n >x0</span><span class=o >.</span><span class=n >iloc</span><span class=p >[</span><span class=o >-</span><span class=mi >1000</span><span class=p >:]</span>
<span class=n >x1</span> <span class=o >=</span> <span class=n >x1</span><span class=o >.</span><span class=n >iloc</span><span class=p >[</span><span class=o >-</span><span class=mi >1000</span><span class=p >:]</span>
<span class=n >y</span> <span class=o >=</span> <span class=n >y</span><span class=o >.</span><span class=n >iloc</span><span class=p >[</span><span class=o >-</span><span class=mi >1000</span><span class=p >:]</span>
<span class=n >y</span><span class=o >.</span><span class=n >index</span> <span class=o >=</span> <span class=n >x0</span><span class=o >.</span><span class=n >index</span> <span class=o >=</span> <span class=n >x1</span><span class=o >.</span><span class=n >index</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >arange</span><span class=p >(</span><span class=mi >1000</span><span class=p >)</span>
</pre></div> </div> </div> </section> <section id=Plotting-the-data > <h2 id=Plotting-the-data >Plotting the data<a class=headerlink  href="#Plotting-the-data" title="Permalink to this heading">¶</a></h2> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[3]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >ax</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >({</span><span class=s2 >"ARX"</span><span class=p >:</span> <span class=n >y</span><span class=p >})</span><span class=o >.</span><span class=n >plot</span><span class=p >(</span><span class=n >legend</span><span class=o >=</span><span class=kc >False</span><span class=p >)</span>
<span class=n >ax</span><span class=o >.</span><span class=n >legend</span><span class=p >(</span><span class=n >frameon</span><span class=o >=</span><span class=kc >False</span><span class=p >)</span>
<span class=n >_</span> <span class=o >=</span> <span class=n >ax</span><span class=o >.</span><span class=n >set_xlim</span><span class=p >(</span><span class=mi >0</span><span class=p >,</span> <span class=mi >999</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/univariate_univariate_forecasting_with_exogenous_variables_5_0.png" src="../_images/univariate_univariate_forecasting_with_exogenous_variables_5_0.png"/> </div> </div> </section> <section id=Forecasting-the-X-values > <h2 id=Forecasting-the-X-values >Forecasting the X values<a class=headerlink  href="#Forecasting-the-X-values" title="Permalink to this heading">¶</a></h2> <p>The forecasts of <span class="math notranslate nohighlight">\(Y\)</span> depend on forecasts of <span class="math notranslate nohighlight">\(X_0\)</span> and <span class="math notranslate nohighlight">\(X_1\)</span>. Both of these follow simple AR(1), and so we can construct the forecasts for all time horizons. Note that the value in position <code class="docutils literal notranslate"><span class=pre >[i,j]</span></code> is the time-<code class="docutils literal notranslate"><span class=pre >i</span></code> forecast for horizon <code class="docutils literal notranslate"><span class=pre >j+1</span></code>.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[4]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >x0_oos</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >empty</span><span class=p >((</span><span class=mi >1000</span><span class=p >,</span> <span class=mi >10</span><span class=p >))</span>
<span class=n >x1_oos</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >empty</span><span class=p >((</span><span class=mi >1000</span><span class=p >,</span> <span class=mi >10</span><span class=p >))</span>
<span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >10</span><span class=p >):</span>
    <span class=k >if</span> <span class=n >i</span> <span class=o >==</span> <span class=mi >0</span><span class=p >:</span>
        <span class=n >last</span> <span class=o >=</span> <span class=n >x0</span>
    <span class=k >else</span><span class=p >:</span>
        <span class=n >last</span> <span class=o >=</span> <span class=n >x0_oos</span><span class=p >[:,</span> <span class=n >i</span> <span class=o >-</span> <span class=mi >1</span><span class=p >]</span>
    <span class=n >x0_oos</span><span class=p >[:,</span> <span class=n >i</span><span class=p >]</span> <span class=o >=</span> <span class=mi >1</span> <span class=o >+</span> <span class=mf >0.8</span> <span class=o >*</span> <span class=n >last</span>
    <span class=k >if</span> <span class=n >i</span> <span class=o >==</span> <span class=mi >0</span><span class=p >:</span>
        <span class=n >last</span> <span class=o >=</span> <span class=n >x1</span>
    <span class=k >else</span><span class=p >:</span>
        <span class=n >last</span> <span class=o >=</span> <span class=n >x1_oos</span><span class=p >[:,</span> <span class=n >i</span> <span class=o >-</span> <span class=mi >1</span><span class=p >]</span>
    <span class=n >x1_oos</span><span class=p >[:,</span> <span class=n >i</span><span class=p >]</span> <span class=o >=</span> <span class=mf >2.5</span> <span class=o >+</span> <span class=mf >0.5</span> <span class=o >*</span> <span class=n >last</span>

<span class=n >x1_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >]</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[4]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([5.32610653, 5.16305327, 5.08152663, 5.04076332, 5.02038166,
       5.01019083, 5.00509541, 5.00254771, 5.00127385, 5.00063693])
</pre></div></div> </div> </section> <section id=Fitting-the-model > <h2 id=Fitting-the-model >Fitting the model<a class=headerlink  href="#Fitting-the-model" title="Permalink to this heading">¶</a></h2> <p>Next, the most is fit. The parameters are accurately estimated.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[5]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >exog</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >({</span><span class=s2 >"x0"</span><span class=p >:</span> <span class=n >x0</span><span class=p >,</span> <span class=s2 >"x1"</span><span class=p >:</span> <span class=n >x1</span><span class=p >})</span>
<span class=n >mod</span> <span class=o >=</span> <span class=n >arch_model</span><span class=p >(</span><span class=n >y</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >exog</span><span class=p >,</span> <span class=n >mean</span><span class=o >=</span><span class=s2 >"ARX"</span><span class=p >,</span> <span class=n >lags</span><span class=o >=</span><span class=mi >1</span><span class=p >)</span>
<span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >disp</span><span class=o >=</span><span class=s2 >"off"</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=o >.</span><span class=n >summary</span><span class=p >())</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                          AR-X - GARCH Model Results
==============================================================================
Dep. Variable:                   data   R-squared:                       0.993
Mean Model:                      AR-X   Adj. R-squared:                  0.993
Vol Model:                      GARCH   Log-Likelihood:               -1302.15
Distribution:                  Normal   AIC:                           2618.31
Method:            Maximum Likelihood   BIC:                           2652.65
                                        No. Observations:                  999
Date:                Mon, May 17 2021   Df Residuals:                      995
Time:                        16:04:11   Df Model:                            4
                               Mean Model
========================================================================
                 coef    std err          t      P&gt;|t|  95.0% Conf. Int.
------------------------------------------------------------------------
Const          2.9480      0.149     19.818  2.088e-87 [  2.656,  3.240]
data[1]        0.6971  3.421e-03    203.759      0.000 [  0.690,  0.704]
x0             2.0186  2.063e-02     97.827      0.000 [  1.978,  2.059]
x1            -2.0115  2.483e-02    -81.001      0.000 [ -2.060, -1.963]
                              Volatility Model
===========================================================================
                 coef    std err          t      P&gt;|t|     95.0% Conf. Int.
---------------------------------------------------------------------------
omega          0.1144  5.879e-02      1.946  5.162e-02 [-8.041e-04,  0.230]
alpha[1]       0.0633  2.982e-02      2.123  3.374e-02  [4.866e-03,  0.122]
beta[1]        0.7940  9.035e-02      8.788  1.522e-18    [  0.617,  0.971]
===========================================================================

Covariance estimator: robust
</pre></div></div> </div> </section> <section id=Using-a-dict > <h2 id=Using-a-dict >Using a <code class="docutils literal notranslate"><span class=pre >dict</span></code><a class=headerlink  href="#Using-a-dict" title="Permalink to this heading">¶</a></h2> <p>The first approach uses a dict to pass the two variables. The key consideration here is the the keys of the dictionary must <strong>exactly</strong> match the variable names (<code class="docutils literal notranslate"><span class=pre >x0</span></code> and <code class="docutils literal notranslate"><span class=pre >x1</span></code> here). The dictionary here contains only the final row of the forecast values since <code class="docutils literal notranslate"><span class=pre >forecast</span></code> will only make forecasts beginning from the final in-sample observation by default.</p> <section id=Using-DataFrame > <h3 id=Using-DataFrame >Using <code class="docutils literal notranslate"><span class=pre >DataFrame</span></code><a class=headerlink  href="#Using-DataFrame" title="Permalink to this heading">¶</a></h3> <p>While these examples make use of NumPy arrays, these can be <code class="docutils literal notranslate"><span class=pre >DataFrames</span></code>. This allows the index to be used to track the forecast origination point, which can be a helpful device.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[6]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >exog_fcast</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"x0"</span><span class=p >:</span> <span class=n >x0_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >:],</span> <span class=s2 >"x1"</span><span class=p >:</span> <span class=n >x1_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >:]}</span>
<span class=n >forecasts</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span><span class=n >horizon</span><span class=o >=</span><span class=mi >10</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >exog_fcast</span><span class=p >)</span>
<span class=n >forecasts</span><span class=o >.</span><span class=n >mean</span><span class=o >.</span><span class=n >T</span><span class=o >.</span><span class=n >plot</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[6]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
&lt;AxesSubplot:&gt;
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/univariate_univariate_forecasting_with_exogenous_variables_11_1.png" src="../_images/univariate_univariate_forecasting_with_exogenous_variables_11_1.png"/> </div> </div> </section> </section> <section id=Using-an-array > <h2 id=Using-an-array >Using an <code class="docutils literal notranslate"><span class=pre >array</span></code><a class=headerlink  href="#Using-an-array" title="Permalink to this heading">¶</a></h2> <p>An array can alternatively be used. This frees the restriction on matching the variable names although the order must match instead. The forecast values are 2 (variables) by 1 (forecast) by 10 (horizon).</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[7]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >exog_fcast</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([</span><span class=n >x0_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >:],</span> <span class=n >x1_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >:]])</span>
<span class=nb >print</span><span class=p >(</span><span class=sa >f</span><span class=s2 >"The shape is </span><span class=si >{</span><span class=n >exog_fcast</span><span class=o >.</span><span class=n >shape</span><span class=si >}</span><span class=s2 >"</span><span class=p >)</span>
<span class=n >array_forecasts</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span><span class=n >horizon</span><span class=o >=</span><span class=mi >10</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >exog_fcast</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >array_forecasts</span><span class=o >.</span><span class=n >mean</span> <span class=o >-</span> <span class=n >forecasts</span><span class=o >.</span><span class=n >mean</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
The shape is (2, 1, 10)
     h.01  h.02  h.03  h.04  h.05  h.06  h.07  h.08  h.09  h.10
999   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
</pre></div></div> </div> </section> <section id=Producing-multiple-forecasts > <h2 id=Producing-multiple-forecasts >Producing multiple forecasts<a class=headerlink  href="#Producing-multiple-forecasts" title="Permalink to this heading">¶</a></h2> <p><code class="docutils literal notranslate"><span class=pre >forecast</span></code> can produce multiple forecasts using the same fit model. Here the model is fit to the first 500 observations and then forecasting for the remaining values are produced. It must be the case that the <code class="docutils literal notranslate"><span class=pre >x</span></code> values passed for <code class="docutils literal notranslate"><span class=pre >forecast</span></code> have the same number of rows as the table of forecasts produced.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[8]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >disp</span><span class=o >=</span><span class=s2 >"off"</span><span class=p >,</span> <span class=n >last_obs</span><span class=o >=</span><span class=mi >500</span><span class=p >)</span>
<span class=n >exog_fcast</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"x0"</span><span class=p >:</span> <span class=n >x0_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >500</span><span class=p >:],</span> <span class=s2 >"x1"</span><span class=p >:</span> <span class=n >x1_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >500</span><span class=p >:]}</span>
<span class=n >multi_forecasts</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span><span class=n >start</span><span class=o >=</span><span class=mi >500</span><span class=p >,</span> <span class=n >horizon</span><span class=o >=</span><span class=mi >10</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >exog_fcast</span><span class=p >)</span>
<span class=n >multi_forecasts</span><span class=o >.</span><span class=n >mean</span><span class=o >.</span><span class=n >tail</span><span class=p >(</span><span class=mi >10</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[8]:
</pre></div> </div> <div class="output_area rendered_html docutils container"> <div> <style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } </style> <table border=1  class=dataframe > <thead> <tr style="text-align: right;"> <th> <th>h.01 <th>h.02 <th>h.03 <th>h.04 <th>h.05 <th>h.06 <th>h.07 <th>h.08 <th>h.09 <th>h.10 <tr> <th>990 <td>0.197255 <td>0.766334 <td>1.577107 <td>2.505601 <td>3.459461 <td>4.377620 <td>5.224185 <td>5.981486 <td>6.644090 <td>7.214210 <tr> <th>991 <td>-1.890108 <td>-1.296009 <td>-0.321045 <td>0.826688 <td>2.010886 <td>3.148451 <td>4.193448 <td>5.124665 <td>5.936575 <td>6.633031 <tr> <th>992 <td>-8.507089 <td>-7.755860 <td>-6.044790 <td>-4.011246 <td>-1.975703 <td>-0.089727 <td>1.584868 <td>3.033252 <td>4.264283 <td>5.297785 <tr> <th>993 <td>-12.095946 <td>-10.869621 <td>-8.890602 <td>-6.627904 <td>-4.352285 <td>-2.211499 <td>-0.277740 <td>1.422307 <td>2.888448 <td>4.135017 <tr> <th>994 <td>-10.415586 <td>-8.143577 <td>-5.654791 <td>-3.258179 <td>-1.089347 <td>0.805444 <td>2.424787 <td>3.788488 <td>4.925033 <td>5.865051 <tr> <th>995 <td>-1.921109 <td>1.075917 <td>3.299730 <td>4.950490 <td>6.178127 <td>7.093677 <td>7.778853 <td>8.293623 <td>8.681971 <td>8.976192 <tr> <th>996 <td>-0.935776 <td>1.954178 <td>4.178160 <td>5.832262 <td>7.036522 <td>7.901080 <td>8.515904 <td>8.950270 <td>9.255725 <td>9.469814 <tr> <th>997 <td>2.416878 <td>4.689798 <td>6.409599 <td>7.650164 <td>8.515074 <td>9.101508 <td>9.488851 <td>9.737583 <td>9.891902 <td>9.983206 <tr> <th>998 <td>4.633381 <td>6.555164 <td>8.072909 <td>9.153335 <td>9.864477 <td>10.296675 <td>10.532205 <td>10.636352 <td>10.657221 <td>10.628546 <tr> <th>999 <td>10.573900 <td>12.317818 <td>13.245648 <td>13.612879 <td>13.620680 <td>13.415346 <td>13.097526 <td>12.733225 <td>12.363590 <td>12.012647 </table> </div></div> </div> <p>The plot of the final 5 forecast paths shows the the mean reversion of the process.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[9]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >_</span> <span class=o >=</span> <span class=n >multi_forecasts</span><span class=o >.</span><span class=n >mean</span><span class=o >.</span><span class=n >tail</span><span class=p >()</span><span class=o >.</span><span class=n >T</span><span class=o >.</span><span class=n >plot</span><span class=p >()</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <img alt="../_images/univariate_univariate_forecasting_with_exogenous_variables_17_0.png" src="../_images/univariate_univariate_forecasting_with_exogenous_variables_17_0.png"/> </div> </div> <p>The previous example made use of dictionaries where each of the values was a 500 (number of forecasts) by 10 (horizon) array. The alternative format can be used where <code class="docutils literal notranslate"><span class=pre >x</span></code> is a 3-d array with shape 2 (variables) by 500 (forecasts) by 10 (horizon).</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[10]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >exog_fcast</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([</span><span class=n >x0_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >500</span><span class=p >:],</span> <span class=n >x1_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >500</span><span class=p >:]])</span>
<span class=nb >print</span><span class=p >(</span><span class=n >exog_fcast</span><span class=o >.</span><span class=n >shape</span><span class=p >)</span>
<span class=n >array_multi_forecasts</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span><span class=n >start</span><span class=o >=</span><span class=mi >500</span><span class=p >,</span> <span class=n >horizon</span><span class=o >=</span><span class=mi >10</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >exog_fcast</span><span class=p >)</span>
<span class=n >np</span><span class=o >.</span><span class=n >max</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >abs</span><span class=p >(</span><span class=n >array_multi_forecasts</span><span class=o >.</span><span class=n >mean</span> <span class=o >-</span> <span class=n >multi_forecasts</span><span class=o >.</span><span class=n >mean</span><span class=p >))</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
(2, 500, 10)
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[10]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
h.01    0.0
h.02    0.0
h.03    0.0
h.04    0.0
h.05    0.0
h.06    0.0
h.07    0.0
h.08    0.0
h.09    0.0
h.10    0.0
dtype: float64
</pre></div></div> </div> </section> <section id=x-input-array-sizes > <h2 id=x-input-array-sizes ><code class="docutils literal notranslate"><span class=pre >x</span></code> input array sizes<a class=headerlink  href="#x-input-array-sizes" title="Permalink to this heading">¶</a></h2> <p>While the natural shape of the <code class="docutils literal notranslate"><span class=pre >x</span></code> data is the number of forecasts, it is also possible to pass an <code class="docutils literal notranslate"><span class=pre >x</span></code> that has the same shape as the <code class="docutils literal notranslate"><span class=pre >y</span></code> used to construct the model. The may simplify tracking the origin points of the forecast. Values are are not needed are ignored. In this example, the out-of-sample values are 2 by 1000 (original number of observations) by 10. Only the final 500 are used.</p> <div class="admonition warning"> <div class=admonition-title ><h3></h3></div><p>WARNING</p> <p>Other sizes are not allowed. The size of the out-of-sample data must either match the original data size or the number of forecasts.</p> </div> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[11]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >exog_fcast</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([</span><span class=n >x0_oos</span><span class=p >,</span> <span class=n >x1_oos</span><span class=p >])</span>
<span class=nb >print</span><span class=p >(</span><span class=n >exog_fcast</span><span class=o >.</span><span class=n >shape</span><span class=p >)</span>
<span class=n >array_multi_forecasts</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span><span class=n >start</span><span class=o >=</span><span class=mi >500</span><span class=p >,</span> <span class=n >horizon</span><span class=o >=</span><span class=mi >10</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >exog_fcast</span><span class=p >)</span>
<span class=n >np</span><span class=o >.</span><span class=n >max</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >abs</span><span class=p >(</span><span class=n >array_multi_forecasts</span><span class=o >.</span><span class=n >mean</span> <span class=o >-</span> <span class=n >multi_forecasts</span><span class=o >.</span><span class=n >mean</span><span class=p >))</span>
</pre></div> </div> </div> <div class="nboutput docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
(2, 1000, 10)
</pre></div></div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[11]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
h.01    0.0
h.02    0.0
h.03    0.0
h.04    0.0
h.05    0.0
h.06    0.0
h.07    0.0
h.08    0.0
h.09    0.0
h.10    0.0
dtype: float64
</pre></div></div> </div> </section> <section id=Special-Cases-with-a-single-x-variable > <h2 id=Special-Cases-with-a-single-x-variable >Special Cases with a single <code class="docutils literal notranslate"><span class=pre >x</span></code> variable<a class=headerlink  href="#Special-Cases-with-a-single-x-variable" title="Permalink to this heading">¶</a></h2> <p>When a model consists of a single exogenous regressor, then <code class="docutils literal notranslate"><span class=pre >x</span></code> can be a 1-d or 2-d array (or <code class="docutils literal notranslate"><span class=pre >Series</span></code> or <code class="docutils literal notranslate"><span class=pre >DataFrame</span></code>).</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[12]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >mod</span> <span class=o >=</span> <span class=n >arch_model</span><span class=p >(</span><span class=n >y</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >exog</span><span class=o >.</span><span class=n >iloc</span><span class=p >[:,</span> <span class=p >:</span><span class=mi >1</span><span class=p >],</span> <span class=n >mean</span><span class=o >=</span><span class=s2 >"ARX"</span><span class=p >,</span> <span class=n >lags</span><span class=o >=</span><span class=mi >1</span><span class=p >)</span>
<span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >disp</span><span class=o >=</span><span class=s2 >"off"</span><span class=p >)</span>
<span class=nb >print</span><span class=p >(</span><span class=n >res</span><span class=o >.</span><span class=n >summary</span><span class=p >())</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
                          AR-X - GARCH Model Results
==============================================================================
Dep. Variable:                   data   R-squared:                       0.949
Mean Model:                      AR-X   Adj. R-squared:                  0.949
Vol Model:                      GARCH   Log-Likelihood:               -2310.31
Distribution:                  Normal   AIC:                           4632.63
Method:            Maximum Likelihood   BIC:                           4662.07
                                        No. Observations:                  999
Date:                Mon, May 17 2021   Df Residuals:                      996
Time:                        16:04:11   Df Model:                            3
                               Mean Model
========================================================================
                 coef    std err          t      P&gt;|t|  95.0% Conf. Int.
------------------------------------------------------------------------
Const         -6.3468      0.283    -22.464 9.346e-112 [ -6.901, -5.793]
data[1]        0.7555  9.631e-03     78.446      0.000 [  0.737,  0.774]
x0             1.7840  6.195e-02     28.799 2.192e-182 [  1.663,  1.905]
                             Volatility Model
==========================================================================
                 coef    std err          t      P&gt;|t|    95.0% Conf. Int.
--------------------------------------------------------------------------
omega          3.0493      0.753      4.052  5.085e-05   [  1.574,  4.524]
alpha[1]       0.1626  3.741e-02      4.346  1.385e-05 [8.926e-02,  0.236]
beta[1]        0.3401      0.129      2.631  8.523e-03 [8.670e-02,  0.593]
==========================================================================

Covariance estimator: robust
</pre></div></div> </div> <p>These two examples show that both formats can be used.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[13]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >forecast_1d</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span><span class=n >horizon</span><span class=o >=</span><span class=mi >10</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >x0_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >])</span>
<span class=n >forecast_2d</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span><span class=n >horizon</span><span class=o >=</span><span class=mi >10</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >x0_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >:])</span>
<span class=nb >print</span><span class=p >(</span><span class=n >forecast_1d</span><span class=o >.</span><span class=n >mean</span> <span class=o >-</span> <span class=n >forecast_2d</span><span class=o >.</span><span class=n >mean</span><span class=p >)</span>

<span class=c1 >## Simulation-forecasting</span>

<span class=n >mod</span> <span class=o >=</span> <span class=n >arch_model</span><span class=p >(</span><span class=n >y</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >exog</span><span class=p >,</span> <span class=n >mean</span><span class=o >=</span><span class=s2 >"ARX"</span><span class=p >,</span> <span class=n >lags</span><span class=o >=</span><span class=mi >1</span><span class=p >,</span> <span class=n >power</span><span class=o >=</span><span class=mf >1.0</span><span class=p >)</span>
<span class=n >res</span> <span class=o >=</span> <span class=n >mod</span><span class=o >.</span><span class=n >fit</span><span class=p >(</span><span class=n >disp</span><span class=o >=</span><span class=s2 >"off"</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt empty docutils container"> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
     h.01  h.02  h.03  h.04  h.05  h.06  h.07  h.08  h.09  h.10
999   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
</pre></div></div> </div> </section> <section id=Simulation > <h2 id=Simulation >Simulation<a class=headerlink  href="#Simulation" title="Permalink to this heading">¶</a></h2> <p><code class="docutils literal notranslate"><span class=pre >forecast</span></code> supports simulating paths. When forecasting a model with exogenous variables, the same value is used to in all mean paths. If you wish to also simulate the paths of the <code class="docutils literal notranslate"><span class=pre >x</span></code> variables, these need to generated and then passed inside a loop.</p> <section id=Static-out-of-sample-x > <h3 id=Static-out-of-sample-x >Static out-of-sample <code class="docutils literal notranslate"><span class=pre >x</span></code><a class=headerlink  href="#Static-out-of-sample-x" title="Permalink to this heading">¶</a></h3> <p>This first example shows that variance of the paths when the same <code class="docutils literal notranslate"><span class=pre >x</span></code> values are used in the forecast. There is a sense the out-of-sample <code class="docutils literal notranslate"><span class=pre >x</span></code> are treated as deterministic.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[14]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >x</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"x0"</span><span class=p >:</span> <span class=n >x0_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >],</span> <span class=s2 >"x1"</span><span class=p >:</span> <span class=n >x1_oos</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >]}</span>
<span class=n >sim_fixedx</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span><span class=n >horizon</span><span class=o >=</span><span class=mi >10</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >x</span><span class=p >,</span> <span class=n >method</span><span class=o >=</span><span class=s2 >"simulation"</span><span class=p >,</span> <span class=n >simulations</span><span class=o >=</span><span class=mi >100</span><span class=p >)</span>
<span class=n >sim_fixedx</span><span class=o >.</span><span class=n >simulations</span><span class=o >.</span><span class=n >values</span><span class=o >.</span><span class=n >std</span><span class=p >(</span><span class=mi >1</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[14]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([[0.94510757, 0.97700028, 1.13035701, 1.10824845, 1.26825095,
        1.26590793, 1.23342443, 1.18098812, 1.28265677, 1.2315994 ]])
</pre></div></div> </div> </section> <section id=Simulating-the-out-of-sample-x > <h3 id=Simulating-the-out-of-sample-x >Simulating the out-of-sample <code class="docutils literal notranslate"><span class=pre >x</span></code><a class=headerlink  href="#Simulating-the-out-of-sample-x" title="Permalink to this heading">¶</a></h3> <p>This example simulates distinct paths for the two exogenous variables and then simulates a single path. This is then repeated 100 times. We see that variance is much higher when we account for variation in the x data.</p> <div class="nbinput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[15]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=kn >from</span> <span class=nn >numpy.random</span> <span class=kn >import</span> <span class=n >RandomState</span>


<span class=k >def</span> <span class=nf >sim_ar1</span><span class=p >(</span><span class=n >params</span><span class=p >:</span> <span class=n >np</span><span class=o >.</span><span class=n >ndarray</span><span class=p >,</span> <span class=n >initial</span><span class=p >:</span> <span class=nb >float</span><span class=p >,</span> <span class=n >horizon</span><span class=p >:</span> <span class=nb >int</span><span class=p >,</span> <span class=n >rng</span><span class=p >:</span> <span class=n >RandomState</span><span class=p >):</span>
    <span class=n >out</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros</span><span class=p >(</span><span class=n >horizon</span><span class=p >)</span>
    <span class=n >shocks</span> <span class=o >=</span> <span class=n >rng</span><span class=o >.</span><span class=n >standard_normal</span><span class=p >(</span><span class=n >horizon</span><span class=p >)</span>
    <span class=n >out</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span> <span class=o >=</span> <span class=n >params</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span> <span class=o >+</span> <span class=n >params</span><span class=p >[</span><span class=mi >1</span><span class=p >]</span> <span class=o >*</span> <span class=n >initial</span> <span class=o >+</span> <span class=n >shocks</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span>
    <span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >1</span><span class=p >,</span> <span class=n >horizon</span><span class=p >):</span>
        <span class=n >out</span><span class=p >[</span><span class=n >i</span><span class=p >]</span> <span class=o >=</span> <span class=n >params</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span> <span class=o >+</span> <span class=n >params</span><span class=p >[</span><span class=mi >1</span><span class=p >]</span> <span class=o >*</span> <span class=n >out</span><span class=p >[</span><span class=n >i</span> <span class=o >-</span> <span class=mi >1</span><span class=p >]</span> <span class=o >+</span> <span class=n >shocks</span><span class=p >[</span><span class=n >i</span><span class=p >]</span>
    <span class=k >return</span> <span class=n >out</span>


<span class=n >simulations</span> <span class=o >=</span> <span class=p >[]</span>
<span class=n >rng</span> <span class=o >=</span> <span class=n >RandomState</span><span class=p >(</span><span class=mi >20210301</span><span class=p >)</span>
<span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=mi >100</span><span class=p >):</span>
    <span class=n >x0_sim</span> <span class=o >=</span> <span class=n >sim_ar1</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([</span><span class=mi >1</span><span class=p >,</span> <span class=mf >0.8</span><span class=p >]),</span> <span class=n >x0</span><span class=o >.</span><span class=n >iloc</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >],</span> <span class=mi >10</span><span class=p >,</span> <span class=n >rng</span><span class=p >)</span>
    <span class=n >x1_sim</span> <span class=o >=</span> <span class=n >sim_ar1</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >([</span><span class=mf >2.5</span><span class=p >,</span> <span class=mf >0.5</span><span class=p >]),</span> <span class=n >x1</span><span class=o >.</span><span class=n >iloc</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >],</span> <span class=mi >10</span><span class=p >,</span> <span class=n >rng</span><span class=p >)</span>
    <span class=n >x</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"x0"</span><span class=p >:</span> <span class=n >x0_sim</span><span class=p >,</span> <span class=s2 >"x1"</span><span class=p >:</span> <span class=n >x1_sim</span><span class=p >}</span>
    <span class=n >fcast</span> <span class=o >=</span> <span class=n >res</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span><span class=n >horizon</span><span class=o >=</span><span class=mi >10</span><span class=p >,</span> <span class=n >x</span><span class=o >=</span><span class=n >x</span><span class=p >,</span> <span class=n >method</span><span class=o >=</span><span class=s2 >"simulation"</span><span class=p >,</span> <span class=n >simulations</span><span class=o >=</span><span class=mi >1</span><span class=p >)</span>
    <span class=n >simulations</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >fcast</span><span class=o >.</span><span class=n >simulations</span><span class=o >.</span><span class=n >values</span><span class=p >)</span>
</pre></div> </div> </div> <p>Finally the standard deviation is quite a bit larger. This is a most accurate value fo the long-run variance of the forecast residuals which should account for dynamics in the model and any exogenous regressors.</p> <div class="nbinput docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[16]:
</pre></div> </div> <div class="input_area highlight-ipython3 notranslate"><div class=highlight ><pre><span></span><span class=n >joined</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >concatenate</span><span class=p >(</span><span class=n >simulations</span><span class=p >,</span> <span class=mi >1</span><span class=p >)</span>
<span class=n >joined</span><span class=o >.</span><span class=n >std</span><span class=p >(</span><span class=mi >1</span><span class=p >)</span>
</pre></div> </div> </div> <div class="nboutput nblast docutils container"> <div class="prompt highlight-none notranslate"><div class=highlight ><pre><span></span>[16]:
</pre></div> </div> <div class="output_area docutils container"> <div class=highlight ><pre>
array([[3.21343234, 4.99297815, 6.29477322, 7.49884207, 8.47501636,
        8.64628226, 8.72478144, 8.78606273, 9.03824963, 9.30368669]])
</pre></div></div> </div> </section> </section> </section> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> <a href=univariate_volatility_scenarios.html  title="Volatility Scenarios" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel=prev > <div class="md-flex__cell md-flex__cell--shrink"> <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i> </div> <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"> <span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Previous </span> Volatility Scenarios </span> </div> </a> <a href=mean.html  title="Mean Models" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel=next > <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class=md-flex__ellipsis > <span class=md-footer-nav__direction > Next </span> Mean Models </span> </div> <div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2021, Kevin Sheppard. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 6.1.3. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>