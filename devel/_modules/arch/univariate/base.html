<!DOCTYPE html> <html lang=en > <meta charset=utf-8  /> <meta name=viewport  content="width=device-width, initial-scale=1.0" /> <meta name=viewport  content="width=device-width,initial-scale=1"> <meta http-equiv=x-ua-compatible  content="ie=edge"> <meta name="lang:clipboard.copy" content="Copy to clipboard"> <meta name="lang:clipboard.copied" content="Copied to clipboard"> <meta name="lang:search.language" content=en > <meta name="lang:search.pipeline.stopwords" content=True > <meta name="lang:search.pipeline.trimmer" content=True > <meta name="lang:search.result.none" content="No matching documents"> <meta name="lang:search.result.one" content="1 matching document"> <meta name="lang:search.result.other" content="# matching documents"> <meta name="lang:search.tokenizer" content="[\s\-]+"> <link href="https://fonts.gstatic.com/" rel=preconnect  crossorigin> <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel=stylesheet > <style> body, input { font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif } code, kbd, pre { font-family: "Roboto Mono", "Courier New", Courier, monospace } </style> <link rel=stylesheet  href="../../../_static/stylesheets/application.css"/> <link rel=stylesheet  href="../../../_static/stylesheets/application-palette.css"/> <link rel=stylesheet  href="../../../_static/stylesheets/application-fixes.css"/> <link rel=stylesheet  href="../../../_static/fonts/material-icons.css"/> <meta name=theme-color  content="#2196f3"> <script src="../../../_static/javascripts/modernizr.js"></script> <title>arch.univariate.base &#8212; arch 5.3.2.dev35+g7832ee526 documentation</title> <link rel=apple-touch-icon  sizes=180x180  href="../../../_static/images/apple-touch-icon.png"> <link rel=icon  type="image/png" sizes=32x32  href="../../../_static/images/favicon-32x32.png"> <link rel=icon  type="image/png" sizes=16x16  href="../../../_static/images/favicon-16x16.png"> <link rel=manifest  href="../../../_static/images/site.webmanifest"> <link rel=mask-icon  href="../../../_static/images/safari-pinned-tab.svg" color="#2196f3"> <meta name=msapplication-TileColor  content="#2b5797"> <meta name=msapplication-config  content="../../../_static/images/browserconfig.xml"> <link rel=stylesheet  type="text/css" href="../../../_static/pygments.css" /> <link rel=stylesheet  type="text/css" href="../../../_static/material.css" /> <link rel=stylesheet  type="text/css" href="../../../_static/css/small_fixes.css" /> <script data-url_root="../../../" id=documentation_options  src="../../../_static/documentation_options.js"></script> <script src="../../../_static/jquery.js"></script> <script src="../../../_static/underscore.js"></script> <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script> <script src="../../../_static/doctools.js"></script> <script crossorigin=anonymous  integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script> <link rel="shortcut icon" href="../../../_static/favicon.ico"/> <link rel=index  title=Index  href="../../../genindex.html" /> <link rel=search  title=Search  href="../../../search.html" /> <body dir=ltr data-md-color-primary=blue data-md-color-accent=indigo> <svg class=md-svg > <defs data-children-count=0 > <svg xmlns="http://www.w3.org/2000/svg" width=416  height=448  viewBox="0 0 416 448" id=__github ><path fill=currentColor  d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg> </defs> </svg> <input class=md-toggle  data-md-toggle=drawer  type=checkbox  id=__drawer > <input class=md-toggle  data-md-toggle=search  type=checkbox  id=__search > <label class=md-overlay  data-md-component=overlay  for=__drawer ></label> <a href="#_modules/arch/univariate/base" tabindex=1  class=md-skip > Skip to content </a> <header class=md-header  data-md-component=header > <nav class="md-header-nav md-grid"> <div class="md-flex navheader"> <div class="md-flex__cell md-flex__cell--shrink"> <a href="../../../index.html" title="arch 5.3.2.dev35+g7832ee526 documentation" class="md-header-nav__button md-logo"> <img src="../../../_static/bw-logo.svg" height=26  alt="arch 5.3.2.dev35+g7832ee526 documentation logo"> </a> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--menu md-header-nav__button" for=__drawer ></label> </div> <div class="md-flex__cell md-flex__cell--stretch"> <div class="md-flex__ellipsis md-header-nav__title" data-md-component=title > <span class=md-header-nav__topic >arch v5.3.2 (+35)</span> <span class=md-header-nav__topic > arch.univariate.base </span> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <label class="md-icon md-icon--search md-header-nav__button" for=__search ></label> <div class=md-search  data-md-component=search  role=dialog > <label class=md-search__overlay  for=__search ></label> <div class=md-search__inner  role=search > <form class=md-search__form  action="../../../search.html" method=get  name=search > <input type=text  class=md-search__input  name=q  placeholder=Search  autocapitalize=off  autocomplete=off  spellcheck=false  data-md-component=query  data-md-state=active > <label class="md-icon md-search__icon" for=__search ></label> <button type=reset  class="md-icon md-search__icon" data-md-component=reset  tabindex=-1 > &#xE5CD; </button> </form> <div class=md-search__output > <div class=md-search__scrollwrap  data-md-scrollfix> <div class=md-search-result  data-md-component=result > <div class=md-search-result__meta > Type to start searching </div> <ol class=md-search-result__list ></ol> </div> </div> </div> </div> </div> </div> <div class="md-flex__cell md-flex__cell--shrink"> <div class=md-header-nav__source > <a href="https://github.com/bashtage/arch/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > ARCH </div> </a> </div> </div> <div class="md-flex__cell md-flex__cell--shrink dropdown"> <button class=dropdownbutton >Versions</button> <div class="dropdown-content md-hero"> <a title=Release  href="https://bashtage.github.io/arch/">Release</a> <a title=Development  href="https://bashtage.github.io/arch/devel/">Development</a> <a title="RTD (Release)" href="https://arch.readthedocs.io/">RTD (Release)</a> </div> </div> </div> </nav> </header> <div class=md-container > <nav class=md-tabs  data-md-component=tabs > <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list > <li class=md-tabs__item ><a href="../../index.html" class=md-tabs__link >Module code</a> </ul> </div> </nav> <main class=md-main > <div class="md-main__inner md-grid" data-md-component=container > <div class="md-sidebar md-sidebar--primary" data-md-component=navigation > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--primary" data-md-level=0 > <label class="md-nav__title md-nav__title--site" for=__drawer > <a href="../../../index.html" title="arch 5.3.2.dev35+g7832ee526 documentation" class="md-nav__button md-logo"> <img src="../../../_static/bw-logo.svg" alt=" logo" width=48  height=48 > </a> <a href="../../../index.html" title="arch 5.3.2.dev35+g7832ee526 documentation">arch v5.3.2 (+35)</a> </label> <div class=md-nav__source > <a href="https://github.com/bashtage/arch/" title="Go to repository" class=md-source  data-md-source=github > <div class=md-source__icon > <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width=28  height=28 > <use xlink:href="#__github" width=24  height=24 ></use> </svg> </div> <div class=md-source__repository > ARCH </div> </a> </div> <ul class=md-nav__list > <li class=md-nav__item > <a href="../../../univariate/univariate.html" class=md-nav__link >Univariate Volatility Models</a> <li class=md-nav__item > <a href="../../../bootstrap/bootstrap.html" class=md-nav__link >Bootstrapping</a> <li class=md-nav__item > <a href="../../../multiple-comparison/multiple-comparisons.html" class=md-nav__link >Multiple Comparison Problems</a> <li class=md-nav__item > <a href="../../../unitroot/unitroot.html" class=md-nav__link >Unit Root Testing</a> <li class=md-nav__item > <a href="../../../unitroot/unitroot.html#cointegration-analysis" class=md-nav__link >Cointegration Analysis</a> <li class=md-nav__item > <a href="../../../covariance/covariance.html" class=md-nav__link >Long-run Covariance Estimation</a> <li class=md-nav__item > <a href="../../../api.html" class=md-nav__link >API Reference</a> <li class=md-nav__item > <a href="../../../changes.html" class=md-nav__link >Change Log</a> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc > <div class=md-sidebar__scrollwrap > <div class=md-sidebar__inner > <nav class="md-nav md-nav--secondary"> <ul class=md-nav__list  data-md-scrollfix=""> <li id=searchbox  class=md-nav__item > </ul> </nav> </div> </div> </div> <div class=md-content > <article class="md-content__inner md-typeset" role=main > <h1 id=modules-arch-univariate-base--page-root >Source code for arch.univariate.base</h1><div class=highlight ><pre>
<span></span><span class=sd >"""</span>
<span class=sd >Core classes for ARCH models</span>
<span class=sd >"""</span>
<span class=kn >from</span> <span class=nn >__future__</span> <span class=kn >import</span> <span class=n >annotations</span>

<span class=kn >from</span> <span class=nn >abc</span> <span class=kn >import</span> <span class=n >ABCMeta</span><span class=p >,</span> <span class=n >abstractmethod</span>
<span class=kn >from</span> <span class=nn >copy</span> <span class=kn >import</span> <span class=n >deepcopy</span>
<span class=kn >import</span> <span class=nn >datetime</span> <span class=k >as</span> <span class=nn >dt</span>
<span class=kn >from</span> <span class=nn >typing</span> <span class=kn >import</span> <span class=n >Any</span><span class=p >,</span> <span class=n >Callable</span><span class=p >,</span> <span class=n >Sequence</span><span class=p >,</span> <span class=n >cast</span>
<span class=kn >import</span> <span class=nn >warnings</span>

<span class=kn >import</span> <span class=nn >numpy</span> <span class=k >as</span> <span class=nn >np</span>
<span class=kn >import</span> <span class=nn >pandas</span> <span class=k >as</span> <span class=nn >pd</span>
<span class=kn >from</span> <span class=nn >pandas.util._decorators</span> <span class=kn >import</span> <span class=n >deprecate_kwarg</span>
<span class=kn >from</span> <span class=nn >scipy.optimize</span> <span class=kn >import</span> <span class=n >OptimizeResult</span>
<span class=kn >import</span> <span class=nn >scipy.stats</span> <span class=k >as</span> <span class=nn >stats</span>
<span class=kn >from</span> <span class=nn >statsmodels.iolib.summary</span> <span class=kn >import</span> <span class=n >Summary</span><span class=p >,</span> <span class=n >fmt_2cols</span><span class=p >,</span> <span class=n >fmt_params</span>
<span class=kn >from</span> <span class=nn >statsmodels.iolib.table</span> <span class=kn >import</span> <span class=n >SimpleTable</span>
<span class=kn >from</span> <span class=nn >statsmodels.regression.linear_model</span> <span class=kn >import</span> <span class=n >OLS</span>
<span class=kn >from</span> <span class=nn >statsmodels.tools.numdiff</span> <span class=kn >import</span> <span class=n >approx_fprime</span><span class=p >,</span> <span class=n >approx_hess</span>
<span class=kn >from</span> <span class=nn >statsmodels.tools.tools</span> <span class=kn >import</span> <span class=n >add_constant</span>
<span class=kn >from</span> <span class=nn >statsmodels.tsa.tsatools</span> <span class=kn >import</span> <span class=n >lagmat</span>

<span class=kn >from</span> <span class=nn >arch.__future__._utility</span> <span class=kn >import</span> <span class=n >check_reindex</span>
<span class=kn >from</span> <span class=nn >arch.typing</span> <span class=kn >import</span> <span class=p >(</span>
    <span class=n >ArrayLike</span><span class=p >,</span>
    <span class=n >ArrayLike1D</span><span class=p >,</span>
    <span class=n >ArrayLike2D</span><span class=p >,</span>
    <span class=n >DateLike</span><span class=p >,</span>
    <span class=n >Float64Array</span><span class=p >,</span>
    <span class=n >ForecastingMethod</span><span class=p >,</span>
    <span class=n >Label</span><span class=p >,</span>
    <span class=n >Literal</span><span class=p >,</span>
<span class=p >)</span>
<span class=kn >from</span> <span class=nn >arch.univariate.distribution</span> <span class=kn >import</span> <span class=n >Distribution</span><span class=p >,</span> <span class=n >Normal</span>
<span class=kn >from</span> <span class=nn >arch.univariate.volatility</span> <span class=kn >import</span> <span class=n >ConstantVariance</span><span class=p >,</span> <span class=n >VolatilityProcess</span>
<span class=kn >from</span> <span class=nn >arch.utility.array</span> <span class=kn >import</span> <span class=n >ensure1d</span>
<span class=kn >from</span> <span class=nn >arch.utility.exceptions</span> <span class=kn >import</span> <span class=p >(</span>
    <span class=n >ConvergenceWarning</span><span class=p >,</span>
    <span class=n >DataScaleWarning</span><span class=p >,</span>
    <span class=n >StartingValueWarning</span><span class=p >,</span>
    <span class=n >convergence_warning</span><span class=p >,</span>
    <span class=n >data_scale_warning</span><span class=p >,</span>
    <span class=n >starting_value_warning</span><span class=p >,</span>
<span class=p >)</span>
<span class=kn >from</span> <span class=nn >arch.utility.testing</span> <span class=kn >import</span> <span class=n >WaldTestStatistic</span>
<span class=kn >from</span> <span class=nn >arch.vendor</span> <span class=kn >import</span> <span class=n >cached_property</span>

<span class=k >try</span><span class=p >:</span>
    <span class=kn >from</span> <span class=nn >matplotlib.figure</span> <span class=kn >import</span> <span class=n >Figure</span>
<span class=k >except</span> <span class=ne >ImportError</span><span class=p >:</span>
    <span class=k >pass</span>


<span class=n >__all__</span> <span class=o >=</span> <span class=p >[</span>
    <span class=s2 >"implicit_constant"</span><span class=p >,</span>
    <span class=s2 >"ARCHModelResult"</span><span class=p >,</span>
    <span class=s2 >"ARCHModel"</span><span class=p >,</span>
    <span class=s2 >"ARCHModelForecast"</span><span class=p >,</span>
    <span class=s2 >"constraint"</span><span class=p >,</span>
    <span class=s2 >"format_float_fixed"</span><span class=p >,</span>
<span class=p >]</span>

<span class=n >CONVERGENCE_WARNGING</span><span class=p >:</span> <span class=nb >str</span> <span class=o >=</span> <span class=s2 >"""</span><span class=se >\</span>
<span class=s2 >WARNING: The optimizer did not indicate successful convergence. The message was </span><span class=si >{msg}</span><span class=s2 >.</span>
<span class=s2 >See convergence_flag.</span>
<span class=s2 >"""</span>

<span class=c1 ># Callback variables</span>
<span class=n >_callback_info</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"iter"</span><span class=p >:</span> <span class=mi >0</span><span class=p >,</span> <span class=s2 >"llf"</span><span class=p >:</span> <span class=mf >0.0</span><span class=p >,</span> <span class=s2 >"count"</span><span class=p >:</span> <span class=mi >0</span><span class=p >,</span> <span class=s2 >"display"</span><span class=p >:</span> <span class=mi >1</span><span class=p >}</span>


<span class=k >def</span> <span class=nf >_callback</span><span class=p >(</span><span class=n >parameters</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span> <span class=o >*</span><span class=n >args</span><span class=p >:</span> <span class=n >Any</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span><span class=p >:</span>
    <span class=sd >"""</span>
<span class=sd >    Callback for use in optimization</span>

<span class=sd >    Parameters</span>
<span class=sd >    ----------</span>
<span class=sd >    parameters : ndarray</span>
<span class=sd >        Parameter value (not used by function).</span>
<span class=sd >    *args</span>
<span class=sd >        Any other arguments passed to the minimizer.</span>

<span class=sd >    Notes</span>
<span class=sd >    -----</span>
<span class=sd >    Uses global values to track iteration, iteration display frequency,</span>
<span class=sd >    log likelihood and function count</span>
<span class=sd >    """</span>

    <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"iter"</span><span class=p >]</span> <span class=o >+=</span> <span class=mi >1</span>
    <span class=n >disp</span> <span class=o >=</span> <span class=s2 >"Iteration: </span><span class=si >{0:&gt;6}</span><span class=s2 >,   Func. Count: </span><span class=si >{1:&gt;6.3g}</span><span class=s2 >,   Neg. LLF: </span><span class=si >{2}</span><span class=s2 >"</span>
    <span class=k >if</span> <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"iter"</span><span class=p >]</span> <span class=o >%</span> <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"display"</span><span class=p >]</span> <span class=o >==</span> <span class=mi >0</span><span class=p >:</span>
        <span class=nb >print</span><span class=p >(</span>
            <span class=n >disp</span><span class=o >.</span><span class=n >format</span><span class=p >(</span>
                <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"iter"</span><span class=p >],</span> <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"count"</span><span class=p >],</span> <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"llf"</span><span class=p >]</span>
            <span class=p >)</span>
        <span class=p >)</span>


<span class=k >def</span> <span class=nf >constraint</span><span class=p >(</span><span class=n >a</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span> <span class=n >b</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >list</span><span class=p >[</span><span class=nb >dict</span><span class=p >[</span><span class=nb >str</span><span class=p >,</span> <span class=nb >object</span><span class=p >]]:</span>
    <span class=sd >"""</span>
<span class=sd >    Generate constraints from arrays</span>

<span class=sd >    Parameters</span>
<span class=sd >    ----------</span>
<span class=sd >    a : ndarray</span>
<span class=sd >        Parameter loadings</span>
<span class=sd >    b : ndarray</span>
<span class=sd >        Constraint bounds</span>

<span class=sd >    Returns</span>
<span class=sd >    -------</span>
<span class=sd >    constraints : dict</span>
<span class=sd >        Dictionary of inequality constraints, one for each row of a</span>

<span class=sd >    Notes</span>
<span class=sd >    -----</span>
<span class=sd >    Parameter constraints satisfy a.dot(parameters) - b &gt;= 0</span>
<span class=sd >    """</span>

    <span class=k >def</span> <span class=nf >factory</span><span class=p >(</span><span class=n >coeff</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span> <span class=n >val</span><span class=p >:</span> <span class=nb >float</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Callable</span><span class=p >[</span><span class=o >...</span><span class=p >,</span> <span class=nb >float</span><span class=p >]:</span>
        <span class=k >def</span> <span class=nf >f</span><span class=p >(</span><span class=n >params</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span> <span class=o >*</span><span class=n >args</span><span class=p >:</span> <span class=n >Any</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >float</span><span class=p >:</span>
            <span class=k >return</span> <span class=n >np</span><span class=o >.</span><span class=n >dot</span><span class=p >(</span><span class=n >coeff</span><span class=p >,</span> <span class=n >params</span><span class=p >)</span> <span class=o >-</span> <span class=n >val</span>

        <span class=k >return</span> <span class=n >f</span>

    <span class=n >constraints</span> <span class=o >=</span> <span class=p >[]</span>
    <span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=n >a</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]):</span>
        <span class=n >con</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"type"</span><span class=p >:</span> <span class=s2 >"ineq"</span><span class=p >,</span> <span class=s2 >"fun"</span><span class=p >:</span> <span class=n >factory</span><span class=p >(</span><span class=n >a</span><span class=p >[</span><span class=n >i</span><span class=p >],</span> <span class=n >b</span><span class=p >[</span><span class=n >i</span><span class=p >])}</span>
        <span class=n >constraints</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >con</span><span class=p >)</span>

    <span class=k >return</span> <span class=n >constraints</span>


<span class=k >def</span> <span class=nf >format_float_fixed</span><span class=p >(</span><span class=n >x</span><span class=p >:</span> <span class=nb >float</span><span class=p >,</span> <span class=n >max_digits</span><span class=p >:</span> <span class=nb >int</span> <span class=o >=</span> <span class=mi >10</span><span class=p >,</span> <span class=n >decimal</span><span class=p >:</span> <span class=nb >int</span> <span class=o >=</span> <span class=mi >4</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >str</span><span class=p >:</span>
    <span class=sd >"""Formats a floating point number so that if it can be well expressed</span>
<span class=sd >    in using a string with digits len, then it is converted simply, otherwise</span>
<span class=sd >    it is expressed in scientific notation"""</span>
    <span class=c1 ># basic_format = '{:0.' + str(digits) + 'g}'</span>
    <span class=k >if</span> <span class=n >x</span> <span class=o >==</span> <span class=mi >0</span><span class=p >:</span>
        <span class=k >return</span> <span class=p >(</span><span class=s2 >"{:0."</span> <span class=o >+</span> <span class=nb >str</span><span class=p >(</span><span class=n >decimal</span><span class=p >)</span> <span class=o >+</span> <span class=s2 >"f}"</span><span class=p >)</span><span class=o >.</span><span class=n >format</span><span class=p >(</span><span class=mf >0.0</span><span class=p >)</span>
    <span class=n >scale</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >log10</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >abs</span><span class=p >(</span><span class=n >x</span><span class=p >))</span>
    <span class=n >scale</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >sign</span><span class=p >(</span><span class=n >scale</span><span class=p >)</span> <span class=o >*</span> <span class=n >np</span><span class=o >.</span><span class=n >ceil</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >abs</span><span class=p >(</span><span class=n >scale</span><span class=p >))</span>
    <span class=k >if</span> <span class=n >scale</span> <span class=o >&gt;</span> <span class=p >(</span><span class=n >max_digits</span> <span class=o >-</span> <span class=mi >2</span> <span class=o >-</span> <span class=n >decimal</span><span class=p >)</span> <span class=ow >or</span> <span class=n >scale</span> <span class=o >&lt;</span> <span class=o >-</span><span class=p >(</span><span class=n >decimal</span> <span class=o >-</span> <span class=mi >2</span><span class=p >):</span>
        <span class=n >formatted</span> <span class=o >=</span> <span class=p >(</span><span class=s2 >"{0:"</span> <span class=o >+</span> <span class=nb >str</span><span class=p >(</span><span class=n >max_digits</span><span class=p >)</span> <span class=o >+</span> <span class=s2 >"."</span> <span class=o >+</span> <span class=nb >str</span><span class=p >(</span><span class=n >decimal</span><span class=p >)</span> <span class=o >+</span> <span class=s2 >"e}"</span><span class=p >)</span><span class=o >.</span><span class=n >format</span><span class=p >(</span><span class=n >x</span><span class=p >)</span>
    <span class=k >else</span><span class=p >:</span>
        <span class=n >formatted</span> <span class=o >=</span> <span class=p >(</span><span class=s2 >"{0:"</span> <span class=o >+</span> <span class=nb >str</span><span class=p >(</span><span class=n >max_digits</span><span class=p >)</span> <span class=o >+</span> <span class=s2 >"."</span> <span class=o >+</span> <span class=nb >str</span><span class=p >(</span><span class=n >decimal</span><span class=p >)</span> <span class=o >+</span> <span class=s2 >"f}"</span><span class=p >)</span><span class=o >.</span><span class=n >format</span><span class=p >(</span><span class=n >x</span><span class=p >)</span>
    <span class=k >return</span> <span class=n >formatted</span>


<span class=k >def</span> <span class=nf >implicit_constant</span><span class=p >(</span><span class=n >x</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >bool</span><span class=p >:</span>
    <span class=sd >"""</span>
<span class=sd >    Test a matrix for an implicit constant</span>

<span class=sd >    Parameters</span>
<span class=sd >    ----------</span>
<span class=sd >    x : ndarray</span>
<span class=sd >        Array to be tested</span>

<span class=sd >    Returns</span>
<span class=sd >    -------</span>
<span class=sd >    constant : bool</span>
<span class=sd >        Flag indicating whether the array has an implicit constant - whether</span>
<span class=sd >        the array has a set of columns that adds to a constant value</span>
<span class=sd >    """</span>
    <span class=n >nobs</span> <span class=o >=</span> <span class=n >x</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span>
    <span class=n >rank</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >linalg</span><span class=o >.</span><span class=n >matrix_rank</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >hstack</span><span class=p >((</span><span class=n >np</span><span class=o >.</span><span class=n >ones</span><span class=p >((</span><span class=n >nobs</span><span class=p >,</span> <span class=mi >1</span><span class=p >)),</span> <span class=n >x</span><span class=p >)))</span>
    <span class=k >return</span> <span class=n >rank</span> <span class=o >==</span> <span class=n >x</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >1</span><span class=p >]</span>


<div class=viewcode-block  id=ARCHModel ><a class=viewcode-back  href="../../../univariate/generated/arch.univariate.base.ARCHModel.html#arch.univariate.base.ARCHModel">[docs]</a><span class=k >class</span> <span class=nc >ARCHModel</span><span class=p >(</span><span class=n >metaclass</span><span class=o >=</span><span class=n >ABCMeta</span><span class=p >):</span>
    <span class=sd >"""</span>
<span class=sd >    Abstract base class for mean models in ARCH processes.  Specifies the</span>
<span class=sd >    conditional mean process.</span>

<span class=sd >    All public methods that raise NotImplementedError should be overridden by</span>
<span class=sd >    any subclass.  Private methods that raise NotImplementedError are optional</span>
<span class=sd >    to override but recommended where applicable.</span>
<span class=sd >    """</span>

    <span class=k >def</span> <span class=fm >__init__</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >y</span><span class=p >:</span> <span class=n >ArrayLike</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >volatility</span><span class=p >:</span> <span class=n >VolatilityProcess</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >distribution</span><span class=p >:</span> <span class=n >Distribution</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >hold_back</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >rescale</span><span class=p >:</span> <span class=nb >bool</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span><span class=p >:</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_name</span> <span class=o >=</span> <span class=s2 >"ARCHModel"</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_is_pandas</span> <span class=o >=</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >y</span><span class=p >,</span> <span class=p >(</span><span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >,</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >))</span>
        <span class=k >if</span> <span class=n >y</span> <span class=ow >is</span> <span class=ow >not</span> <span class=kc >None</span><span class=p >:</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_y_series</span> <span class=o >=</span> <span class=n >cast</span><span class=p >(</span><span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >,</span> <span class=n >ensure1d</span><span class=p >(</span><span class=n >y</span><span class=p >,</span> <span class=s2 >"y"</span><span class=p >,</span> <span class=n >series</span><span class=o >=</span><span class=kc >True</span><span class=p >))</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_y_series</span> <span class=o >=</span> <span class=n >cast</span><span class=p >(</span><span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >,</span> <span class=n >ensure1d</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >empty</span><span class=p >((</span><span class=mi >0</span><span class=p >,)),</span> <span class=s2 >"y"</span><span class=p >,</span> <span class=n >series</span><span class=o >=</span><span class=kc >True</span><span class=p >))</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_y</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_y_series</span><span class=p >)</span>
        <span class=k >if</span> <span class=ow >not</span> <span class=n >np</span><span class=o >.</span><span class=n >all</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >isfinite</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_y</span><span class=p >)):</span>
            <span class=k >raise</span> <span class=ne >ValueError</span><span class=p >(</span>
                <span class=s2 >"NaN or inf values found in y. y must contains only finite values."</span>
            <span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_y_original</span> <span class=o >=</span> <span class=n >y</span>

        <span class=bp >self</span><span class=o >.</span><span class=n >_fit_indices</span><span class=p >:</span> <span class=nb >list</span><span class=p >[</span><span class=nb >int</span><span class=p >]</span> <span class=o >=</span> <span class=p >[</span><span class=mi >0</span><span class=p >,</span> <span class=nb >int</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_y</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >])]</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_fit_y</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_y</span>

        <span class=bp >self</span><span class=o >.</span><span class=n >hold_back</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=n >hold_back</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_hold_back</span> <span class=o >=</span> <span class=mi >0</span> <span class=k >if</span> <span class=n >hold_back</span> <span class=ow >is</span> <span class=kc >None</span> <span class=k >else</span> <span class=n >hold_back</span>

        <span class=bp >self</span><span class=o >.</span><span class=n >rescale</span><span class=p >:</span> <span class=nb >bool</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=n >rescale</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >scale</span><span class=p >:</span> <span class=nb >float</span> <span class=o >=</span> <span class=mf >1.0</span>

        <span class=bp >self</span><span class=o >.</span><span class=n >_backcast</span><span class=p >:</span> <span class=kc >None</span> <span class=o >|</span> <span class=nb >float</span> <span class=o >|</span> <span class=n >Float64Array</span> <span class=o >=</span> <span class=kc >None</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_var_bounds</span><span class=p >:</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span>

        <span class=k >if</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >volatility</span><span class=p >,</span> <span class=n >VolatilityProcess</span><span class=p >):</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_volatility</span> <span class=o >=</span> <span class=n >volatility</span>
        <span class=k >elif</span> <span class=n >volatility</span> <span class=ow >is</span> <span class=kc >None</span><span class=p >:</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_volatility</span> <span class=o >=</span> <span class=n >ConstantVariance</span><span class=p >()</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=k >raise</span> <span class=ne >TypeError</span><span class=p >(</span><span class=s2 >"volatility must inherit from VolatilityProcess"</span><span class=p >)</span>

        <span class=k >if</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >distribution</span><span class=p >,</span> <span class=n >Distribution</span><span class=p >):</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_distribution</span> <span class=o >=</span> <span class=n >distribution</span>
        <span class=k >elif</span> <span class=n >distribution</span> <span class=ow >is</span> <span class=kc >None</span><span class=p >:</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_distribution</span> <span class=o >=</span> <span class=n >Normal</span><span class=p >()</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=k >raise</span> <span class=ne >TypeError</span><span class=p >(</span><span class=s2 >"distribution must inherit from Distribution"</span><span class=p >)</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >name</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >str</span><span class=p >:</span>
        <span class=sd >"""The name of the model."""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_name</span>

<div class=viewcode-block  id=ARCHModel.constraints ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModel.constraints.html#arch.univariate.base.ARCHModel.constraints">[docs]</a>    <span class=k >def</span> <span class=nf >constraints</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >tuple</span><span class=p >[</span><span class=n >Float64Array</span><span class=p >,</span> <span class=n >Float64Array</span><span class=p >]:</span>
        <span class=sd >"""</span>
<span class=sd >        Construct linear constraint arrays  for use in non-linear optimization</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        a : ndarray</span>
<span class=sd >            Number of constraints by number of parameters loading array</span>
<span class=sd >        b : ndarray</span>
<span class=sd >            Number of constraints array of lower bounds</span>

<span class=sd >        Notes</span>
<span class=sd >        -----</span>
<span class=sd >        Parameters satisfy a.dot(parameters) - b &gt;= 0</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=n >np</span><span class=o >.</span><span class=n >empty</span><span class=p >((</span><span class=mi >0</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >num_params</span><span class=p >)),</span> <span class=n >np</span><span class=o >.</span><span class=n >empty</span><span class=p >(</span><span class=mi >0</span><span class=p >)</span></div>

<div class=viewcode-block  id=ARCHModel.bounds ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModel.bounds.html#arch.univariate.base.ARCHModel.bounds">[docs]</a>    <span class=k >def</span> <span class=nf >bounds</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >list</span><span class=p >[</span><span class=nb >tuple</span><span class=p >[</span><span class=nb >float</span><span class=p >,</span> <span class=nb >float</span><span class=p >]]:</span>
        <span class=sd >"""</span>
<span class=sd >        Construct bounds for parameters to use in non-linear optimization</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        bounds : list (2-tuple of float)</span>
<span class=sd >            Bounds for parameters to use in estimation.</span>
<span class=sd >        """</span>
        <span class=n >num_params</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >num_params</span>
        <span class=k >return</span> <span class=p >[(</span><span class=o >-</span><span class=n >np</span><span class=o >.</span><span class=n >inf</span><span class=p >,</span> <span class=n >np</span><span class=o >.</span><span class=n >inf</span><span class=p >)]</span> <span class=o >*</span> <span class=n >num_params</span></div>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >y</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >ArrayLike</span> <span class=o >|</span> <span class=kc >None</span><span class=p >:</span>
        <span class=sd >"""Returns the dependent variable"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_y_original</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >volatility</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >VolatilityProcess</span><span class=p >:</span>
        <span class=sd >"""Set or gets the volatility process</span>

<span class=sd >        Volatility processes must be a subclass of VolatilityProcess</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_volatility</span>

    <span class=nd >@volatility</span><span class=o >.</span><span class=n >setter</span>
    <span class=k >def</span> <span class=nf >volatility</span><span class=p >(</span><span class=bp >self</span><span class=p >,</span> <span class=n >value</span><span class=p >:</span> <span class=n >VolatilityProcess</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span><span class=p >:</span>
        <span class=k >if</span> <span class=ow >not</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >value</span><span class=p >,</span> <span class=n >VolatilityProcess</span><span class=p >):</span>
            <span class=k >raise</span> <span class=ne >ValueError</span><span class=p >(</span><span class=s2 >"Must subclass VolatilityProcess"</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_volatility</span> <span class=o >=</span> <span class=n >value</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >distribution</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Distribution</span><span class=p >:</span>
        <span class=sd >"""Set or gets the error distribution</span>

<span class=sd >        Distributions must be a subclass of Distribution</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_distribution</span>

    <span class=nd >@distribution</span><span class=o >.</span><span class=n >setter</span>
    <span class=k >def</span> <span class=nf >distribution</span><span class=p >(</span><span class=bp >self</span><span class=p >,</span> <span class=n >value</span><span class=p >:</span> <span class=n >Distribution</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span><span class=p >:</span>
        <span class=k >if</span> <span class=ow >not</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >value</span><span class=p >,</span> <span class=n >Distribution</span><span class=p >):</span>
            <span class=k >raise</span> <span class=ne >ValueError</span><span class=p >(</span><span class=s2 >"Must subclass Distribution"</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_distribution</span> <span class=o >=</span> <span class=n >value</span>

    <span class=k >def</span> <span class=nf >_check_scale</span><span class=p >(</span><span class=bp >self</span><span class=p >,</span> <span class=n >resids</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span><span class=p >:</span>
        <span class=n >check</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >rescale</span> <span class=ow >in</span> <span class=p >(</span><span class=kc >None</span><span class=p >,</span> <span class=kc >True</span><span class=p >)</span>
        <span class=k >if</span> <span class=ow >not</span> <span class=n >check</span><span class=p >:</span>
            <span class=k >return</span>
        <span class=n >orig_scale</span> <span class=o >=</span> <span class=n >scale</span> <span class=o >=</span> <span class=n >resids</span><span class=o >.</span><span class=n >var</span><span class=p >()</span>
        <span class=n >rescale</span> <span class=o >=</span> <span class=mf >1.0</span>
        <span class=k >while</span> <span class=ow >not</span> <span class=mf >0.1</span> <span class=o >&lt;=</span> <span class=n >scale</span> <span class=o >&lt;</span> <span class=mf >10000.0</span> <span class=ow >and</span> <span class=n >scale</span> <span class=o >&gt;</span> <span class=mi >0</span><span class=p >:</span>
            <span class=k >if</span> <span class=n >scale</span> <span class=o >&lt;</span> <span class=mf >1.0</span><span class=p >:</span>
                <span class=n >rescale</span> <span class=o >*=</span> <span class=mi >10</span>
            <span class=k >else</span><span class=p >:</span>
                <span class=n >rescale</span> <span class=o >/=</span> <span class=mi >10</span>
            <span class=n >scale</span> <span class=o >=</span> <span class=n >orig_scale</span> <span class=o >*</span> <span class=n >rescale</span><span class=o >**</span><span class=mi >2</span>
        <span class=k >if</span> <span class=n >rescale</span> <span class=o >==</span> <span class=mf >1.0</span><span class=p >:</span>
            <span class=k >return</span>
        <span class=k >if</span> <span class=bp >self</span><span class=o >.</span><span class=n >rescale</span> <span class=ow >is</span> <span class=kc >None</span><span class=p >:</span>
            <span class=n >warnings</span><span class=o >.</span><span class=n >warn</span><span class=p >(</span>
                <span class=n >data_scale_warning</span><span class=o >.</span><span class=n >format</span><span class=p >(</span><span class=n >orig_scale</span><span class=p >,</span> <span class=n >rescale</span><span class=p >),</span> <span class=n >DataScaleWarning</span>
            <span class=p >)</span>
            <span class=k >return</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >scale</span> <span class=o >=</span> <span class=n >rescale</span>

    <span class=k >def</span> <span class=nf >_r2</span><span class=p >(</span><span class=bp >self</span><span class=p >,</span> <span class=n >params</span><span class=p >:</span> <span class=n >ArrayLike1D</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span> <span class=o >|</span> <span class=nb >float</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Computes the model r-square.  Optional to over-ride.  Must match</span>
<span class=sd >        signature.</span>
<span class=sd >        """</span>
        <span class=k >raise</span> <span class=ne >NotImplementedError</span><span class=p >(</span><span class=s2 >"Subclasses optionally may provide."</span><span class=p >)</span>

    <span class=nd >@abstractmethod</span>
    <span class=k >def</span> <span class=nf >_fit_no_arch_normal_errors_params</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Float64Array</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Must be overridden with closed form estimator the return parameters ony</span>
<span class=sd >        """</span>

    <span class=nd >@abstractmethod</span>
    <span class=k >def</span> <span class=nf >_fit_no_arch_normal_errors</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span> <span class=n >cov_type</span><span class=p >:</span> <span class=n >Literal</span><span class=p >[</span><span class=s2 >"robust"</span><span class=p >,</span> <span class=s2 >"classic"</span><span class=p >]</span> <span class=o >=</span> <span class=s2 >"robust"</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=n >ARCHModelResult</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Must be overridden with closed form estimator</span>
<span class=sd >        """</span>

    <span class=nd >@staticmethod</span>
    <span class=k >def</span> <span class=nf >_static_gaussian_loglikelihood</span><span class=p >(</span><span class=n >resids</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >float</span><span class=p >:</span>
        <span class=n >nobs</span> <span class=o >=</span> <span class=n >resids</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span>
        <span class=n >sigma2</span> <span class=o >=</span> <span class=n >resids</span><span class=o >.</span><span class=n >dot</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span> <span class=o >/</span> <span class=n >nobs</span>

        <span class=n >loglikelihood</span> <span class=o >=</span> <span class=o >-</span><span class=mf >0.5</span> <span class=o >*</span> <span class=n >nobs</span> <span class=o >*</span> <span class=n >np</span><span class=o >.</span><span class=n >log</span><span class=p >(</span><span class=mi >2</span> <span class=o >*</span> <span class=n >np</span><span class=o >.</span><span class=n >pi</span><span class=p >)</span>
        <span class=n >loglikelihood</span> <span class=o >-=</span> <span class=mf >0.5</span> <span class=o >*</span> <span class=n >nobs</span> <span class=o >*</span> <span class=n >np</span><span class=o >.</span><span class=n >log</span><span class=p >(</span><span class=n >sigma2</span><span class=p >)</span>
        <span class=n >loglikelihood</span> <span class=o >-=</span> <span class=mf >0.5</span> <span class=o >*</span> <span class=n >nobs</span>

        <span class=k >return</span> <span class=n >loglikelihood</span>

    <span class=k >def</span> <span class=nf >_fit_parameterless_model</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >cov_type</span><span class=p >:</span> <span class=n >Literal</span><span class=p >[</span><span class=s2 >"robust"</span><span class=p >,</span> <span class=s2 >"classic"</span><span class=p >],</span>
        <span class=n >backcast</span><span class=p >:</span> <span class=nb >float</span> <span class=o >|</span> <span class=n >Float64Array</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=n >ARCHModelResult</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        When models have no parameters, fill return values</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        results : ARCHModelResult</span>
<span class=sd >            Model result from parameterless model</span>
<span class=sd >        """</span>
        <span class=n >y</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_fit_y</span>
        <span class=c1 ># Fake convergence results, see GH #87</span>
        <span class=n >opt</span> <span class=o >=</span> <span class=n >OptimizeResult</span><span class=p >({</span><span class=s2 >"status"</span><span class=p >:</span> <span class=mi >0</span><span class=p >,</span> <span class=s2 >"message"</span><span class=p >:</span> <span class=s2 >""</span><span class=p >})</span>

        <span class=n >params</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >empty</span><span class=p >(</span><span class=mi >0</span><span class=p >)</span>
        <span class=n >param_cov</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >empty</span><span class=p >((</span><span class=mi >0</span><span class=p >,</span> <span class=mi >0</span><span class=p >))</span>
        <span class=n >first_obs</span><span class=p >,</span> <span class=n >last_obs</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_fit_indices</span>
        <span class=n >resids_final</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >full_like</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_y</span><span class=p >,</span> <span class=n >np</span><span class=o >.</span><span class=n >nan</span><span class=p >)</span>
        <span class=n >resids_final</span><span class=p >[</span><span class=n >first_obs</span><span class=p >:</span><span class=n >last_obs</span><span class=p >]</span> <span class=o >=</span> <span class=n >y</span>

        <span class=n >var_bounds</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >variance_bounds</span><span class=p >(</span><span class=n >y</span><span class=p >)</span>
        <span class=n >vol</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros_like</span><span class=p >(</span><span class=n >y</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >compute_variance</span><span class=p >(</span><span class=n >params</span><span class=p >,</span> <span class=n >y</span><span class=p >,</span> <span class=n >vol</span><span class=p >,</span> <span class=n >backcast</span><span class=p >,</span> <span class=n >var_bounds</span><span class=p >)</span>
        <span class=n >vol</span> <span class=o >=</span> <span class=n >cast</span><span class=p >(</span><span class=n >Float64Array</span><span class=p >,</span> <span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >vol</span><span class=p >))</span>

        <span class=c1 ># Reshape resids vol</span>
        <span class=n >vol_final</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >empty_like</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_y</span><span class=p >,</span> <span class=n >dtype</span><span class=o >=</span><span class=n >np</span><span class=o >.</span><span class=n >float64</span><span class=p >)</span>
        <span class=n >vol_final</span><span class=o >.</span><span class=n >fill</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >nan</span><span class=p >)</span>
        <span class=n >vol_final</span><span class=p >[</span><span class=n >first_obs</span><span class=p >:</span><span class=n >last_obs</span><span class=p >]</span> <span class=o >=</span> <span class=n >vol</span>

        <span class=n >names</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_all_parameter_names</span><span class=p >()</span>
        <span class=n >loglikelihood</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_static_gaussian_loglikelihood</span><span class=p >(</span><span class=n >y</span><span class=p >)</span>
        <span class=n >r2</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_r2</span><span class=p >(</span><span class=n >params</span><span class=p >)</span>
        <span class=n >fit_start</span><span class=p >,</span> <span class=n >fit_stop</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_fit_indices</span>

        <span class=k >assert</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >r2</span><span class=p >,</span> <span class=nb >float</span><span class=p >)</span>
        <span class=k >return</span> <span class=n >ARCHModelResult</span><span class=p >(</span>
            <span class=n >params</span><span class=p >,</span>
            <span class=n >param_cov</span><span class=p >,</span>
            <span class=n >r2</span><span class=p >,</span>
            <span class=n >resids_final</span><span class=p >,</span>
            <span class=n >vol_final</span><span class=p >,</span>
            <span class=n >cov_type</span><span class=p >,</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_y_series</span><span class=p >,</span>
            <span class=n >names</span><span class=p >,</span>
            <span class=n >loglikelihood</span><span class=p >,</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_is_pandas</span><span class=p >,</span>
            <span class=n >opt</span><span class=p >,</span>
            <span class=n >fit_start</span><span class=p >,</span>
            <span class=n >fit_stop</span><span class=p >,</span>
            <span class=n >deepcopy</span><span class=p >(</span><span class=bp >self</span><span class=p >),</span>
        <span class=p >)</span>

    <span class=k >def</span> <span class=nf >_loglikelihood</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >parameters</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >sigma2</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >backcast</span><span class=p >:</span> <span class=nb >float</span> <span class=o >|</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >var_bounds</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >individual</span><span class=p >:</span> <span class=nb >bool</span> <span class=o >=</span> <span class=kc >False</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >float</span> <span class=o >|</span> <span class=n >Float64Array</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Computes the log-likelihood using the entire model</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        parameters</span>
<span class=sd >        sigma2</span>
<span class=sd >        backcast</span>
<span class=sd >        individual : bool, optional</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        neg_llf : float</span>
<span class=sd >            Negative of model loglikelihood</span>
<span class=sd >        """</span>
        <span class=c1 ># Parse parameters</span>
        <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"count"</span><span class=p >]</span> <span class=o >+=</span> <span class=mi >1</span>

        <span class=c1 ># 1. Resids</span>
        <span class=n >mp</span><span class=p >,</span> <span class=n >vp</span><span class=p >,</span> <span class=n >dp</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_parse_parameters</span><span class=p >(</span><span class=n >parameters</span><span class=p >)</span>
        <span class=n >resids</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >resids</span><span class=p >(</span><span class=n >mp</span><span class=p >),</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span><span class=p >)</span>

        <span class=c1 ># 2. Compute sigma2 using VolatilityModel</span>
        <span class=n >sigma2</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >compute_variance</span><span class=p >(</span>
            <span class=n >vp</span><span class=p >,</span> <span class=n >resids</span><span class=p >,</span> <span class=n >sigma2</span><span class=p >,</span> <span class=n >backcast</span><span class=p >,</span> <span class=n >var_bounds</span>
        <span class=p >)</span>
        <span class=c1 ># 3. Compute log likelihood using Distribution</span>
        <span class=n >llf</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >distribution</span><span class=o >.</span><span class=n >loglikelihood</span><span class=p >(</span><span class=n >dp</span><span class=p >,</span> <span class=n >resids</span><span class=p >,</span> <span class=n >sigma2</span><span class=p >,</span> <span class=n >individual</span><span class=p >)</span>

        <span class=k >if</span> <span class=ow >not</span> <span class=n >individual</span><span class=p >:</span>
            <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"llf"</span><span class=p >]</span> <span class=o >=</span> <span class=n >llf_f</span> <span class=o >=</span> <span class=o >-</span><span class=nb >float</span><span class=p >(</span><span class=n >llf</span><span class=p >)</span>
            <span class=k >return</span> <span class=n >llf_f</span>

        <span class=k >return</span> <span class=n >cast</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >ndarray</span><span class=p >,</span> <span class=o >-</span><span class=n >llf</span><span class=p >)</span>

    <span class=k >def</span> <span class=nf >_all_parameter_names</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >list</span><span class=p >[</span><span class=nb >str</span><span class=p >]:</span>
        <span class=sd >"""Returns a list containing all parameter names from the mean model,</span>
<span class=sd >        volatility model and distribution"""</span>

        <span class=n >names</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >parameter_names</span><span class=p >()</span>
        <span class=n >names</span><span class=o >.</span><span class=n >extend</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >parameter_names</span><span class=p >())</span>
        <span class=n >names</span><span class=o >.</span><span class=n >extend</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >distribution</span><span class=o >.</span><span class=n >parameter_names</span><span class=p >())</span>

        <span class=k >return</span> <span class=n >names</span>

    <span class=k >def</span> <span class=nf >_parse_parameters</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span> <span class=n >x</span><span class=p >:</span> <span class=n >ArrayLike1D</span> <span class=o >|</span> <span class=n >Sequence</span><span class=p >[</span><span class=nb >float</span><span class=p >]</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >tuple</span><span class=p >[</span><span class=n >Float64Array</span><span class=p >,</span> <span class=n >Float64Array</span><span class=p >,</span> <span class=n >Float64Array</span><span class=p >]:</span>
        <span class=sd >"""Return the parameters of each model in a tuple"""</span>
        <span class=n >x</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=n >x</span><span class=p >,</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span><span class=p >)</span>
        <span class=n >km</span><span class=p >,</span> <span class=n >kv</span> <span class=o >=</span> <span class=nb >int</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >num_params</span><span class=p >),</span> <span class=nb >int</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >num_params</span><span class=p >)</span>
        <span class=k >return</span> <span class=n >x</span><span class=p >[:</span><span class=n >km</span><span class=p >],</span> <span class=n >x</span><span class=p >[</span><span class=n >km</span> <span class=p >:</span> <span class=n >km</span> <span class=o >+</span> <span class=n >kv</span><span class=p >],</span> <span class=n >x</span><span class=p >[</span><span class=n >km</span> <span class=o >+</span> <span class=n >kv</span> <span class=p >:]</span>

<div class=viewcode-block  id=ARCHModel.fix ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModel.fix.html#arch.univariate.base.ARCHModel.fix">[docs]</a>    <span class=k >def</span> <span class=nf >fix</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >params</span><span class=p >:</span> <span class=n >Sequence</span><span class=p >[</span><span class=nb >float</span><span class=p >]</span> <span class=o >|</span> <span class=n >ArrayLike1D</span><span class=p >,</span>
        <span class=n >first_obs</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=n >DateLike</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >last_obs</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=n >DateLike</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=n >ARCHModelFixedResult</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Allows an ARCHModelFixedResult to be constructed from fixed parameters.</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        params : {ndarray, Series}</span>
<span class=sd >            User specified parameters to use when generating the result. Must</span>
<span class=sd >            have the correct number of parameters for a given choice of mean</span>
<span class=sd >            model, volatility model and distribution.</span>
<span class=sd >        first_obs : {int, str, datetime, Timestamp}</span>
<span class=sd >            First observation to use when fixing model</span>
<span class=sd >        last_obs : {int, str, datetime, Timestamp}</span>
<span class=sd >            Last observation to use when fixing model</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        results : ARCHModelFixedResult</span>
<span class=sd >            Object containing model results</span>

<span class=sd >        Notes</span>
<span class=sd >        -----</span>
<span class=sd >        Parameters are not checked against model-specific constraints.</span>
<span class=sd >        """</span>
        <span class=n >v</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >volatility</span>

        <span class=bp >self</span><span class=o >.</span><span class=n >_adjust_sample</span><span class=p >(</span><span class=n >first_obs</span><span class=p >,</span> <span class=n >last_obs</span><span class=p >)</span>
        <span class=n >resids</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >resids</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >starting_values</span><span class=p >()),</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span><span class=p >)</span>
        <span class=n >sigma2</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros_like</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>
        <span class=n >backcast</span> <span class=o >=</span> <span class=n >v</span><span class=o >.</span><span class=n >backcast</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_backcast</span> <span class=o >=</span> <span class=n >backcast</span>

        <span class=n >var_bounds</span> <span class=o >=</span> <span class=n >v</span><span class=o >.</span><span class=n >variance_bounds</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>

        <span class=n >params</span> <span class=o >=</span> <span class=n >ensure1d</span><span class=p >(</span><span class=n >params</span><span class=p >,</span> <span class=s2 >"params"</span><span class=p >,</span> <span class=kc >False</span><span class=p >)</span>
        <span class=n >loglikelihood</span> <span class=o >=</span> <span class=o >-</span><span class=mf >1.0</span> <span class=o >*</span> <span class=bp >self</span><span class=o >.</span><span class=n >_loglikelihood</span><span class=p >(</span><span class=n >params</span><span class=p >,</span> <span class=n >sigma2</span><span class=p >,</span> <span class=n >backcast</span><span class=p >,</span> <span class=n >var_bounds</span><span class=p >)</span>
        <span class=k >assert</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >loglikelihood</span><span class=p >,</span> <span class=nb >float</span><span class=p >)</span>

        <span class=n >mp</span><span class=p >,</span> <span class=n >vp</span><span class=p >,</span> <span class=n >dp</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_parse_parameters</span><span class=p >(</span><span class=n >params</span><span class=p >)</span>

        <span class=n >resids</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >resids</span><span class=p >(</span><span class=n >mp</span><span class=p >),</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span><span class=p >)</span>
        <span class=n >vol</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros_like</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >compute_variance</span><span class=p >(</span><span class=n >vp</span><span class=p >,</span> <span class=n >resids</span><span class=p >,</span> <span class=n >vol</span><span class=p >,</span> <span class=n >backcast</span><span class=p >,</span> <span class=n >var_bounds</span><span class=p >)</span>
        <span class=n >vol</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >vol</span><span class=p >))</span>

        <span class=n >names</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_all_parameter_names</span><span class=p >()</span>
        <span class=c1 ># Reshape resids and vol</span>
        <span class=n >first_obs</span><span class=p >,</span> <span class=n >last_obs</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_fit_indices</span>
        <span class=n >resids_final</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >empty_like</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_y</span><span class=p >,</span> <span class=n >dtype</span><span class=o >=</span><span class=n >np</span><span class=o >.</span><span class=n >float64</span><span class=p >)</span>
        <span class=n >resids_final</span><span class=o >.</span><span class=n >fill</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >nan</span><span class=p >)</span>
        <span class=n >resids_final</span><span class=p >[</span><span class=n >first_obs</span><span class=p >:</span><span class=n >last_obs</span><span class=p >]</span> <span class=o >=</span> <span class=n >resids</span>
        <span class=n >vol_final</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >empty_like</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_y</span><span class=p >,</span> <span class=n >dtype</span><span class=o >=</span><span class=n >np</span><span class=o >.</span><span class=n >float64</span><span class=p >)</span>
        <span class=n >vol_final</span><span class=o >.</span><span class=n >fill</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >nan</span><span class=p >)</span>
        <span class=n >vol_final</span><span class=p >[</span><span class=n >first_obs</span><span class=p >:</span><span class=n >last_obs</span><span class=p >]</span> <span class=o >=</span> <span class=n >vol</span>

        <span class=n >model_copy</span> <span class=o >=</span> <span class=n >deepcopy</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span>
        <span class=k >return</span> <span class=n >ARCHModelFixedResult</span><span class=p >(</span>
            <span class=n >params</span><span class=p >,</span>
            <span class=n >resids</span><span class=p >,</span>
            <span class=n >vol</span><span class=p >,</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_y_series</span><span class=p >,</span>
            <span class=n >names</span><span class=p >,</span>
            <span class=n >loglikelihood</span><span class=p >,</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_is_pandas</span><span class=p >,</span>
            <span class=n >model_copy</span><span class=p >,</span>
        <span class=p >)</span></div>

    <span class=nd >@abstractmethod</span>
    <span class=k >def</span> <span class=nf >_adjust_sample</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span> <span class=n >first_obs</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=n >DateLike</span> <span class=o >|</span> <span class=kc >None</span><span class=p >,</span> <span class=n >last_obs</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=n >DateLike</span> <span class=o >|</span> <span class=kc >None</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Performs sample adjustment for estimation</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        first_obs : {int, str, datetime, datetime64, Timestamp}</span>
<span class=sd >            First observation to use when estimating model</span>
<span class=sd >        last_obs : {int, str, datetime, datetime64, Timestamp}</span>
<span class=sd >            Last observation to use when estimating model</span>

<span class=sd >        Notes</span>
<span class=sd >        -----</span>
<span class=sd >        Adjusted sample must follow Python semantics of first_obs:last_obs</span>
<span class=sd >        """</span>

<div class=viewcode-block  id=ARCHModel.fit ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModel.fit.html#arch.univariate.base.ARCHModel.fit">[docs]</a>    <span class=k >def</span> <span class=nf >fit</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >update_freq</span><span class=p >:</span> <span class=nb >int</span> <span class=o >=</span> <span class=mi >1</span><span class=p >,</span>
        <span class=n >disp</span><span class=p >:</span> <span class=nb >bool</span> <span class=o >|</span> <span class=n >Literal</span><span class=p >[</span><span class=s2 >"off"</span><span class=p >,</span> <span class=s2 >"final"</span><span class=p >]</span> <span class=o >=</span> <span class=s2 >"final"</span><span class=p >,</span>
        <span class=n >starting_values</span><span class=p >:</span> <span class=n >ArrayLike1D</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >cov_type</span><span class=p >:</span> <span class=n >Literal</span><span class=p >[</span><span class=s2 >"robust"</span><span class=p >,</span> <span class=s2 >"classic"</span><span class=p >]</span> <span class=o >=</span> <span class=s2 >"robust"</span><span class=p >,</span>
        <span class=n >show_warning</span><span class=p >:</span> <span class=nb >bool</span> <span class=o >=</span> <span class=kc >True</span><span class=p >,</span>
        <span class=n >first_obs</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=n >DateLike</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >last_obs</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=n >DateLike</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >tol</span><span class=p >:</span> <span class=nb >float</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >options</span><span class=p >:</span> <span class=nb >dict</span><span class=p >[</span><span class=nb >str</span><span class=p >,</span> <span class=n >Any</span><span class=p >]</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >backcast</span><span class=p >:</span> <span class=kc >None</span> <span class=o >|</span> <span class=nb >float</span> <span class=o >|</span> <span class=n >Float64Array</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=n >ARCHModelResult</span><span class=p >:</span>
        <span class=sa >r</span><span class=sd >"""</span>
<span class=sd >        Estimate model parameters</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        update_freq : int, optional</span>
<span class=sd >            Frequency of iteration updates.  Output is generated every</span>
<span class=sd >            `update_freq` iterations. Set to 0 to disable iterative output.</span>
<span class=sd >        disp : {bool, "off", "final"}</span>
<span class=sd >            Either 'final' to print optimization result or 'off' to display</span>
<span class=sd >            nothing. If using a boolean, False is "off" and True is "final"</span>
<span class=sd >        starting_values : ndarray, optional</span>
<span class=sd >            Array of starting values to use.  If not provided, starting values</span>
<span class=sd >            are constructed by the model components.</span>
<span class=sd >        cov_type : str, optional</span>
<span class=sd >            Estimation method of parameter covariance.  Supported options are</span>
<span class=sd >            'robust', which does not assume the Information Matrix Equality</span>
<span class=sd >            holds and 'classic' which does.  In the ARCH literature, 'robust'</span>
<span class=sd >            corresponds to Bollerslev-Wooldridge covariance estimator.</span>
<span class=sd >        show_warning : bool, optional</span>
<span class=sd >            Flag indicating whether convergence warnings should be shown.</span>
<span class=sd >        first_obs : {int, str, datetime, Timestamp}</span>
<span class=sd >            First observation to use when estimating model</span>
<span class=sd >        last_obs : {int, str, datetime, Timestamp}</span>
<span class=sd >            Last observation to use when estimating model</span>
<span class=sd >        tol : float, optional</span>
<span class=sd >            Tolerance for termination.</span>
<span class=sd >        options : dict, optional</span>
<span class=sd >            Options to pass to `scipy.optimize.minimize`.  Valid entries</span>
<span class=sd >            include 'ftol', 'eps', 'disp', and 'maxiter'.</span>
<span class=sd >        backcast : {float, ndarray}, optional</span>
<span class=sd >            Value to use as backcast. Should be measure :math:`\sigma^2_0`</span>
<span class=sd >            since model-specific non-linear transformations are applied to</span>
<span class=sd >            value before computing the variance recursions.</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        results : ARCHModelResult</span>
<span class=sd >            Object containing model results</span>

<span class=sd >        Notes</span>
<span class=sd >        -----</span>
<span class=sd >        A ConvergenceWarning is raised if SciPy's optimizer indicates</span>
<span class=sd >        difficulty finding the optimum.</span>

<span class=sd >        Parameters are optimized using SLSQP.</span>
<span class=sd >        """</span>
        <span class=k >if</span> <span class=bp >self</span><span class=o >.</span><span class=n >_y_original</span> <span class=ow >is</span> <span class=kc >None</span><span class=p >:</span>
            <span class=k >raise</span> <span class=ne >RuntimeError</span><span class=p >(</span><span class=s2 >"Cannot estimate model without data."</span><span class=p >)</span>
        <span class=c1 ># 1. Check in ARCH or Non-normal dist.  If no ARCH and normal,</span>
        <span class=c1 ># use closed form</span>
        <span class=n >v</span><span class=p >,</span> <span class=n >d</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >volatility</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >distribution</span>
        <span class=n >offsets</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >((</span><span class=bp >self</span><span class=o >.</span><span class=n >num_params</span><span class=p >,</span> <span class=n >v</span><span class=o >.</span><span class=n >num_params</span><span class=p >,</span> <span class=n >d</span><span class=o >.</span><span class=n >num_params</span><span class=p >),</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >int</span><span class=p >)</span>
        <span class=n >total_params</span> <span class=o >=</span> <span class=nb >sum</span><span class=p >(</span><span class=n >offsets</span><span class=p >)</span>

        <span class=c1 ># Closed form is applicable when model has no parameters</span>
        <span class=c1 ># Or when distribution is normal and constant variance</span>
        <span class=n >has_closed_form</span> <span class=o >=</span> <span class=p >(</span>
            <span class=n >v</span><span class=o >.</span><span class=n >closed_form</span> <span class=ow >and</span> <span class=n >d</span><span class=o >.</span><span class=n >num_params</span> <span class=o >==</span> <span class=mi >0</span> <span class=ow >and</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >v</span><span class=p >,</span> <span class=n >ConstantVariance</span><span class=p >)</span>
        <span class=p >)</span>

        <span class=bp >self</span><span class=o >.</span><span class=n >_adjust_sample</span><span class=p >(</span><span class=n >first_obs</span><span class=p >,</span> <span class=n >last_obs</span><span class=p >)</span>

        <span class=n >resids</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >resids</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >starting_values</span><span class=p >()),</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_check_scale</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>
        <span class=k >if</span> <span class=bp >self</span><span class=o >.</span><span class=n >scale</span> <span class=o >!=</span> <span class=mf >1.0</span><span class=p >:</span>
            <span class=c1 ># Scale changed, rescale data and reset model</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_y</span> <span class=o >=</span> <span class=n >cast</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >ndarray</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >scale</span> <span class=o >*</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_y_original</span><span class=p >))</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_adjust_sample</span><span class=p >(</span><span class=n >first_obs</span><span class=p >,</span> <span class=n >last_obs</span><span class=p >)</span>
            <span class=n >resids</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >resids</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >starting_values</span><span class=p >()),</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span><span class=p >)</span>

        <span class=k >if</span> <span class=n >backcast</span> <span class=ow >is</span> <span class=kc >None</span><span class=p >:</span>
            <span class=n >backcast</span> <span class=o >=</span> <span class=n >v</span><span class=o >.</span><span class=n >backcast</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=k >assert</span> <span class=n >backcast</span> <span class=ow >is</span> <span class=ow >not</span> <span class=kc >None</span>
            <span class=n >backcast</span> <span class=o >=</span> <span class=n >v</span><span class=o >.</span><span class=n >backcast_transform</span><span class=p >(</span><span class=n >backcast</span><span class=p >)</span>

        <span class=k >if</span> <span class=n >has_closed_form</span><span class=p >:</span>
            <span class=k >try</span><span class=p >:</span>
                <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_fit_no_arch_normal_errors</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=n >cov_type</span><span class=p >)</span>
            <span class=k >except</span> <span class=ne >NotImplementedError</span><span class=p >:</span>
                <span class=k >pass</span>
        <span class=k >assert</span> <span class=n >backcast</span> <span class=ow >is</span> <span class=ow >not</span> <span class=kc >None</span>
        <span class=k >if</span> <span class=n >total_params</span> <span class=o >==</span> <span class=mi >0</span><span class=p >:</span>
            <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_fit_parameterless_model</span><span class=p >(</span><span class=n >cov_type</span><span class=o >=</span><span class=n >cov_type</span><span class=p >,</span> <span class=n >backcast</span><span class=o >=</span><span class=n >backcast</span><span class=p >)</span>

        <span class=n >sigma2</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros_like</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_backcast</span> <span class=o >=</span> <span class=n >backcast</span>
        <span class=n >sv_volatility</span> <span class=o >=</span> <span class=n >v</span><span class=o >.</span><span class=n >starting_values</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_var_bounds</span> <span class=o >=</span> <span class=n >var_bounds</span> <span class=o >=</span> <span class=n >v</span><span class=o >.</span><span class=n >variance_bounds</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>
        <span class=n >v</span><span class=o >.</span><span class=n >compute_variance</span><span class=p >(</span><span class=n >sv_volatility</span><span class=p >,</span> <span class=n >resids</span><span class=p >,</span> <span class=n >sigma2</span><span class=p >,</span> <span class=n >backcast</span><span class=p >,</span> <span class=n >var_bounds</span><span class=p >)</span>
        <span class=n >std_resids</span> <span class=o >=</span> <span class=n >resids</span> <span class=o >/</span> <span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >sigma2</span><span class=p >)</span>

        <span class=c1 ># 2. Construct constraint matrices from all models and distribution</span>
        <span class=n >constraints</span> <span class=o >=</span> <span class=p >(</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >constraints</span><span class=p >(),</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >constraints</span><span class=p >(),</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >distribution</span><span class=o >.</span><span class=n >constraints</span><span class=p >(),</span>
        <span class=p >)</span>
        <span class=n >num_cons</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=k >for</span> <span class=n >c</span> <span class=ow >in</span> <span class=n >constraints</span><span class=p >:</span>
            <span class=k >assert</span> <span class=n >c</span> <span class=ow >is</span> <span class=ow >not</span> <span class=kc >None</span>
            <span class=n >num_cons</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >c</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >])</span>
        <span class=n >num_constraints</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >(</span><span class=n >num_cons</span><span class=p >,</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >int</span><span class=p >)</span>
        <span class=n >num_params</span> <span class=o >=</span> <span class=n >offsets</span><span class=o >.</span><span class=n >sum</span><span class=p >()</span>
        <span class=n >a</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros</span><span class=p >((</span><span class=nb >int</span><span class=p >(</span><span class=n >num_constraints</span><span class=o >.</span><span class=n >sum</span><span class=p >()),</span> <span class=nb >int</span><span class=p >(</span><span class=n >num_params</span><span class=p >)))</span>
        <span class=n >b</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros</span><span class=p >(</span><span class=nb >int</span><span class=p >(</span><span class=n >num_constraints</span><span class=o >.</span><span class=n >sum</span><span class=p >()))</span>

        <span class=k >for</span> <span class=n >i</span><span class=p >,</span> <span class=n >c</span> <span class=ow >in</span> <span class=nb >enumerate</span><span class=p >(</span><span class=n >constraints</span><span class=p >):</span>
            <span class=k >assert</span> <span class=n >c</span> <span class=ow >is</span> <span class=ow >not</span> <span class=kc >None</span>
            <span class=n >r_en</span> <span class=o >=</span> <span class=n >num_constraints</span><span class=p >[:</span> <span class=n >i</span> <span class=o >+</span> <span class=mi >1</span><span class=p >]</span><span class=o >.</span><span class=n >sum</span><span class=p >()</span>
            <span class=n >c_en</span> <span class=o >=</span> <span class=n >offsets</span><span class=p >[:</span> <span class=n >i</span> <span class=o >+</span> <span class=mi >1</span><span class=p >]</span><span class=o >.</span><span class=n >sum</span><span class=p >()</span>
            <span class=n >r_st</span> <span class=o >=</span> <span class=n >r_en</span> <span class=o >-</span> <span class=n >num_constraints</span><span class=p >[</span><span class=n >i</span><span class=p >]</span>
            <span class=n >c_st</span> <span class=o >=</span> <span class=n >c_en</span> <span class=o >-</span> <span class=n >offsets</span><span class=p >[</span><span class=n >i</span><span class=p >]</span>

            <span class=k >if</span> <span class=n >r_en</span> <span class=o >-</span> <span class=n >r_st</span> <span class=o >&gt;</span> <span class=mi >0</span><span class=p >:</span>
                <span class=n >a</span><span class=p >[</span><span class=n >r_st</span><span class=p >:</span><span class=n >r_en</span><span class=p >,</span> <span class=n >c_st</span><span class=p >:</span><span class=n >c_en</span><span class=p >]</span> <span class=o >=</span> <span class=n >c</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span>
                <span class=n >b</span><span class=p >[</span><span class=n >r_st</span><span class=p >:</span><span class=n >r_en</span><span class=p >]</span> <span class=o >=</span> <span class=n >c</span><span class=p >[</span><span class=mi >1</span><span class=p >]</span>

        <span class=n >bounds</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >bounds</span><span class=p >()</span>
        <span class=n >bounds</span><span class=o >.</span><span class=n >extend</span><span class=p >(</span><span class=n >v</span><span class=o >.</span><span class=n >bounds</span><span class=p >(</span><span class=n >resids</span><span class=p >))</span>
        <span class=n >bounds</span><span class=o >.</span><span class=n >extend</span><span class=p >(</span><span class=n >d</span><span class=o >.</span><span class=n >bounds</span><span class=p >(</span><span class=n >std_resids</span><span class=p >))</span>

        <span class=c1 ># 3. Construct starting values from all models</span>
        <span class=n >sv</span> <span class=o >=</span> <span class=n >starting_values</span>
        <span class=k >if</span> <span class=n >starting_values</span> <span class=ow >is</span> <span class=ow >not</span> <span class=kc >None</span><span class=p >:</span>
            <span class=k >assert</span> <span class=n >sv</span> <span class=ow >is</span> <span class=ow >not</span> <span class=kc >None</span>
            <span class=n >sv</span> <span class=o >=</span> <span class=n >ensure1d</span><span class=p >(</span><span class=n >sv</span><span class=p >,</span> <span class=s2 >"starting_values"</span><span class=p >)</span>
            <span class=n >valid</span> <span class=o >=</span> <span class=n >sv</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span> <span class=o >==</span> <span class=n >num_params</span>
            <span class=k >if</span> <span class=n >a</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span> <span class=o >&gt;</span> <span class=mi >0</span><span class=p >:</span>
                <span class=n >satisfies_constraints</span> <span class=o >=</span> <span class=n >a</span><span class=o >.</span><span class=n >dot</span><span class=p >(</span><span class=n >sv</span><span class=p >)</span> <span class=o >-</span> <span class=n >b</span> <span class=o >&gt;=</span> <span class=mi >0</span>
                <span class=n >valid</span> <span class=o >=</span> <span class=n >valid</span> <span class=ow >and</span> <span class=n >satisfies_constraints</span><span class=o >.</span><span class=n >all</span><span class=p >()</span>
            <span class=k >for</span> <span class=n >i</span><span class=p >,</span> <span class=n >bound</span> <span class=ow >in</span> <span class=nb >enumerate</span><span class=p >(</span><span class=n >bounds</span><span class=p >):</span>
                <span class=n >valid</span> <span class=o >=</span> <span class=n >valid</span> <span class=ow >and</span> <span class=n >bound</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span> <span class=o >&lt;=</span> <span class=n >sv</span><span class=p >[</span><span class=n >i</span><span class=p >]</span> <span class=o >&lt;=</span> <span class=n >bound</span><span class=p >[</span><span class=mi >1</span><span class=p >]</span>
            <span class=k >if</span> <span class=ow >not</span> <span class=n >valid</span><span class=p >:</span>
                <span class=n >warnings</span><span class=o >.</span><span class=n >warn</span><span class=p >(</span><span class=n >starting_value_warning</span><span class=p >,</span> <span class=n >StartingValueWarning</span><span class=p >)</span>
                <span class=n >starting_values</span> <span class=o >=</span> <span class=kc >None</span>

        <span class=k >if</span> <span class=n >starting_values</span> <span class=ow >is</span> <span class=kc >None</span><span class=p >:</span>
            <span class=n >sv</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >hstack</span><span class=p >(</span>
                <span class=p >[</span><span class=bp >self</span><span class=o >.</span><span class=n >starting_values</span><span class=p >(),</span> <span class=n >sv_volatility</span><span class=p >,</span> <span class=n >d</span><span class=o >.</span><span class=n >starting_values</span><span class=p >(</span><span class=n >std_resids</span><span class=p >)]</span>
            <span class=p >)</span>

        <span class=c1 ># 4. Estimate models using constrained optimization</span>
        <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"count"</span><span class=p >],</span> <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"iter"</span><span class=p >]</span> <span class=o >=</span> <span class=mi >0</span><span class=p >,</span> <span class=mi >0</span>
        <span class=k >if</span> <span class=ow >not</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >disp</span><span class=p >,</span> <span class=nb >str</span><span class=p >):</span>
            <span class=n >disp</span> <span class=o >=</span> <span class=nb >bool</span><span class=p >(</span><span class=n >disp</span><span class=p >)</span>
            <span class=n >disp</span> <span class=o >=</span> <span class=s2 >"off"</span> <span class=k >if</span> <span class=ow >not</span> <span class=n >disp</span> <span class=k >else</span> <span class=s2 >"final"</span>
        <span class=k >if</span> <span class=n >update_freq</span> <span class=o >&lt;=</span> <span class=mi >0</span> <span class=ow >or</span> <span class=n >disp</span> <span class=o >==</span> <span class=s2 >"off"</span><span class=p >:</span>
            <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"display"</span><span class=p >]</span> <span class=o >=</span> <span class=mi >2</span><span class=o >**</span><span class=mi >31</span>

        <span class=k >else</span><span class=p >:</span>
            <span class=n >_callback_info</span><span class=p >[</span><span class=s2 >"display"</span><span class=p >]</span> <span class=o >=</span> <span class=n >update_freq</span>
        <span class=n >disp_flag</span> <span class=o >=</span> <span class=kc >True</span> <span class=k >if</span> <span class=n >disp</span> <span class=o >==</span> <span class=s2 >"final"</span> <span class=k >else</span> <span class=kc >False</span>

        <span class=n >func</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_loglikelihood</span>
        <span class=n >args</span> <span class=o >=</span> <span class=p >(</span><span class=n >sigma2</span><span class=p >,</span> <span class=n >backcast</span><span class=p >,</span> <span class=n >var_bounds</span><span class=p >)</span>
        <span class=n >ineq_constraints</span> <span class=o >=</span> <span class=n >constraint</span><span class=p >(</span><span class=n >a</span><span class=p >,</span> <span class=n >b</span><span class=p >)</span>

        <span class=kn >from</span> <span class=nn >scipy.optimize</span> <span class=kn >import</span> <span class=n >minimize</span>

        <span class=n >options</span> <span class=o >=</span> <span class=p >{}</span> <span class=k >if</span> <span class=n >options</span> <span class=ow >is</span> <span class=kc >None</span> <span class=k >else</span> <span class=n >options</span>
        <span class=n >options</span><span class=o >.</span><span class=n >setdefault</span><span class=p >(</span><span class=s2 >"disp"</span><span class=p >,</span> <span class=n >disp_flag</span><span class=p >)</span>
        <span class=k >with</span> <span class=n >warnings</span><span class=o >.</span><span class=n >catch_warnings</span><span class=p >():</span>
            <span class=n >warnings</span><span class=o >.</span><span class=n >filterwarnings</span><span class=p >(</span>
                <span class=s2 >"ignore"</span><span class=p >,</span>
                <span class=s2 >"Values in x were outside bounds during a minimize step"</span><span class=p >,</span>
                <span class=ne >RuntimeWarning</span><span class=p >,</span>
            <span class=p >)</span>
            <span class=n >opt</span> <span class=o >=</span> <span class=n >minimize</span><span class=p >(</span>
                <span class=n >func</span><span class=p >,</span>
                <span class=n >sv</span><span class=p >,</span>
                <span class=n >args</span><span class=o >=</span><span class=n >args</span><span class=p >,</span>
                <span class=n >method</span><span class=o >=</span><span class=s2 >"SLSQP"</span><span class=p >,</span>
                <span class=n >bounds</span><span class=o >=</span><span class=n >bounds</span><span class=p >,</span>
                <span class=n >constraints</span><span class=o >=</span><span class=n >ineq_constraints</span><span class=p >,</span>
                <span class=n >tol</span><span class=o >=</span><span class=n >tol</span><span class=p >,</span>
                <span class=n >callback</span><span class=o >=</span><span class=n >_callback</span><span class=p >,</span>
                <span class=n >options</span><span class=o >=</span><span class=n >options</span><span class=p >,</span>
            <span class=p >)</span>

        <span class=k >if</span> <span class=n >show_warning</span><span class=p >:</span>
            <span class=n >warnings</span><span class=o >.</span><span class=n >filterwarnings</span><span class=p >(</span><span class=s2 >"always"</span><span class=p >,</span> <span class=s2 >""</span><span class=p >,</span> <span class=n >ConvergenceWarning</span><span class=p >)</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=n >warnings</span><span class=o >.</span><span class=n >filterwarnings</span><span class=p >(</span><span class=s2 >"ignore"</span><span class=p >,</span> <span class=s2 >""</span><span class=p >,</span> <span class=n >ConvergenceWarning</span><span class=p >)</span>

        <span class=k >if</span> <span class=n >opt</span><span class=o >.</span><span class=n >status</span> <span class=o >!=</span> <span class=mi >0</span> <span class=ow >and</span> <span class=n >show_warning</span><span class=p >:</span>
            <span class=n >warnings</span><span class=o >.</span><span class=n >warn</span><span class=p >(</span>
                <span class=n >convergence_warning</span><span class=o >.</span><span class=n >format</span><span class=p >(</span><span class=n >code</span><span class=o >=</span><span class=n >opt</span><span class=o >.</span><span class=n >status</span><span class=p >,</span> <span class=n >string_message</span><span class=o >=</span><span class=n >opt</span><span class=o >.</span><span class=n >message</span><span class=p >),</span>
                <span class=n >ConvergenceWarning</span><span class=p >,</span>
            <span class=p >)</span>

        <span class=c1 ># 5. Return results</span>
        <span class=n >params</span> <span class=o >=</span> <span class=n >opt</span><span class=o >.</span><span class=n >x</span>
        <span class=n >loglikelihood</span> <span class=o >=</span> <span class=o >-</span><span class=mf >1.0</span> <span class=o >*</span> <span class=n >opt</span><span class=o >.</span><span class=n >fun</span>

        <span class=n >mp</span><span class=p >,</span> <span class=n >vp</span><span class=p >,</span> <span class=n >dp</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_parse_parameters</span><span class=p >(</span><span class=n >params</span><span class=p >)</span>

        <span class=n >resids</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >resids</span><span class=p >(</span><span class=n >mp</span><span class=p >),</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span><span class=p >)</span>
        <span class=n >vol</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros_like</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >compute_variance</span><span class=p >(</span><span class=n >vp</span><span class=p >,</span> <span class=n >resids</span><span class=p >,</span> <span class=n >vol</span><span class=p >,</span> <span class=n >backcast</span><span class=p >,</span> <span class=n >var_bounds</span><span class=p >)</span>
        <span class=n >vol</span> <span class=o >=</span> <span class=n >cast</span><span class=p >(</span><span class=n >Float64Array</span><span class=p >,</span> <span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >vol</span><span class=p >))</span>

        <span class=k >try</span><span class=p >:</span>
            <span class=n >r2</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_r2</span><span class=p >(</span><span class=n >mp</span><span class=p >)</span>
        <span class=k >except</span> <span class=ne >NotImplementedError</span><span class=p >:</span>
            <span class=n >r2</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >nan</span>

        <span class=n >names</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_all_parameter_names</span><span class=p >()</span>
        <span class=c1 ># Reshape resids and vol</span>
        <span class=n >first_obs</span><span class=p >,</span> <span class=n >last_obs</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_fit_indices</span>
        <span class=n >resids_final</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >empty_like</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_y</span><span class=p >,</span> <span class=n >dtype</span><span class=o >=</span><span class=n >np</span><span class=o >.</span><span class=n >float64</span><span class=p >)</span>
        <span class=n >resids_final</span><span class=o >.</span><span class=n >fill</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >nan</span><span class=p >)</span>
        <span class=n >resids_final</span><span class=p >[</span><span class=n >first_obs</span><span class=p >:</span><span class=n >last_obs</span><span class=p >]</span> <span class=o >=</span> <span class=n >resids</span>
        <span class=n >vol_final</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >empty_like</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_y</span><span class=p >,</span> <span class=n >dtype</span><span class=o >=</span><span class=n >np</span><span class=o >.</span><span class=n >float64</span><span class=p >)</span>
        <span class=n >vol_final</span><span class=o >.</span><span class=n >fill</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >nan</span><span class=p >)</span>
        <span class=n >vol_final</span><span class=p >[</span><span class=n >first_obs</span><span class=p >:</span><span class=n >last_obs</span><span class=p >]</span> <span class=o >=</span> <span class=n >vol</span>

        <span class=n >fit_start</span><span class=p >,</span> <span class=n >fit_stop</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_fit_indices</span>
        <span class=n >model_copy</span> <span class=o >=</span> <span class=n >deepcopy</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span>
        <span class=k >assert</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >r2</span><span class=p >,</span> <span class=nb >float</span><span class=p >)</span>
        <span class=k >return</span> <span class=n >ARCHModelResult</span><span class=p >(</span>
            <span class=n >params</span><span class=p >,</span>
            <span class=kc >None</span><span class=p >,</span>
            <span class=n >r2</span><span class=p >,</span>
            <span class=n >resids_final</span><span class=p >,</span>
            <span class=n >vol_final</span><span class=p >,</span>
            <span class=n >cov_type</span><span class=p >,</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_y_series</span><span class=p >,</span>
            <span class=n >names</span><span class=p >,</span>
            <span class=n >loglikelihood</span><span class=p >,</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_is_pandas</span><span class=p >,</span>
            <span class=n >opt</span><span class=p >,</span>
            <span class=n >fit_start</span><span class=p >,</span>
            <span class=n >fit_stop</span><span class=p >,</span>
            <span class=n >model_copy</span><span class=p >,</span>
        <span class=p >)</span></div>

<div class=viewcode-block  id=ARCHModel.parameter_names ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModel.parameter_names.html#arch.univariate.base.ARCHModel.parameter_names">[docs]</a>    <span class=nd >@abstractmethod</span>
    <span class=k >def</span> <span class=nf >parameter_names</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >list</span><span class=p >[</span><span class=nb >str</span><span class=p >]:</span>
        <span class=sd >"""List of parameters names</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        names : list (str)</span>
<span class=sd >            List of variable names for the mean model</span>
<span class=sd >        """</span></div>

<div class=viewcode-block  id=ARCHModel.starting_values ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModel.starting_values.html#arch.univariate.base.ARCHModel.starting_values">[docs]</a>    <span class=k >def</span> <span class=nf >starting_values</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Float64Array</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Returns starting values for the mean model, often the same as the</span>
<span class=sd >        values returned from fit</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        sv : ndarray</span>
<span class=sd >            Starting values</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_fit_no_arch_normal_errors_params</span><span class=p >()</span></div>

<div class=viewcode-block  id=ARCHModel.num_params ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModel.num_params.html#arch.univariate.base.ARCHModel.num_params">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=nd >@abstractmethod</span>
    <span class=k >def</span> <span class=nf >num_params</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >int</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Number of parameters in the model</span>
<span class=sd >        """</span></div>

<div class=viewcode-block  id=ARCHModel.simulate ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModel.simulate.html#arch.univariate.base.ARCHModel.simulate">[docs]</a>    <span class=nd >@abstractmethod</span>
    <span class=k >def</span> <span class=nf >simulate</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >params</span><span class=p >:</span> <span class=n >ArrayLike1D</span> <span class=o >|</span> <span class=n >Sequence</span><span class=p >[</span><span class=nb >float</span><span class=p >],</span>
        <span class=n >nobs</span><span class=p >:</span> <span class=nb >int</span><span class=p >,</span>
        <span class=n >burn</span><span class=p >:</span> <span class=nb >int</span> <span class=o >=</span> <span class=mi >500</span><span class=p >,</span>
        <span class=n >initial_value</span><span class=p >:</span> <span class=nb >float</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >x</span><span class=p >:</span> <span class=n >ArrayLike</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >initial_value_vol</span><span class=p >:</span> <span class=nb >float</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >:</span>
        <span class=k >pass</span></div>

<div class=viewcode-block  id=ARCHModel.resids ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModel.resids.html#arch.univariate.base.ARCHModel.resids">[docs]</a>    <span class=nd >@abstractmethod</span>
    <span class=k >def</span> <span class=nf >resids</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >params</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >y</span><span class=p >:</span> <span class=n >ArrayLike1D</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >regressors</span><span class=p >:</span> <span class=n >ArrayLike2D</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=n >ArrayLike1D</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Compute model residuals</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        params : ndarray</span>
<span class=sd >            Model parameters</span>
<span class=sd >        y : ndarray, optional</span>
<span class=sd >            Alternative values to use when computing model residuals</span>
<span class=sd >        regressors : ndarray, optional</span>
<span class=sd >            Alternative regressor values to use when computing model residuals</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        resids : ndarray</span>
<span class=sd >            Model residuals</span>
<span class=sd >        """</span></div>

<div class=viewcode-block  id=ARCHModel.compute_param_cov ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModel.compute_param_cov.html#arch.univariate.base.ARCHModel.compute_param_cov">[docs]</a>    <span class=k >def</span> <span class=nf >compute_param_cov</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >params</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >backcast</span><span class=p >:</span> <span class=kc >None</span> <span class=o >|</span> <span class=nb >float</span> <span class=o >|</span> <span class=n >Float64Array</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >robust</span><span class=p >:</span> <span class=nb >bool</span> <span class=o >=</span> <span class=kc >True</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Float64Array</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Computes parameter covariances using numerical derivatives.</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        params : ndarray</span>
<span class=sd >            Model parameters</span>
<span class=sd >        backcast : float</span>
<span class=sd >            Value to use for pre-sample observations</span>
<span class=sd >        robust : bool, optional</span>
<span class=sd >            Flag indicating whether to use robust standard errors (True) or</span>
<span class=sd >            classic MLE (False)</span>

<span class=sd >        """</span>
        <span class=n >resids</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >resids</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >starting_values</span><span class=p >()),</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span><span class=p >)</span>
        <span class=n >var_bounds</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >variance_bounds</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>
        <span class=n >nobs</span> <span class=o >=</span> <span class=n >resids</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span>
        <span class=k >if</span> <span class=n >backcast</span> <span class=ow >is</span> <span class=kc >None</span> <span class=ow >and</span> <span class=bp >self</span><span class=o >.</span><span class=n >_backcast</span> <span class=ow >is</span> <span class=kc >None</span><span class=p >:</span>
            <span class=n >backcast</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >backcast</span><span class=p >(</span><span class=n >resids</span><span class=p >)</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >_backcast</span> <span class=o >=</span> <span class=n >backcast</span>
        <span class=k >elif</span> <span class=n >backcast</span> <span class=ow >is</span> <span class=kc >None</span><span class=p >:</span>
            <span class=n >backcast</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_backcast</span>

        <span class=n >kwargs</span> <span class=o >=</span> <span class=p >{</span>
            <span class=s2 >"sigma2"</span><span class=p >:</span> <span class=n >np</span><span class=o >.</span><span class=n >zeros_like</span><span class=p >(</span><span class=n >resids</span><span class=p >),</span>
            <span class=s2 >"backcast"</span><span class=p >:</span> <span class=n >backcast</span><span class=p >,</span>
            <span class=s2 >"var_bounds"</span><span class=p >:</span> <span class=n >var_bounds</span><span class=p >,</span>
            <span class=s2 >"individual"</span><span class=p >:</span> <span class=kc >False</span><span class=p >,</span>
        <span class=p >}</span>

        <span class=n >hess</span> <span class=o >=</span> <span class=n >approx_hess</span><span class=p >(</span><span class=n >params</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_loglikelihood</span><span class=p >,</span> <span class=n >kwargs</span><span class=o >=</span><span class=n >kwargs</span><span class=p >)</span>
        <span class=n >hess</span> <span class=o >/=</span> <span class=n >nobs</span>
        <span class=n >inv_hess</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >linalg</span><span class=o >.</span><span class=n >inv</span><span class=p >(</span><span class=n >hess</span><span class=p >)</span>
        <span class=k >if</span> <span class=n >robust</span><span class=p >:</span>
            <span class=n >kwargs</span><span class=p >[</span><span class=s2 >"individual"</span><span class=p >]</span> <span class=o >=</span> <span class=kc >True</span>
            <span class=n >scores</span> <span class=o >=</span> <span class=n >approx_fprime</span><span class=p >(</span>
                <span class=n >params</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_loglikelihood</span><span class=p >,</span> <span class=n >kwargs</span><span class=o >=</span><span class=n >kwargs</span>
            <span class=p >)</span>  <span class=c1 ># type: np.ndarray</span>
            <span class=n >score_cov</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >cov</span><span class=p >(</span><span class=n >scores</span><span class=o >.</span><span class=n >T</span><span class=p >)</span>
            <span class=k >return</span> <span class=n >inv_hess</span><span class=o >.</span><span class=n >dot</span><span class=p >(</span><span class=n >score_cov</span><span class=p >)</span><span class=o >.</span><span class=n >dot</span><span class=p >(</span><span class=n >inv_hess</span><span class=p >)</span> <span class=o >/</span> <span class=n >nobs</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=k >return</span> <span class=n >inv_hess</span> <span class=o >/</span> <span class=n >nobs</span></div>

<div class=viewcode-block  id=ARCHModel.forecast ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModel.forecast.html#arch.univariate.base.ARCHModel.forecast">[docs]</a>    <span class=nd >@abstractmethod</span>
    <span class=k >def</span> <span class=nf >forecast</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >params</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >horizon</span><span class=p >:</span> <span class=nb >int</span> <span class=o >=</span> <span class=mi >1</span><span class=p >,</span>
        <span class=n >start</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=n >DateLike</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >align</span><span class=p >:</span> <span class=n >Literal</span><span class=p >[</span><span class=s2 >"origin"</span><span class=p >,</span> <span class=s2 >"target"</span><span class=p >]</span> <span class=o >=</span> <span class=s2 >"origin"</span><span class=p >,</span>
        <span class=n >method</span><span class=p >:</span> <span class=n >ForecastingMethod</span> <span class=o >=</span> <span class=s2 >"analytic"</span><span class=p >,</span>
        <span class=n >simulations</span><span class=p >:</span> <span class=nb >int</span> <span class=o >=</span> <span class=mi >1000</span><span class=p >,</span>
        <span class=n >rng</span><span class=p >:</span> <span class=n >Callable</span><span class=p >[[</span><span class=nb >int</span> <span class=o >|</span> <span class=nb >tuple</span><span class=p >[</span><span class=nb >int</span><span class=p >,</span> <span class=o >...</span><span class=p >]],</span> <span class=n >Float64Array</span><span class=p >]</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >random_state</span><span class=p >:</span> <span class=n >np</span><span class=o >.</span><span class=n >random</span><span class=o >.</span><span class=n >RandomState</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=o >*</span><span class=p >,</span>
        <span class=n >reindex</span><span class=p >:</span> <span class=nb >bool</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >x</span><span class=p >:</span> <span class=kc >None</span> <span class=o >|</span> <span class=nb >dict</span><span class=p >[</span><span class=n >Label</span><span class=p >,</span> <span class=n >ArrayLike</span><span class=p >]</span> <span class=o >|</span> <span class=n >ArrayLike</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=n >ARCHModelForecast</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Construct forecasts from estimated model</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        params : {ndarray, Series}</span>
<span class=sd >            Parameters required to forecast. Must be identical in</span>
<span class=sd >            shape to the parameters computed by fitting the model.</span>
<span class=sd >        horizon : int, optional</span>
<span class=sd >           Number of steps to forecast</span>
<span class=sd >        start : {int, datetime, Timestamp, str}, optional</span>
<span class=sd >            An integer, datetime or str indicating the first observation to</span>
<span class=sd >            produce the forecast for.  Datetimes can only be used with pandas</span>
<span class=sd >            inputs that have a datetime index. Strings must be convertible</span>
<span class=sd >            to a date time, such as in '1945-01-01'.</span>
<span class=sd >        align : str, optional</span>
<span class=sd >            Either 'origin' or 'target'.  When set of 'origin', the t-th row</span>
<span class=sd >            of forecasts contains the forecasts for t+1, t+2, ..., t+h. When</span>
<span class=sd >            set to 'target', the t-th row contains the 1-step ahead forecast</span>
<span class=sd >            from time t-1, the 2 step from time t-2, ..., and the h-step from</span>
<span class=sd >            time t-h.  'target' simplified computing forecast errors since the</span>
<span class=sd >            realization and h-step forecast are aligned.</span>
<span class=sd >        method : {'analytic', 'simulation', 'bootstrap'}</span>
<span class=sd >            Method to use when producing the forecast. The default is analytic.</span>
<span class=sd >            The method only affects the variance forecast generation.  Not all</span>
<span class=sd >            volatility models support all methods. In particular, volatility</span>
<span class=sd >            models that do not evolve in squares such as EGARCH or TARCH do not</span>
<span class=sd >            support the 'analytic' method for horizons &gt; 1.</span>
<span class=sd >        simulations : int</span>
<span class=sd >            Number of simulations to run when computing the forecast using</span>
<span class=sd >            either simulation or bootstrap.</span>
<span class=sd >        rng : callable, optional</span>
<span class=sd >            Custom random number generator to use in simulation-based forecasts.</span>
<span class=sd >            Must produce random samples using the syntax `rng(size)` where size</span>
<span class=sd >            the 2-element tuple (simulations, horizon).</span>
<span class=sd >        random_state : RandomState, optional</span>
<span class=sd >            NumPy RandomState instance to use when method is 'bootstrap'</span>
<span class=sd >        reindex : bool, optional</span>
<span class=sd >            Whether to reindex the forecasts to have the same dimension as the series</span>
<span class=sd >            being forecast. Prior to 4.18 this was the default. As of 4.19 this is</span>
<span class=sd >            now optional. If not provided, a warning is raised about the future</span>
<span class=sd >            change in the default which will occur after September 2021.</span>

<span class=sd >            .. versionadded:: 4.19</span>

<span class=sd >        x : {dict[label, array_like], array_like}</span>
<span class=sd >            Values to use for exogenous regressors if any are included in the</span>
<span class=sd >            model. Three formats are accepted:</span>

<span class=sd >            * 2-d array-like: This format can be used when there is a single</span>
<span class=sd >              exogenous variable. The input must have shape (nforecast, horizon)</span>
<span class=sd >              or (nobs, horizon) where nforecast is the number of forecasting</span>
<span class=sd >              periods and nobs is the original shape of y. For example, if a</span>
<span class=sd >              single series of forecasts are made from the end of the sample</span>
<span class=sd >              with a horizon of 10, then the input can be (1, 10). Alternatively,</span>
<span class=sd >              if the original data had 1000 observations, then the input can be</span>
<span class=sd >              (1000, 10), and only the final row is used to produce forecasts.</span>
<span class=sd >            * A dictionary of 2-d array-like: This format is identical to the</span>
<span class=sd >              previous except that the dictionary keys must match the names of</span>
<span class=sd >              the exog variables.  Requires that the exog variables were</span>
<span class=sd >              passed as a pandas DataFrame.</span>
<span class=sd >            * A 3-d NumPy array (or equivalent). In this format, each panel</span>
<span class=sd >              (0th axis) is a 2-d array that must have shape (nforecast, horizon)</span>
<span class=sd >              or (nobs,horizon). The array x[j] corresponds to the j-th column of</span>
<span class=sd >              the exogenous variables.</span>

<span class=sd >            Due to the complexity required to accommodate all scenarios, please</span>
<span class=sd >            see the example notebook that demonstrates the valid formats for</span>
<span class=sd >            x.</span>

<span class=sd >            .. versionadded:: 4.19</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        arch.univariate.base.ARCHModelForecast</span>
<span class=sd >            Container for forecasts. Key properties are ``mean``,</span>
<span class=sd >            ``variance`` and ``residual_variance``.</span>

<span class=sd >        Examples</span>
<span class=sd >        --------</span>
<span class=sd >        &gt;&gt;&gt; import pandas as pd</span>
<span class=sd >        &gt;&gt;&gt; from arch import arch_model</span>
<span class=sd >        &gt;&gt;&gt; am = arch_model(None,mean='HAR',lags=[1,5,22],vol='Constant')</span>
<span class=sd >        &gt;&gt;&gt; sim_data = am.simulate([0.1,0.4,0.3,0.2,1.0], 250)</span>
<span class=sd >        &gt;&gt;&gt; sim_data.index = pd.date_range('2000-01-01',periods=250)</span>
<span class=sd >        &gt;&gt;&gt; am = arch_model(sim_data['data'],mean='HAR',lags=[1,5,22],  vol='Constant')</span>
<span class=sd >        &gt;&gt;&gt; res = am.fit()</span>
<span class=sd >        &gt;&gt;&gt; fig = res.hedgehog_plot()</span>

<span class=sd >        Notes</span>
<span class=sd >        -----</span>
<span class=sd >        The most basic 1-step ahead forecast will return a vector with the same</span>
<span class=sd >        length as the original data, where the t-th value will be the time-t</span>
<span class=sd >        forecast for time t + 1.  When the horizon is &gt; 1, and when using the</span>
<span class=sd >        default value for `align`, the forecast value in position [t, h] is the</span>
<span class=sd >        time-t, h+1 step ahead forecast.</span>

<span class=sd >        If model contains exogenous variables (model.x is not None), then</span>
<span class=sd >        only 1-step ahead forecasts are available.  Using horizon &gt; 1 will</span>
<span class=sd >        produce a warning and all columns, except the first, will be</span>
<span class=sd >        nan-filled.</span>

<span class=sd >        If `align` is 'origin', forecast[t,h] contains the forecast made using</span>
<span class=sd >        y[:t] (that is, up to but not including t) for horizon h + 1.  For</span>
<span class=sd >        example, y[100,2] contains the 3-step ahead forecast using the first</span>
<span class=sd >        100 data points, which will correspond to the realization y[100 + 2].</span>
<span class=sd >        If `align` is 'target', then the same forecast is in location</span>
<span class=sd >        [102, 2], so that it is aligned with the observation to use when</span>
<span class=sd >        evaluating, but still in the same column.</span>
<span class=sd >        """</span></div></div>


<span class=k >class</span> <span class=nc >_SummaryRepr</span><span class=p >:</span>
    <span class=sd >"""Base class for returning summary as repr and str"""</span>

    <span class=k >def</span> <span class=nf >summary</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Summary</span><span class=p >:</span>
        <span class=k >raise</span> <span class=ne >NotImplementedError</span><span class=p >(</span><span class=s2 >"Subclasses must implement"</span><span class=p >)</span>

    <span class=k >def</span> <span class=fm >__repr__</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >str</span><span class=p >:</span>
        <span class=n >out</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=fm >__str__</span><span class=p >()</span> <span class=o >+</span> <span class=s2 >"</span><span class=se >\n</span><span class=s2 >"</span>
        <span class=n >out</span> <span class=o >+=</span> <span class=bp >self</span><span class=o >.</span><span class=vm >__class__</span><span class=o >.</span><span class=vm >__name__</span>
        <span class=n >out</span> <span class=o >+=</span> <span class=sa >f</span><span class=s2 >", id: </span><span class=si >{</span><span class=nb >hex</span><span class=p >(</span><span class=nb >id</span><span class=p >(</span><span class=bp >self</span><span class=p >))</span><span class=si >}</span><span class=s2 >"</span>
        <span class=k >return</span> <span class=n >out</span>

    <span class=k >def</span> <span class=fm >__str__</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >str</span><span class=p >:</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >summary</span><span class=p >()</span><span class=o >.</span><span class=n >as_text</span><span class=p >()</span>


<div class=viewcode-block  id=ARCHModelFixedResult ><a class=viewcode-back  href="../../../univariate/generated/arch.univariate.base.ARCHModelFixedResult.html#arch.univariate.base.ARCHModelFixedResult">[docs]</a><span class=k >class</span> <span class=nc >ARCHModelFixedResult</span><span class=p >(</span><span class=n >_SummaryRepr</span><span class=p >):</span>
    <span class=sd >"""</span>
<span class=sd >    Results for fixed parameters for an ARCHModel model</span>

<span class=sd >    Parameters</span>
<span class=sd >    ----------</span>
<span class=sd >    params : ndarray</span>
<span class=sd >        Estimated parameters</span>
<span class=sd >    resid : ndarray</span>
<span class=sd >        Residuals from model.  Residuals have same shape as original data and</span>
<span class=sd >        contain nan-values in locations not used in estimation</span>
<span class=sd >    volatility : ndarray</span>
<span class=sd >        Conditional volatility from model</span>
<span class=sd >    dep_var : Series</span>
<span class=sd >        Dependent variable</span>
<span class=sd >    names : list (str)</span>
<span class=sd >        Model parameter names</span>
<span class=sd >    loglikelihood : float</span>
<span class=sd >        Loglikelihood at specified parameters</span>
<span class=sd >    is_pandas : bool</span>
<span class=sd >        Whether the original input was pandas</span>
<span class=sd >    model : ARCHModel</span>
<span class=sd >        The model object used to estimate the parameters</span>
<span class=sd >    """</span>

    <span class=k >def</span> <span class=fm >__init__</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >params</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >resid</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >volatility</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >dep_var</span><span class=p >:</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >,</span>
        <span class=n >names</span><span class=p >:</span> <span class=nb >list</span><span class=p >[</span><span class=nb >str</span><span class=p >],</span>
        <span class=n >loglikelihood</span><span class=p >:</span> <span class=nb >float</span><span class=p >,</span>
        <span class=n >is_pandas</span><span class=p >:</span> <span class=nb >bool</span><span class=p >,</span>
        <span class=n >model</span><span class=p >:</span> <span class=n >ARCHModel</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span><span class=p >:</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_params</span> <span class=o >=</span> <span class=n >params</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_resid</span> <span class=o >=</span> <span class=n >resid</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_is_pandas</span> <span class=o >=</span> <span class=n >is_pandas</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_model</span> <span class=o >=</span> <span class=n >model</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_datetime</span> <span class=o >=</span> <span class=n >dt</span><span class=o >.</span><span class=n >datetime</span><span class=o >.</span><span class=n >now</span><span class=p >()</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_dep_var</span> <span class=o >=</span> <span class=n >dep_var</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_dep_name</span> <span class=o >=</span> <span class=nb >str</span><span class=p >(</span><span class=n >dep_var</span><span class=o >.</span><span class=n >name</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_names</span> <span class=o >=</span> <span class=nb >list</span><span class=p >(</span><span class=n >names</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_loglikelihood</span> <span class=o >=</span> <span class=n >loglikelihood</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_nobs</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >_fit_y</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_index</span> <span class=o >=</span> <span class=n >dep_var</span><span class=o >.</span><span class=n >index</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_volatility</span> <span class=o >=</span> <span class=n >volatility</span>

<div class=viewcode-block  id=ARCHModelFixedResult.summary ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.summary.html#arch.univariate.base.ARCHModelFixedResult.summary">[docs]</a>    <span class=k >def</span> <span class=nf >summary</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Summary</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Constructs a summary of the results from a fit model.</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        summary : Summary instance</span>
<span class=sd >            Object that contains tables and facilitated export to text, html or</span>
<span class=sd >            latex</span>
<span class=sd >        """</span>
        <span class=c1 ># Summary layout</span>
        <span class=c1 ># 1. Overall information</span>
        <span class=c1 ># 2. Mean parameters</span>
        <span class=c1 ># 3. Volatility parameters</span>
        <span class=c1 ># 4. Distribution parameters</span>
        <span class=c1 ># 5. Notes</span>

        <span class=n >model</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span>
        <span class=n >model_name</span> <span class=o >=</span> <span class=n >model</span><span class=o >.</span><span class=n >name</span> <span class=o >+</span> <span class=s2 >" - "</span> <span class=o >+</span> <span class=n >model</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >name</span>

        <span class=c1 ># Summary Header</span>
        <span class=n >top_left</span> <span class=o >=</span> <span class=p >[</span>
            <span class=p >(</span><span class=s2 >"Dep. Variable:"</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_dep_name</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Mean Model:"</span><span class=p >,</span> <span class=n >model</span><span class=o >.</span><span class=n >name</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Vol Model:"</span><span class=p >,</span> <span class=n >model</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >name</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Distribution:"</span><span class=p >,</span> <span class=n >model</span><span class=o >.</span><span class=n >distribution</span><span class=o >.</span><span class=n >name</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Method:"</span><span class=p >,</span> <span class=s2 >"User-specified Parameters"</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >""</span><span class=p >,</span> <span class=s2 >""</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Date:"</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_datetime</span><span class=o >.</span><span class=n >strftime</span><span class=p >(</span><span class=s2 >"</span><span class=si >%a</span><span class=s2 >, %b </span><span class=si >%d</span><span class=s2 > %Y"</span><span class=p >)),</span>
            <span class=p >(</span><span class=s2 >"Time:"</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_datetime</span><span class=o >.</span><span class=n >strftime</span><span class=p >(</span><span class=s2 >"%H:%M:%S"</span><span class=p >)),</span>
        <span class=p >]</span>

        <span class=n >top_right</span> <span class=o >=</span> <span class=p >[</span>
            <span class=p >(</span><span class=s2 >"R-squared:"</span><span class=p >,</span> <span class=s2 >"--"</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Adj. R-squared:"</span><span class=p >,</span> <span class=s2 >"--"</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Log-Likelihood:"</span><span class=p >,</span> <span class=s2 >"</span><span class=si >%#10.6g</span><span class=s2 >"</span> <span class=o >%</span> <span class=bp >self</span><span class=o >.</span><span class=n >loglikelihood</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"AIC:"</span><span class=p >,</span> <span class=s2 >"</span><span class=si >%#10.6g</span><span class=s2 >"</span> <span class=o >%</span> <span class=bp >self</span><span class=o >.</span><span class=n >aic</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"BIC:"</span><span class=p >,</span> <span class=s2 >"</span><span class=si >%#10.6g</span><span class=s2 >"</span> <span class=o >%</span> <span class=bp >self</span><span class=o >.</span><span class=n >bic</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"No. Observations:"</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_nobs</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >""</span><span class=p >,</span> <span class=s2 >""</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >""</span><span class=p >,</span> <span class=s2 >""</span><span class=p >),</span>
        <span class=p >]</span>

        <span class=n >title</span> <span class=o >=</span> <span class=n >model_name</span> <span class=o >+</span> <span class=s2 >" Model Results"</span>
        <span class=n >stubs</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=n >vals</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=k >for</span> <span class=n >stub</span><span class=p >,</span> <span class=n >val</span> <span class=ow >in</span> <span class=n >top_left</span><span class=p >:</span>
            <span class=n >stubs</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >stub</span><span class=p >)</span>
            <span class=n >vals</span><span class=o >.</span><span class=n >append</span><span class=p >([</span><span class=n >val</span><span class=p >])</span>
        <span class=n >table</span> <span class=o >=</span> <span class=n >SimpleTable</span><span class=p >(</span><span class=n >vals</span><span class=p >,</span> <span class=n >txt_fmt</span><span class=o >=</span><span class=n >fmt_2cols</span><span class=p >,</span> <span class=n >title</span><span class=o >=</span><span class=n >title</span><span class=p >,</span> <span class=n >stubs</span><span class=o >=</span><span class=n >stubs</span><span class=p >)</span>

        <span class=c1 ># create summary table instance</span>
        <span class=n >smry</span> <span class=o >=</span> <span class=n >Summary</span><span class=p >()</span>
        <span class=c1 ># Top Table</span>
        <span class=c1 ># Parameter table</span>
        <span class=n >fmt</span> <span class=o >=</span> <span class=n >fmt_2cols</span>
        <span class=n >fmt</span><span class=p >[</span><span class=s2 >"data_fmts"</span><span class=p >][</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=s2 >"</span><span class=si >%18s</span><span class=s2 >"</span>

        <span class=n >top_right</span> <span class=o >=</span> <span class=p >[(</span><span class=s2 >"</span><span class=si >%-21s</span><span class=s2 >"</span> <span class=o >%</span> <span class=p >(</span><span class=s2 >"  "</span> <span class=o >+</span> <span class=n >k</span><span class=p >),</span> <span class=n >v</span><span class=p >)</span> <span class=k >for</span> <span class=n >k</span><span class=p >,</span> <span class=n >v</span> <span class=ow >in</span> <span class=n >top_right</span><span class=p >]</span>
        <span class=n >stubs</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=n >vals</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=k >for</span> <span class=n >stub</span><span class=p >,</span> <span class=n >val</span> <span class=ow >in</span> <span class=n >top_right</span><span class=p >:</span>
            <span class=n >stubs</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >stub</span><span class=p >)</span>
            <span class=n >vals</span><span class=o >.</span><span class=n >append</span><span class=p >([</span><span class=n >val</span><span class=p >])</span>
        <span class=n >table</span><span class=o >.</span><span class=n >extend_right</span><span class=p >(</span><span class=n >SimpleTable</span><span class=p >(</span><span class=n >vals</span><span class=p >,</span> <span class=n >stubs</span><span class=o >=</span><span class=n >stubs</span><span class=p >))</span>
        <span class=n >smry</span><span class=o >.</span><span class=n >tables</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >table</span><span class=p >)</span>

        <span class=n >stubs</span> <span class=o >=</span> <span class=nb >list</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_names</span><span class=p >)</span>
        <span class=n >header</span> <span class=o >=</span> <span class=p >[</span><span class=s2 >"coef"</span><span class=p >]</span>
        <span class=n >coef_vals</span> <span class=o >=</span> <span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >params</span><span class=p >,)</span>
        <span class=n >formats</span> <span class=o >=</span> <span class=p >[(</span><span class=mi >10</span><span class=p >,</span> <span class=mi >4</span><span class=p >)]</span>
        <span class=n >pos</span> <span class=o >=</span> <span class=mi >0</span>
        <span class=n >param_table_data</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=k >for</span> <span class=n >_</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=nb >len</span><span class=p >(</span><span class=n >coef_vals</span><span class=p >[</span><span class=mi >0</span><span class=p >])):</span>
            <span class=n >row</span> <span class=o >=</span> <span class=p >[]</span>
            <span class=k >for</span> <span class=n >i</span><span class=p >,</span> <span class=n >val</span> <span class=ow >in</span> <span class=nb >enumerate</span><span class=p >(</span><span class=n >coef_vals</span><span class=p >):</span>
                <span class=k >if</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >val</span><span class=p >[</span><span class=n >pos</span><span class=p >],</span> <span class=n >np</span><span class=o >.</span><span class=n >float64</span><span class=p >):</span>
                    <span class=n >converted</span> <span class=o >=</span> <span class=n >format_float_fixed</span><span class=p >(</span><span class=n >val</span><span class=p >[</span><span class=n >pos</span><span class=p >],</span> <span class=o >*</span><span class=n >formats</span><span class=p >[</span><span class=n >i</span><span class=p >])</span>
                <span class=k >else</span><span class=p >:</span>
                    <span class=n >converted</span> <span class=o >=</span> <span class=n >val</span><span class=p >[</span><span class=n >pos</span><span class=p >]</span>
                <span class=n >row</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >converted</span><span class=p >)</span>
            <span class=n >pos</span> <span class=o >+=</span> <span class=mi >1</span>
            <span class=n >param_table_data</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >row</span><span class=p >)</span>

        <span class=n >mc</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >num_params</span>
        <span class=n >vc</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >num_params</span>
        <span class=n >dc</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >distribution</span><span class=o >.</span><span class=n >num_params</span>
        <span class=n >counts</span> <span class=o >=</span> <span class=p >(</span><span class=n >mc</span><span class=p >,</span> <span class=n >vc</span><span class=p >,</span> <span class=n >dc</span><span class=p >)</span>
        <span class=n >titles</span> <span class=o >=</span> <span class=p >(</span><span class=s2 >"Mean Model"</span><span class=p >,</span> <span class=s2 >"Volatility Model"</span><span class=p >,</span> <span class=s2 >"Distribution"</span><span class=p >)</span>
        <span class=n >total</span> <span class=o >=</span> <span class=mi >0</span>
        <span class=k >for</span> <span class=n >title</span><span class=p >,</span> <span class=n >count</span> <span class=ow >in</span> <span class=nb >zip</span><span class=p >(</span><span class=n >titles</span><span class=p >,</span> <span class=n >counts</span><span class=p >):</span>
            <span class=k >if</span> <span class=n >count</span> <span class=o >==</span> <span class=mi >0</span><span class=p >:</span>
                <span class=k >continue</span>

            <span class=n >table_data</span> <span class=o >=</span> <span class=n >param_table_data</span><span class=p >[</span><span class=n >total</span> <span class=p >:</span> <span class=n >total</span> <span class=o >+</span> <span class=n >count</span><span class=p >]</span>
            <span class=n >table_stubs</span> <span class=o >=</span> <span class=n >stubs</span><span class=p >[</span><span class=n >total</span> <span class=p >:</span> <span class=n >total</span> <span class=o >+</span> <span class=n >count</span><span class=p >]</span>
            <span class=n >total</span> <span class=o >+=</span> <span class=n >count</span>
            <span class=n >table</span> <span class=o >=</span> <span class=n >SimpleTable</span><span class=p >(</span>
                <span class=n >table_data</span><span class=p >,</span>
                <span class=n >stubs</span><span class=o >=</span><span class=n >table_stubs</span><span class=p >,</span>
                <span class=n >txt_fmt</span><span class=o >=</span><span class=n >fmt_params</span><span class=p >,</span>
                <span class=n >headers</span><span class=o >=</span><span class=n >header</span><span class=p >,</span>
                <span class=n >title</span><span class=o >=</span><span class=n >title</span><span class=p >,</span>
            <span class=p >)</span>
            <span class=n >smry</span><span class=o >.</span><span class=n >tables</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >table</span><span class=p >)</span>

        <span class=n >extra_text</span> <span class=o >=</span> <span class=p >[</span>
            <span class=s2 >"Results generated with user-specified parameters."</span><span class=p >,</span>
            <span class=s2 >"Std. errors not available when the model is not estimated, "</span><span class=p >,</span>
        <span class=p >]</span>
        <span class=n >smry</span><span class=o >.</span><span class=n >add_extra_txt</span><span class=p >(</span><span class=n >extra_text</span><span class=p >)</span>
        <span class=k >return</span> <span class=n >smry</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.model ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.model.html#arch.univariate.base.ARCHModelFixedResult.model">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >model</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >ARCHModel</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Model instance used to produce the fit</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_model</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.loglikelihood ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.loglikelihood.html#arch.univariate.base.ARCHModelFixedResult.loglikelihood">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >loglikelihood</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >float</span><span class=p >:</span>
        <span class=sd >"""Model loglikelihood"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_loglikelihood</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.aic ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.aic.html#arch.univariate.base.ARCHModelFixedResult.aic">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >aic</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >float</span><span class=p >:</span>
        <span class=sd >"""Akaike Information Criteria</span>

<span class=sd >        -2 * loglikelihood + 2 * num_params"""</span>
        <span class=k >return</span> <span class=o >-</span><span class=mi >2</span> <span class=o >*</span> <span class=bp >self</span><span class=o >.</span><span class=n >loglikelihood</span> <span class=o >+</span> <span class=mi >2</span> <span class=o >*</span> <span class=bp >self</span><span class=o >.</span><span class=n >num_params</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.num_params ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.num_params.html#arch.univariate.base.ARCHModelFixedResult.num_params">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >num_params</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >int</span><span class=p >:</span>
        <span class=sd >"""Number of parameters in model"""</span>
        <span class=k >return</span> <span class=nb >len</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >params</span><span class=p >)</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.bic ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.bic.html#arch.univariate.base.ARCHModelFixedResult.bic">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >bic</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >float</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Schwarz/Bayesian Information Criteria</span>

<span class=sd >        -2 * loglikelihood + log(nobs) * num_params</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=o >-</span><span class=mi >2</span> <span class=o >*</span> <span class=bp >self</span><span class=o >.</span><span class=n >loglikelihood</span> <span class=o >+</span> <span class=n >np</span><span class=o >.</span><span class=n >log</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >nobs</span><span class=p >)</span> <span class=o >*</span> <span class=bp >self</span><span class=o >.</span><span class=n >num_params</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.params ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.params.html#arch.univariate.base.ARCHModelFixedResult.params">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >params</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >:</span>
        <span class=sd >"""Model Parameters"""</span>
        <span class=k >return</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_params</span><span class=p >,</span> <span class=n >index</span><span class=o >=</span><span class=bp >self</span><span class=o >.</span><span class=n >_names</span><span class=p >,</span> <span class=n >name</span><span class=o >=</span><span class=s2 >"params"</span><span class=p >)</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.conditional_volatility ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.conditional_volatility.html#arch.univariate.base.ARCHModelFixedResult.conditional_volatility">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >conditional_volatility</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span> <span class=o >|</span> <span class=n >Float64Array</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Estimated conditional volatility</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        conditional_volatility : {ndarray, Series}</span>
<span class=sd >            nobs element array containing the conditional volatility (square</span>
<span class=sd >            root of conditional variance).  The values are aligned with the</span>
<span class=sd >            input data so that the value in the t-th position is the variance</span>
<span class=sd >            of t-th error, which is computed using time-(t-1) information.</span>
<span class=sd >        """</span>
        <span class=k >if</span> <span class=bp >self</span><span class=o >.</span><span class=n >_is_pandas</span><span class=p >:</span>
            <span class=k >return</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_volatility</span><span class=p >,</span> <span class=n >name</span><span class=o >=</span><span class=s2 >"cond_vol"</span><span class=p >,</span> <span class=n >index</span><span class=o >=</span><span class=bp >self</span><span class=o >.</span><span class=n >_index</span><span class=p >)</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_volatility</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.nobs ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.nobs.html#arch.univariate.base.ARCHModelFixedResult.nobs">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >nobs</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >int</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Number of data points used to estimate model</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_nobs</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.resid ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.resid.html#arch.univariate.base.ARCHModelFixedResult.resid">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >resid</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Model residuals</span>
<span class=sd >        """</span>
        <span class=k >if</span> <span class=bp >self</span><span class=o >.</span><span class=n >_is_pandas</span><span class=p >:</span>
            <span class=k >return</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_resid</span><span class=p >,</span> <span class=n >name</span><span class=o >=</span><span class=s2 >"resid"</span><span class=p >,</span> <span class=n >index</span><span class=o >=</span><span class=bp >self</span><span class=o >.</span><span class=n >_index</span><span class=p >)</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_resid</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.std_resid ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.std_resid.html#arch.univariate.base.ARCHModelFixedResult.std_resid">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >std_resid</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Residuals standardized by conditional volatility</span>
<span class=sd >        """</span>
        <span class=n >std_res</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >resid</span> <span class=o >/</span> <span class=bp >self</span><span class=o >.</span><span class=n >conditional_volatility</span>
        <span class=k >if</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >std_res</span><span class=p >,</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >):</span>
            <span class=n >std_res</span><span class=o >.</span><span class=n >name</span> <span class=o >=</span> <span class=s2 >"std_resid"</span>
        <span class=k >return</span> <span class=n >std_res</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.plot ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.plot.html#arch.univariate.base.ARCHModelFixedResult.plot">[docs]</a>    <span class=k >def</span> <span class=nf >plot</span><span class=p >(</span><span class=bp >self</span><span class=p >,</span> <span class=n >annualize</span><span class=p >:</span> <span class=nb >str</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span> <span class=n >scale</span><span class=p >:</span> <span class=nb >float</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Figure</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Plot standardized residuals and conditional volatility</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        annualize : str, optional</span>
<span class=sd >            String containing frequency of data that indicates plot should</span>
<span class=sd >            contain annualized volatility.  Supported values are 'D' (daily),</span>
<span class=sd >            'W' (weekly) and 'M' (monthly), which scale variance by 252, 52,</span>
<span class=sd >            and 12, respectively.</span>
<span class=sd >        scale : float, optional</span>
<span class=sd >            Value to use when scaling returns to annualize.  If scale is</span>
<span class=sd >            provided, annualize is ignored and the value in scale is used.</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        fig : figure</span>
<span class=sd >            Handle to the figure</span>

<span class=sd >        Examples</span>
<span class=sd >        --------</span>
<span class=sd >        &gt;&gt;&gt; from arch import arch_model</span>
<span class=sd >        &gt;&gt;&gt; am = arch_model(None)</span>
<span class=sd >        &gt;&gt;&gt; sim_data = am.simulate([0.0, 0.01, 0.07, 0.92], 2520)</span>
<span class=sd >        &gt;&gt;&gt; am = arch_model(sim_data['data'])</span>
<span class=sd >        &gt;&gt;&gt; res = am.fit(update_freq=0, disp='off')</span>
<span class=sd >        &gt;&gt;&gt; fig = res.plot()</span>

<span class=sd >        Produce a plot with annualized volatility</span>

<span class=sd >        &gt;&gt;&gt; fig = res.plot(annualize='D')</span>

<span class=sd >        Override the usual scale of 252 to use 360 for an asset that trades</span>
<span class=sd >        most days of the year</span>

<span class=sd >        &gt;&gt;&gt; fig = res.plot(scale=360)</span>
<span class=sd >        """</span>
        <span class=kn >from</span> <span class=nn >matplotlib.axes</span> <span class=kn >import</span> <span class=n >Axes</span>
        <span class=kn >from</span> <span class=nn >matplotlib.pyplot</span> <span class=kn >import</span> <span class=n >figure</span>

        <span class=k >def</span> <span class=nf >_set_tight_x</span><span class=p >(</span><span class=n >axis</span><span class=p >:</span> <span class=n >Axes</span><span class=p >,</span> <span class=n >index</span><span class=p >:</span> <span class=n >pd</span><span class=o >.</span><span class=n >Index</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span><span class=p >:</span>
            <span class=k >try</span><span class=p >:</span>
                <span class=n >axis</span><span class=o >.</span><span class=n >set_xlim</span><span class=p >(</span><span class=n >index</span><span class=p >[</span><span class=mi >0</span><span class=p >],</span> <span class=n >index</span><span class=p >[</span><span class=o >-</span><span class=mi >1</span><span class=p >])</span>
            <span class=k >except</span> <span class=ne >ValueError</span><span class=p >:</span>
                <span class=k >pass</span>

        <span class=n >fig</span> <span class=o >=</span> <span class=n >figure</span><span class=p >()</span>

        <span class=n >ax</span> <span class=o >=</span> <span class=n >fig</span><span class=o >.</span><span class=n >add_subplot</span><span class=p >(</span><span class=mi >2</span><span class=p >,</span> <span class=mi >1</span><span class=p >,</span> <span class=mi >1</span><span class=p >)</span>
        <span class=n >ax</span><span class=o >.</span><span class=n >plot</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_index</span><span class=o >.</span><span class=n >values</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >resid</span> <span class=o >/</span> <span class=bp >self</span><span class=o >.</span><span class=n >conditional_volatility</span><span class=p >)</span>
        <span class=n >ax</span><span class=o >.</span><span class=n >set_title</span><span class=p >(</span><span class=s2 >"Standardized Residuals"</span><span class=p >)</span>
        <span class=n >ax</span><span class=o >.</span><span class=n >axes</span><span class=o >.</span><span class=n >xaxis</span><span class=o >.</span><span class=n >set_ticklabels</span><span class=p >([])</span>
        <span class=n >_set_tight_x</span><span class=p >(</span><span class=n >ax</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_index</span><span class=p >)</span>

        <span class=n >ax</span> <span class=o >=</span> <span class=n >fig</span><span class=o >.</span><span class=n >add_subplot</span><span class=p >(</span><span class=mi >2</span><span class=p >,</span> <span class=mi >1</span><span class=p >,</span> <span class=mi >2</span><span class=p >)</span>
        <span class=n >vol</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >conditional_volatility</span>
        <span class=n >title</span> <span class=o >=</span> <span class=s2 >"Annualized Conditional Volatility"</span>
        <span class=k >if</span> <span class=n >scale</span> <span class=ow >is</span> <span class=ow >not</span> <span class=kc >None</span><span class=p >:</span>
            <span class=n >vol</span> <span class=o >=</span> <span class=n >vol</span> <span class=o >*</span> <span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >scale</span><span class=p >)</span>
        <span class=k >elif</span> <span class=n >annualize</span> <span class=ow >is</span> <span class=ow >not</span> <span class=kc >None</span><span class=p >:</span>
            <span class=n >scales</span> <span class=o >=</span> <span class=p >{</span><span class=s2 >"D"</span><span class=p >:</span> <span class=mi >252</span><span class=p >,</span> <span class=s2 >"W"</span><span class=p >:</span> <span class=mi >52</span><span class=p >,</span> <span class=s2 >"M"</span><span class=p >:</span> <span class=mi >12</span><span class=p >}</span>
            <span class=k >if</span> <span class=n >annualize</span> <span class=ow >in</span> <span class=n >scales</span><span class=p >:</span>
                <span class=n >vol</span> <span class=o >=</span> <span class=n >vol</span> <span class=o >*</span> <span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >scales</span><span class=p >[</span><span class=n >annualize</span><span class=p >])</span>
            <span class=k >else</span><span class=p >:</span>
                <span class=k >raise</span> <span class=ne >ValueError</span><span class=p >(</span><span class=s2 >"annualize not recognized"</span><span class=p >)</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=n >title</span> <span class=o >=</span> <span class=s2 >"Conditional Volatility"</span>

        <span class=n >ax</span><span class=o >.</span><span class=n >plot</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_index</span><span class=o >.</span><span class=n >values</span><span class=p >,</span> <span class=n >vol</span><span class=p >)</span>
        <span class=n >_set_tight_x</span><span class=p >(</span><span class=n >ax</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_index</span><span class=p >)</span>
        <span class=n >ax</span><span class=o >.</span><span class=n >set_title</span><span class=p >(</span><span class=n >title</span><span class=p >)</span>

        <span class=k >return</span> <span class=n >fig</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.forecast ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.forecast.html#arch.univariate.base.ARCHModelFixedResult.forecast">[docs]</a>    <span class=k >def</span> <span class=nf >forecast</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >params</span><span class=p >:</span> <span class=n >ArrayLike1D</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >horizon</span><span class=p >:</span> <span class=nb >int</span> <span class=o >=</span> <span class=mi >1</span><span class=p >,</span>
        <span class=n >start</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=n >DateLike</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >align</span><span class=p >:</span> <span class=n >Literal</span><span class=p >[</span><span class=s2 >"origin"</span><span class=p >,</span> <span class=s2 >"target"</span><span class=p >]</span> <span class=o >=</span> <span class=s2 >"origin"</span><span class=p >,</span>
        <span class=n >method</span><span class=p >:</span> <span class=n >ForecastingMethod</span> <span class=o >=</span> <span class=s2 >"analytic"</span><span class=p >,</span>
        <span class=n >simulations</span><span class=p >:</span> <span class=nb >int</span> <span class=o >=</span> <span class=mi >1000</span><span class=p >,</span>
        <span class=n >rng</span><span class=p >:</span> <span class=n >Callable</span><span class=p >[[</span><span class=nb >int</span> <span class=o >|</span> <span class=nb >tuple</span><span class=p >[</span><span class=nb >int</span><span class=p >,</span> <span class=o >...</span><span class=p >]],</span> <span class=n >Float64Array</span><span class=p >]</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >random_state</span><span class=p >:</span> <span class=n >np</span><span class=o >.</span><span class=n >random</span><span class=o >.</span><span class=n >RandomState</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=o >*</span><span class=p >,</span>
        <span class=n >reindex</span><span class=p >:</span> <span class=nb >bool</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >x</span><span class=p >:</span> <span class=kc >None</span> <span class=o >|</span> <span class=nb >dict</span><span class=p >[</span><span class=n >Label</span><span class=p >,</span> <span class=n >ArrayLike</span><span class=p >]</span> <span class=o >|</span> <span class=n >ArrayLike</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=n >ARCHModelForecast</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Construct forecasts from estimated model</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        params : ndarray, optional</span>
<span class=sd >            Alternative parameters to use.  If not provided, the parameters</span>
<span class=sd >            estimated when fitting the model are used.  Must be identical in</span>
<span class=sd >            shape to the parameters computed by fitting the model.</span>
<span class=sd >        horizon : int, optional</span>
<span class=sd >           Number of steps to forecast</span>
<span class=sd >        start : {int, datetime, Timestamp, str}, optional</span>
<span class=sd >            An integer, datetime or str indicating the first observation to</span>
<span class=sd >            produce the forecast for.  Datetimes can only be used with pandas</span>
<span class=sd >            inputs that have a datetime index. Strings must be convertible</span>
<span class=sd >            to a date time, such as in '1945-01-01'.</span>
<span class=sd >        align : str, optional</span>
<span class=sd >            Either 'origin' or 'target'.  When set of 'origin', the t-th row</span>
<span class=sd >            of forecasts contains the forecasts for t+1, t+2, ..., t+h. When</span>
<span class=sd >            set to 'target', the t-th row contains the 1-step ahead forecast</span>
<span class=sd >            from time t-1, the 2 step from time t-2, ..., and the h-step from</span>
<span class=sd >            time t-h.  'target' simplified computing forecast errors since the</span>
<span class=sd >            realization and h-step forecast are aligned.</span>
<span class=sd >        method : {'analytic', 'simulation', 'bootstrap'}, optional</span>
<span class=sd >            Method to use when producing the forecast. The default is analytic.</span>
<span class=sd >            The method only affects the variance forecast generation.  Not all</span>
<span class=sd >            volatility models support all methods. In particular, volatility</span>
<span class=sd >            models that do not evolve in squares such as EGARCH or TARCH do not</span>
<span class=sd >            support the 'analytic' method for horizons &gt; 1.</span>
<span class=sd >        simulations : int, optional</span>
<span class=sd >            Number of simulations to run when computing the forecast using</span>
<span class=sd >            either simulation or bootstrap.</span>
<span class=sd >        rng : callable, optional</span>
<span class=sd >            Custom random number generator to use in simulation-based forecasts.</span>
<span class=sd >            Must produce random samples using the syntax `rng(size)` where size</span>
<span class=sd >            the 2-element tuple (simulations, horizon).</span>
<span class=sd >        random_state : RandomState, optional</span>
<span class=sd >            NumPy RandomState instance to use when method is 'bootstrap'</span>
<span class=sd >        reindex : bool, optional</span>
<span class=sd >            Whether to reindex the forecasts to have the same dimension as the series</span>
<span class=sd >            being forecast. Prior to 4.18 this was the default. As of 4.19 this is</span>
<span class=sd >            now optional. If not provided, a warning is raised about the future</span>
<span class=sd >            change in the default which will occur after September 2021.</span>

<span class=sd >            .. versionadded:: 4.19</span>

<span class=sd >        x : {dict[label, array_like], array_like}</span>
<span class=sd >            Values to use for exogenous regressors if any are included in the</span>
<span class=sd >            model. Three formats are accepted:</span>

<span class=sd >            * 2-d array-like: This format can be used when there is a single</span>
<span class=sd >              exogenous variable. The input must have shape (nforecast, horizon)</span>
<span class=sd >              or (nobs, horizon) where nforecast is the number of forecasting</span>
<span class=sd >              periods and nobs is the original shape of y. For example, if a</span>
<span class=sd >              single series of forecasts are made from the end of the sample</span>
<span class=sd >              with a horizon of 10, then the input can be (1, 10). Alternatively,</span>
<span class=sd >              if the original data had 1000 observations, then the input can be</span>
<span class=sd >              (1000, 10), and only the final row is used to produce forecasts.</span>
<span class=sd >            * A dictionary of 2-d array-like: This format is identical to the</span>
<span class=sd >              previous except that the dictionary keys must match the names of</span>
<span class=sd >              the exog variables.  Requires that the exog variables were pass</span>
<span class=sd >              as a pandas DataFrame.</span>
<span class=sd >            * A 3-d NumPy array (or equivalent). In this format, each panel</span>
<span class=sd >              (0th axis) is a 2-d array that must have shape (nforecast, horizon)</span>
<span class=sd >              or (nobs,horizon). The array x[j] corresponds to the j-th column of</span>
<span class=sd >              the exogenous variables.</span>

<span class=sd >            Due to the complexity required to accommodate all scenarios, please</span>
<span class=sd >            see the example notebook that demonstrates the valid formats for</span>
<span class=sd >            x.</span>

<span class=sd >            .. versionadded:: 4.19</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        arch.univariate.base.ARCHModelForecast</span>
<span class=sd >            Container for forecasts. Key properties are ``mean``,</span>
<span class=sd >            ``variance`` and ``residual_variance``.</span>

<span class=sd >        Notes</span>
<span class=sd >        -----</span>
<span class=sd >        The most basic 1-step ahead forecast will return a vector with the same</span>
<span class=sd >        length as the original data, where the t-th value will be the time-t</span>
<span class=sd >        forecast for time t + 1.  When the horizon is &gt; 1, and when using the</span>
<span class=sd >        default value for `align`, the forecast value in position [t, h] is the</span>
<span class=sd >        time-t, h+1 step ahead forecast.</span>

<span class=sd >        If model contains exogenous variables (`model.x is not None`), then</span>
<span class=sd >        only 1-step ahead forecasts are available.  Using horizon &gt; 1 will</span>
<span class=sd >        produce a warning and all columns, except the first, will be</span>
<span class=sd >        nan-filled.</span>

<span class=sd >        If `align` is 'origin', forecast[t,h] contains the forecast made using</span>
<span class=sd >        y[:t] (that is, up to but not including t) for horizon h + 1.  For</span>
<span class=sd >        example, y[100,2] contains the 3-step ahead forecast using the first</span>
<span class=sd >        100 data points, which will correspond to the realization y[100 + 2].</span>
<span class=sd >        If `align` is 'target', then the same forecast is in location</span>
<span class=sd >        [102, 2], so that it is aligned with the observation to use when</span>
<span class=sd >        evaluating, but still in the same column.</span>
<span class=sd >        """</span>
        <span class=n >reindex</span> <span class=o >=</span> <span class=n >check_reindex</span><span class=p >(</span><span class=n >reindex</span><span class=p >)</span>
        <span class=k >if</span> <span class=n >params</span> <span class=ow >is</span> <span class=kc >None</span><span class=p >:</span>
            <span class=n >params</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_params</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=k >if</span> <span class=p >(</span>
                <span class=n >params</span><span class=o >.</span><span class=n >size</span> <span class=o >!=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_params</span><span class=p >)</span><span class=o >.</span><span class=n >size</span>
                <span class=ow >or</span> <span class=n >params</span><span class=o >.</span><span class=n >ndim</span> <span class=o >!=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_params</span><span class=o >.</span><span class=n >ndim</span>
            <span class=p >):</span>
                <span class=k >raise</span> <span class=ne >ValueError</span><span class=p >(</span><span class=s2 >"params have incorrect dimensions"</span><span class=p >)</span>
        <span class=k >if</span> <span class=ow >not</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >horizon</span><span class=p >,</span> <span class=p >(</span><span class=nb >int</span><span class=p >,</span> <span class=n >np</span><span class=o >.</span><span class=n >integer</span><span class=p >))</span> <span class=ow >or</span> <span class=n >horizon</span> <span class=o >&lt;</span> <span class=mi >1</span><span class=p >:</span>
            <span class=k >raise</span> <span class=ne >ValueError</span><span class=p >(</span><span class=s2 >"horizon must be an integer &gt;= 1."</span><span class=p >)</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span>
            <span class=n >params</span><span class=p >,</span>
            <span class=n >horizon</span><span class=p >,</span>
            <span class=n >start</span><span class=p >,</span>
            <span class=n >align</span><span class=p >,</span>
            <span class=n >method</span><span class=p >,</span>
            <span class=n >simulations</span><span class=p >,</span>
            <span class=n >rng</span><span class=p >,</span>
            <span class=n >random_state</span><span class=p >,</span>
            <span class=n >reindex</span><span class=o >=</span><span class=n >reindex</span><span class=p >,</span>
            <span class=n >x</span><span class=o >=</span><span class=n >x</span><span class=p >,</span>
        <span class=p >)</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.hedgehog_plot ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.hedgehog_plot.html#arch.univariate.base.ARCHModelFixedResult.hedgehog_plot">[docs]</a>    <span class=nd >@deprecate_kwarg</span><span class=p >(</span><span class=s2 >"type"</span><span class=p >,</span> <span class=s2 >"plot_type"</span><span class=p >)</span>
    <span class=k >def</span> <span class=nf >hedgehog_plot</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >params</span><span class=p >:</span> <span class=n >ArrayLike1D</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >horizon</span><span class=p >:</span> <span class=nb >int</span> <span class=o >=</span> <span class=mi >10</span><span class=p >,</span>
        <span class=n >step</span><span class=p >:</span> <span class=nb >int</span> <span class=o >=</span> <span class=mi >10</span><span class=p >,</span>
        <span class=n >start</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=n >DateLike</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >plot_type</span><span class=p >:</span> <span class=n >Literal</span><span class=p >[</span><span class=s2 >"volatility"</span><span class=p >,</span> <span class=s2 >"mean"</span><span class=p >]</span> <span class=o >=</span> <span class=s2 >"volatility"</span><span class=p >,</span>
        <span class=n >method</span><span class=p >:</span> <span class=n >ForecastingMethod</span> <span class=o >=</span> <span class=s2 >"analytic"</span><span class=p >,</span>
        <span class=n >simulations</span><span class=p >:</span> <span class=nb >int</span> <span class=o >=</span> <span class=mi >1000</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Figure</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Plot forecasts from estimated model</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        params : {ndarray, Series}</span>
<span class=sd >            Alternative parameters to use.  If not provided, the parameters</span>
<span class=sd >            computed by fitting the model are used.  Must be 1-d and identical</span>
<span class=sd >            in shape to the parameters computed by fitting the model.</span>
<span class=sd >        horizon : int, optional</span>
<span class=sd >            Number of steps to forecast</span>
<span class=sd >        step : int, optional</span>
<span class=sd >            Non-negative number of forecasts to skip between spines</span>
<span class=sd >        start : int, datetime or str, optional</span>
<span class=sd >            An integer, datetime or str indicating the first observation to</span>
<span class=sd >            produce the forecast for.  Datetimes can only be used with pandas</span>
<span class=sd >            inputs that have a datetime index.  Strings must be convertible</span>
<span class=sd >            to a date time, such as in '1945-01-01'.  If not provided, the start</span>
<span class=sd >            is set to the earliest forecastable date.</span>
<span class=sd >        plot_type : {'volatility', 'mean'}</span>
<span class=sd >            Quantity to plot, the forecast volatility or the forecast mean</span>
<span class=sd >        method : {'analytic', 'simulation', 'bootstrap'}</span>
<span class=sd >            Method to use when producing the forecast. The default is analytic.</span>
<span class=sd >            The method only affects the variance forecast generation.  Not all</span>
<span class=sd >            volatility models support all methods. In particular, volatility</span>
<span class=sd >            models that do not evolve in squares such as EGARCH or TARCH do not</span>
<span class=sd >            support the 'analytic' method for horizons &gt; 1.</span>
<span class=sd >        simulations : int</span>
<span class=sd >            Number of simulations to run when computing the forecast using</span>
<span class=sd >            either simulation or bootstrap.</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        fig : figure</span>
<span class=sd >            Handle to the figure</span>

<span class=sd >        Examples</span>
<span class=sd >        --------</span>
<span class=sd >        &gt;&gt;&gt; import pandas as pd</span>
<span class=sd >        &gt;&gt;&gt; from arch import arch_model</span>
<span class=sd >        &gt;&gt;&gt; am = arch_model(None,mean='HAR',lags=[1,5,22],vol='Constant')</span>
<span class=sd >        &gt;&gt;&gt; sim_data = am.simulate([0.1,0.4,0.3,0.2,1.0], 250)</span>
<span class=sd >        &gt;&gt;&gt; sim_data.index = pd.date_range('2000-01-01',periods=250)</span>
<span class=sd >        &gt;&gt;&gt; am = arch_model(sim_data['data'],mean='HAR',lags=[1,5,22],  vol='Constant')</span>
<span class=sd >        &gt;&gt;&gt; res = am.fit()</span>
<span class=sd >        &gt;&gt;&gt; fig = res.hedgehog_plot(plot_type='mean')</span>
<span class=sd >        """</span>
        <span class=kn >import</span> <span class=nn >matplotlib.pyplot</span> <span class=k >as</span> <span class=nn >plt</span>

        <span class=n >plot_mean</span> <span class=o >=</span> <span class=n >plot_type</span><span class=o >.</span><span class=n >lower</span><span class=p >()</span> <span class=o >==</span> <span class=s2 >"mean"</span>
        <span class=k >if</span> <span class=n >start</span> <span class=ow >is</span> <span class=kc >None</span><span class=p >:</span>
            <span class=n >invalid_start</span> <span class=o >=</span> <span class=kc >True</span>
            <span class=n >start</span> <span class=o >=</span> <span class=mi >0</span>
            <span class=k >while</span> <span class=n >invalid_start</span><span class=p >:</span>
                <span class=k >try</span><span class=p >:</span>
                    <span class=n >forecasts</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span>
                        <span class=n >params</span><span class=p >,</span>
                        <span class=n >horizon</span><span class=p >,</span>
                        <span class=n >start</span><span class=p >,</span>
                        <span class=n >method</span><span class=o >=</span><span class=n >method</span><span class=p >,</span>
                        <span class=n >simulations</span><span class=o >=</span><span class=n >simulations</span><span class=p >,</span>
                        <span class=n >reindex</span><span class=o >=</span><span class=kc >False</span><span class=p >,</span>
                    <span class=p >)</span>
                    <span class=n >invalid_start</span> <span class=o >=</span> <span class=kc >False</span>
                <span class=k >except</span> <span class=ne >ValueError</span><span class=p >:</span>
                    <span class=n >start</span> <span class=o >+=</span> <span class=mi >1</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=n >forecasts</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >forecast</span><span class=p >(</span>
                <span class=n >params</span><span class=p >,</span>
                <span class=n >horizon</span><span class=p >,</span>
                <span class=n >start</span><span class=p >,</span>
                <span class=n >method</span><span class=o >=</span><span class=n >method</span><span class=p >,</span>
                <span class=n >simulations</span><span class=o >=</span><span class=n >simulations</span><span class=p >,</span>
                <span class=n >reindex</span><span class=o >=</span><span class=kc >False</span><span class=p >,</span>
            <span class=p >)</span>

        <span class=n >fig</span><span class=p >,</span> <span class=n >ax</span> <span class=o >=</span> <span class=n >plt</span><span class=o >.</span><span class=n >subplots</span><span class=p >(</span><span class=mi >1</span><span class=p >,</span> <span class=mi >1</span><span class=p >)</span>
        <span class=n >use_date</span> <span class=o >=</span> <span class=nb >isinstance</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_dep_var</span><span class=o >.</span><span class=n >index</span><span class=p >,</span> <span class=n >pd</span><span class=o >.</span><span class=n >DatetimeIndex</span><span class=p >)</span>
        <span class=n >plot_fn</span> <span class=o >=</span> <span class=n >ax</span><span class=o >.</span><span class=n >plot_date</span> <span class=k >if</span> <span class=n >use_date</span> <span class=k >else</span> <span class=n >ax</span><span class=o >.</span><span class=n >plot</span>
        <span class=n >x_values</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >array</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_dep_var</span><span class=o >.</span><span class=n >index</span><span class=p >)</span>
        <span class=k >if</span> <span class=n >plot_mean</span><span class=p >:</span>
            <span class=n >y_values</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_dep_var</span><span class=p >)</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=n >y_values</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >conditional_volatility</span><span class=p >)</span>

        <span class=n >plot_fn</span><span class=p >(</span><span class=n >x_values</span><span class=p >,</span> <span class=n >y_values</span><span class=p >,</span> <span class=n >linestyle</span><span class=o >=</span><span class=s2 >"-"</span><span class=p >,</span> <span class=n >marker</span><span class=o >=</span><span class=s2 >""</span><span class=p >)</span>
        <span class=n >first_obs</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >min</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >where</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >logical_not</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >isnan</span><span class=p >(</span><span class=n >forecasts</span><span class=o >.</span><span class=n >mean</span><span class=p >)))[</span><span class=mi >0</span><span class=p >])</span>
        <span class=n >spines</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=n >t</span> <span class=o >=</span> <span class=n >forecasts</span><span class=o >.</span><span class=n >mean</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span>
        <span class=k >for</span> <span class=n >i</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=n >first_obs</span><span class=p >,</span> <span class=n >t</span><span class=p >,</span> <span class=n >step</span><span class=p >):</span>
            <span class=k >if</span> <span class=n >i</span> <span class=o >+</span> <span class=n >horizon</span> <span class=o >+</span> <span class=mi >1</span> <span class=o >&gt;</span> <span class=n >x_values</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]:</span>
                <span class=k >continue</span>
            <span class=n >temp_x</span> <span class=o >=</span> <span class=n >x_values</span><span class=p >[</span><span class=n >i</span> <span class=p >:</span> <span class=n >i</span> <span class=o >+</span> <span class=n >horizon</span> <span class=o >+</span> <span class=mi >1</span><span class=p >]</span>
            <span class=k >if</span> <span class=n >plot_mean</span><span class=p >:</span>
                <span class=n >spine_data</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=n >forecasts</span><span class=o >.</span><span class=n >mean</span><span class=o >.</span><span class=n >iloc</span><span class=p >[</span><span class=n >i</span><span class=p >],</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span><span class=p >)</span>
            <span class=k >else</span><span class=p >:</span>
                <span class=n >spine_data</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span>
                    <span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >forecasts</span><span class=o >.</span><span class=n >variance</span><span class=o >.</span><span class=n >iloc</span><span class=p >[</span><span class=n >i</span><span class=p >]),</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span>
                <span class=p >)</span>
            <span class=n >temp_y</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >hstack</span><span class=p >([</span><span class=n >y_values</span><span class=p >[</span><span class=n >i</span><span class=p >],</span> <span class=n >spine_data</span><span class=p >])</span>
            <span class=n >line</span> <span class=o >=</span> <span class=n >plot_fn</span><span class=p >(</span><span class=n >temp_x</span><span class=p >,</span> <span class=n >temp_y</span><span class=p >,</span> <span class=n >linewidth</span><span class=o >=</span><span class=mi >3</span><span class=p >,</span> <span class=n >linestyle</span><span class=o >=</span><span class=s2 >"-"</span><span class=p >,</span> <span class=n >marker</span><span class=o >=</span><span class=s2 >""</span><span class=p >)</span>
            <span class=n >spines</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >line</span><span class=p >)</span>
        <span class=n >color</span> <span class=o >=</span> <span class=n >spines</span><span class=p >[</span><span class=mi >0</span><span class=p >][</span><span class=mi >0</span><span class=p >]</span><span class=o >.</span><span class=n >get_color</span><span class=p >()</span>
        <span class=k >for</span> <span class=n >spine</span> <span class=ow >in</span> <span class=n >spines</span><span class=p >[</span><span class=mi >1</span><span class=p >:]:</span>
            <span class=n >spine</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span><span class=o >.</span><span class=n >set_color</span><span class=p >(</span><span class=n >color</span><span class=p >)</span>
        <span class=n >plot_title</span> <span class=o >=</span> <span class=s2 >"Mean"</span> <span class=k >if</span> <span class=n >plot_mean</span> <span class=k >else</span> <span class=s2 >"Volatility"</span>
        <span class=n >ax</span><span class=o >.</span><span class=n >set_title</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_dep_name</span> <span class=o >+</span> <span class=s2 >" "</span> <span class=o >+</span> <span class=n >plot_title</span> <span class=o >+</span> <span class=s2 >" Forecast Hedgehog Plot"</span><span class=p >)</span>

        <span class=k >return</span> <span class=n >fig</span></div>

<div class=viewcode-block  id=ARCHModelFixedResult.arch_lm_test ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelFixedResult.arch_lm_test.html#arch.univariate.base.ARCHModelFixedResult.arch_lm_test">[docs]</a>    <span class=k >def</span> <span class=nf >arch_lm_test</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span> <span class=n >lags</span><span class=p >:</span> <span class=nb >int</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span> <span class=n >standardized</span><span class=p >:</span> <span class=nb >bool</span> <span class=o >=</span> <span class=kc >False</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=n >WaldTestStatistic</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        ARCH LM test for conditional heteroskedasticity</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        lags : int, optional</span>
<span class=sd >            Number of lags to include in the model.  If not specified,</span>
<span class=sd >        standardized : bool, optional</span>
<span class=sd >            Flag indicating to test the model residuals divided by their</span>
<span class=sd >            conditional standard deviations.  If False, directly tests the</span>
<span class=sd >            estimated residuals.</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        result : WaldTestStatistic</span>
<span class=sd >            Result of ARCH-LM test</span>
<span class=sd >        """</span>
        <span class=n >resids</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >resid</span>
        <span class=n >nobs</span> <span class=o >=</span> <span class=n >resids</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span>
        <span class=k >if</span> <span class=n >standardized</span><span class=p >:</span>
            <span class=n >resids</span> <span class=o >=</span> <span class=n >resids</span> <span class=o >/</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >conditional_volatility</span><span class=p >)</span>
        <span class=n >resid2</span> <span class=o >=</span> <span class=n >resids</span><span class=o >**</span><span class=mi >2</span>
        <span class=n >lags</span> <span class=o >=</span> <span class=p >(</span>
            <span class=nb >int</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >ceil</span><span class=p >(</span><span class=mf >12.0</span> <span class=o >*</span> <span class=n >np</span><span class=o >.</span><span class=n >power</span><span class=p >(</span><span class=n >nobs</span> <span class=o >/</span> <span class=mf >100.0</span><span class=p >,</span> <span class=mi >1</span> <span class=o >/</span> <span class=mf >4.0</span><span class=p >)))</span>
            <span class=k >if</span> <span class=n >lags</span> <span class=ow >is</span> <span class=kc >None</span>
            <span class=k >else</span> <span class=n >lags</span>
        <span class=p >)</span>
        <span class=n >lags</span> <span class=o >=</span> <span class=nb >max</span><span class=p >(</span><span class=nb >min</span><span class=p >(</span><span class=n >resids</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span> <span class=o >//</span> <span class=mi >2</span> <span class=o >-</span> <span class=mi >1</span><span class=p >,</span> <span class=n >lags</span><span class=p >),</span> <span class=mi >1</span><span class=p >)</span>
        <span class=n >lag</span><span class=p >,</span> <span class=n >lead</span> <span class=o >=</span> <span class=n >lagmat</span><span class=p >(</span><span class=n >resid2</span><span class=p >,</span> <span class=n >lags</span><span class=p >,</span> <span class=s2 >"both"</span><span class=p >,</span> <span class=s2 >"sep"</span><span class=p >,</span> <span class=kc >False</span><span class=p >)</span>
        <span class=n >lag</span> <span class=o >=</span> <span class=n >add_constant</span><span class=p >(</span><span class=n >lag</span><span class=p >)</span>
        <span class=n >res</span> <span class=o >=</span> <span class=n >OLS</span><span class=p >(</span><span class=n >lead</span><span class=p >,</span> <span class=n >lag</span><span class=p >)</span><span class=o >.</span><span class=n >fit</span><span class=p >()</span>
        <span class=n >stat</span> <span class=o >=</span> <span class=n >nobs</span> <span class=o >*</span> <span class=n >res</span><span class=o >.</span><span class=n >rsquared</span>
        <span class=n >test_type</span> <span class=o >=</span> <span class=s2 >"R"</span> <span class=k >if</span> <span class=ow >not</span> <span class=n >standardized</span> <span class=k >else</span> <span class=s2 >"Standardized r"</span>
        <span class=n >null</span> <span class=o >=</span> <span class=sa >f</span><span class=s2 >"</span><span class=si >{</span><span class=n >test_type</span><span class=si >}</span><span class=s2 >esiduals are homoskedastic."</span>
        <span class=n >alt</span> <span class=o >=</span> <span class=sa >f</span><span class=s2 >"</span><span class=si >{</span><span class=n >test_type</span><span class=si >}</span><span class=s2 >esiduals are conditionally heteroskedastic."</span>
        <span class=k >assert</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >lags</span><span class=p >,</span> <span class=nb >int</span><span class=p >)</span>
        <span class=k >return</span> <span class=n >WaldTestStatistic</span><span class=p >(</span>
            <span class=n >stat</span><span class=p >,</span> <span class=n >df</span><span class=o >=</span><span class=n >lags</span><span class=p >,</span> <span class=n >null</span><span class=o >=</span><span class=n >null</span><span class=p >,</span> <span class=n >alternative</span><span class=o >=</span><span class=n >alt</span><span class=p >,</span> <span class=n >name</span><span class=o >=</span><span class=s2 >"ARCH-LM Test"</span>
        <span class=p >)</span></div></div>


<div class=viewcode-block  id=ARCHModelResult ><a class=viewcode-back  href="../../../univariate/generated/arch.univariate.base.ARCHModelResult.html#arch.univariate.base.ARCHModelResult">[docs]</a><span class=k >class</span> <span class=nc >ARCHModelResult</span><span class=p >(</span><span class=n >ARCHModelFixedResult</span><span class=p >):</span>
    <span class=sd >"""</span>
<span class=sd >    Results from estimation of an ARCHModel model</span>

<span class=sd >    Parameters</span>
<span class=sd >    ----------</span>
<span class=sd >    params : ndarray</span>
<span class=sd >        Estimated parameters</span>
<span class=sd >    param_cov : {ndarray, None}</span>
<span class=sd >        Estimated variance-covariance matrix of params.  If none, calls method</span>
<span class=sd >        to compute variance from model when parameter covariance is first used</span>
<span class=sd >        from result</span>
<span class=sd >    r2 : float</span>
<span class=sd >        Model R-squared</span>
<span class=sd >    resid : ndarray</span>
<span class=sd >        Residuals from model.  Residuals have same shape as original data and</span>
<span class=sd >        contain nan-values in locations not used in estimation</span>
<span class=sd >    volatility : ndarray</span>
<span class=sd >        Conditional volatility from model</span>
<span class=sd >    cov_type : str</span>
<span class=sd >        String describing the covariance estimator used</span>
<span class=sd >    dep_var : Series</span>
<span class=sd >        Dependent variable</span>
<span class=sd >    names : list (str)</span>
<span class=sd >        Model parameter names</span>
<span class=sd >    loglikelihood : float</span>
<span class=sd >        Loglikelihood at estimated parameters</span>
<span class=sd >    is_pandas : bool</span>
<span class=sd >        Whether the original input was pandas</span>
<span class=sd >    optim_output : OptimizeResult</span>
<span class=sd >        Result of log-likelihood optimization</span>
<span class=sd >    fit_start : int</span>
<span class=sd >        Integer index of the first observation used to fit the model</span>
<span class=sd >    fit_stop : int</span>
<span class=sd >        Integer index of the last observation used to fit the model using</span>
<span class=sd >        slice notation `fit_start:fit_stop`</span>
<span class=sd >    model : ARCHModel</span>
<span class=sd >        The model object used to estimate the parameters</span>
<span class=sd >    """</span>

    <span class=k >def</span> <span class=fm >__init__</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >params</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >param_cov</span><span class=p >:</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >r2</span><span class=p >:</span> <span class=nb >float</span><span class=p >,</span>
        <span class=n >resid</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >volatility</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >cov_type</span><span class=p >:</span> <span class=nb >str</span><span class=p >,</span>
        <span class=n >dep_var</span><span class=p >:</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >,</span>
        <span class=n >names</span><span class=p >:</span> <span class=nb >list</span><span class=p >[</span><span class=nb >str</span><span class=p >],</span>
        <span class=n >loglikelihood</span><span class=p >:</span> <span class=nb >float</span><span class=p >,</span>
        <span class=n >is_pandas</span><span class=p >:</span> <span class=nb >bool</span><span class=p >,</span>
        <span class=n >optim_output</span><span class=p >:</span> <span class=n >OptimizeResult</span><span class=p >,</span>
        <span class=n >fit_start</span><span class=p >:</span> <span class=nb >int</span><span class=p >,</span>
        <span class=n >fit_stop</span><span class=p >:</span> <span class=nb >int</span><span class=p >,</span>
        <span class=n >model</span><span class=p >:</span> <span class=n >ARCHModel</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span><span class=p >:</span>
        <span class=nb >super</span><span class=p >()</span><span class=o >.</span><span class=fm >__init__</span><span class=p >(</span>
            <span class=n >params</span><span class=p >,</span> <span class=n >resid</span><span class=p >,</span> <span class=n >volatility</span><span class=p >,</span> <span class=n >dep_var</span><span class=p >,</span> <span class=n >names</span><span class=p >,</span> <span class=n >loglikelihood</span><span class=p >,</span> <span class=n >is_pandas</span><span class=p >,</span> <span class=n >model</span>
        <span class=p >)</span>

        <span class=bp >self</span><span class=o >.</span><span class=n >_fit_indices</span> <span class=o >=</span> <span class=p >(</span><span class=n >fit_start</span><span class=p >,</span> <span class=n >fit_stop</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_param_cov</span> <span class=o >=</span> <span class=n >param_cov</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_r2</span> <span class=o >=</span> <span class=n >r2</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >cov_type</span><span class=p >:</span> <span class=nb >str</span> <span class=o >=</span> <span class=n >cov_type</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_optim_output</span> <span class=o >=</span> <span class=n >optim_output</span>

<div class=viewcode-block  id=ARCHModelResult.scale ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.scale.html#arch.univariate.base.ARCHModelResult.scale">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >scale</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >float</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        The scale applied to the original data before estimating the model.</span>

<span class=sd >        If scale=1.0, the the data have not been rescaled.  Otherwise, the</span>
<span class=sd >        model parameters have been estimated on scale * y.</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >scale</span></div>

<div class=viewcode-block  id=ARCHModelResult.conf_int ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.conf_int.html#arch.univariate.base.ARCHModelResult.conf_int">[docs]</a>    <span class=k >def</span> <span class=nf >conf_int</span><span class=p >(</span><span class=bp >self</span><span class=p >,</span> <span class=n >alpha</span><span class=p >:</span> <span class=nb >float</span> <span class=o >=</span> <span class=mf >0.05</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Parameter confidence intervals</span>

<span class=sd >        Parameters</span>
<span class=sd >        ----------</span>
<span class=sd >        alpha : float, optional</span>
<span class=sd >            Size (prob.) to use when constructing the confidence interval.</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        ci : DataFrame</span>
<span class=sd >            Array where the ith row contains the confidence interval  for the</span>
<span class=sd >            ith parameter</span>
<span class=sd >        """</span>
        <span class=n >cv</span> <span class=o >=</span> <span class=n >stats</span><span class=o >.</span><span class=n >norm</span><span class=o >.</span><span class=n >ppf</span><span class=p >(</span><span class=mf >1.0</span> <span class=o >-</span> <span class=n >alpha</span> <span class=o >/</span> <span class=mf >2.0</span><span class=p >)</span>
        <span class=n >se</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >std_err</span>
        <span class=n >params</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >params</span>

        <span class=k >return</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >(</span>
            <span class=n >np</span><span class=o >.</span><span class=n >vstack</span><span class=p >((</span><span class=n >params</span> <span class=o >-</span> <span class=n >cv</span> <span class=o >*</span> <span class=n >se</span><span class=p >,</span> <span class=n >params</span> <span class=o >+</span> <span class=n >cv</span> <span class=o >*</span> <span class=n >se</span><span class=p >))</span><span class=o >.</span><span class=n >T</span><span class=p >,</span>
            <span class=n >columns</span><span class=o >=</span><span class=p >[</span><span class=s2 >"lower"</span><span class=p >,</span> <span class=s2 >"upper"</span><span class=p >],</span>
            <span class=n >index</span><span class=o >=</span><span class=bp >self</span><span class=o >.</span><span class=n >_names</span><span class=p >,</span>
        <span class=p >)</span></div>

<div class=viewcode-block  id=ARCHModelResult.summary ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.summary.html#arch.univariate.base.ARCHModelResult.summary">[docs]</a>    <span class=k >def</span> <span class=nf >summary</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Summary</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Constructs a summary of the results from a fit model.</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        summary : Summary instance</span>
<span class=sd >            Object that contains tables and facilitated export to text, html or</span>
<span class=sd >            latex</span>
<span class=sd >        """</span>
        <span class=c1 ># Summary layout</span>
        <span class=c1 ># 1. Overall information</span>
        <span class=c1 ># 2. Mean parameters</span>
        <span class=c1 ># 3. Volatility parameters</span>
        <span class=c1 ># 4. Distribution parameters</span>
        <span class=c1 ># 5. Notes</span>

        <span class=n >model</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span>
        <span class=n >model_name</span> <span class=o >=</span> <span class=n >model</span><span class=o >.</span><span class=n >name</span> <span class=o >+</span> <span class=s2 >" - "</span> <span class=o >+</span> <span class=n >model</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >name</span>

        <span class=c1 ># Summary Header</span>
        <span class=n >top_left</span> <span class=o >=</span> <span class=p >[</span>
            <span class=p >(</span><span class=s2 >"Dep. Variable:"</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_dep_name</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Mean Model:"</span><span class=p >,</span> <span class=n >model</span><span class=o >.</span><span class=n >name</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Vol Model:"</span><span class=p >,</span> <span class=n >model</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >name</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Distribution:"</span><span class=p >,</span> <span class=n >model</span><span class=o >.</span><span class=n >distribution</span><span class=o >.</span><span class=n >name</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Method:"</span><span class=p >,</span> <span class=s2 >"Maximum Likelihood"</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >""</span><span class=p >,</span> <span class=s2 >""</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Date:"</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_datetime</span><span class=o >.</span><span class=n >strftime</span><span class=p >(</span><span class=s2 >"</span><span class=si >%a</span><span class=s2 >, %b </span><span class=si >%d</span><span class=s2 > %Y"</span><span class=p >)),</span>
            <span class=p >(</span><span class=s2 >"Time:"</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_datetime</span><span class=o >.</span><span class=n >strftime</span><span class=p >(</span><span class=s2 >"%H:%M:%S"</span><span class=p >)),</span>
        <span class=p >]</span>

        <span class=n >top_right</span> <span class=o >=</span> <span class=p >[</span>
            <span class=p >(</span><span class=s2 >"R-squared:"</span><span class=p >,</span> <span class=s2 >"</span><span class=si >%#8.3f</span><span class=s2 >"</span> <span class=o >%</span> <span class=bp >self</span><span class=o >.</span><span class=n >rsquared</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Adj. R-squared:"</span><span class=p >,</span> <span class=s2 >"</span><span class=si >%#8.3f</span><span class=s2 >"</span> <span class=o >%</span> <span class=bp >self</span><span class=o >.</span><span class=n >rsquared_adj</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Log-Likelihood:"</span><span class=p >,</span> <span class=s2 >"</span><span class=si >%#10.6g</span><span class=s2 >"</span> <span class=o >%</span> <span class=bp >self</span><span class=o >.</span><span class=n >loglikelihood</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"AIC:"</span><span class=p >,</span> <span class=s2 >"</span><span class=si >%#10.6g</span><span class=s2 >"</span> <span class=o >%</span> <span class=bp >self</span><span class=o >.</span><span class=n >aic</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"BIC:"</span><span class=p >,</span> <span class=s2 >"</span><span class=si >%#10.6g</span><span class=s2 >"</span> <span class=o >%</span> <span class=bp >self</span><span class=o >.</span><span class=n >bic</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"No. Observations:"</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >_nobs</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Df Residuals:"</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >nobs</span> <span class=o >-</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >num_params</span><span class=p >),</span>
            <span class=p >(</span><span class=s2 >"Df Model:"</span><span class=p >,</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >num_params</span><span class=p >),</span>
        <span class=p >]</span>

        <span class=n >title</span> <span class=o >=</span> <span class=n >model_name</span> <span class=o >+</span> <span class=s2 >" Model Results"</span>
        <span class=n >stubs</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=n >vals</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=k >for</span> <span class=n >stub</span><span class=p >,</span> <span class=n >val</span> <span class=ow >in</span> <span class=n >top_left</span><span class=p >:</span>
            <span class=n >stubs</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >stub</span><span class=p >)</span>
            <span class=n >vals</span><span class=o >.</span><span class=n >append</span><span class=p >([</span><span class=n >val</span><span class=p >])</span>
        <span class=n >table</span> <span class=o >=</span> <span class=n >SimpleTable</span><span class=p >(</span><span class=n >vals</span><span class=p >,</span> <span class=n >txt_fmt</span><span class=o >=</span><span class=n >fmt_2cols</span><span class=p >,</span> <span class=n >title</span><span class=o >=</span><span class=n >title</span><span class=p >,</span> <span class=n >stubs</span><span class=o >=</span><span class=n >stubs</span><span class=p >)</span>

        <span class=c1 ># create summary table instance</span>
        <span class=n >smry</span> <span class=o >=</span> <span class=n >Summary</span><span class=p >()</span>
        <span class=c1 ># Top Table</span>
        <span class=c1 ># Parameter table</span>
        <span class=n >fmt</span> <span class=o >=</span> <span class=n >fmt_2cols</span>
        <span class=n >fmt</span><span class=p >[</span><span class=s2 >"data_fmts"</span><span class=p >][</span><span class=mi >1</span><span class=p >]</span> <span class=o >=</span> <span class=s2 >"</span><span class=si >%18s</span><span class=s2 >"</span>

        <span class=n >top_right</span> <span class=o >=</span> <span class=p >[(</span><span class=s2 >"</span><span class=si >%-21s</span><span class=s2 >"</span> <span class=o >%</span> <span class=p >(</span><span class=s2 >"  "</span> <span class=o >+</span> <span class=n >k</span><span class=p >),</span> <span class=n >v</span><span class=p >)</span> <span class=k >for</span> <span class=n >k</span><span class=p >,</span> <span class=n >v</span> <span class=ow >in</span> <span class=n >top_right</span><span class=p >]</span>
        <span class=n >stubs</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=n >vals</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=k >for</span> <span class=n >stub</span><span class=p >,</span> <span class=n >val</span> <span class=ow >in</span> <span class=n >top_right</span><span class=p >:</span>
            <span class=n >stubs</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >stub</span><span class=p >)</span>
            <span class=n >vals</span><span class=o >.</span><span class=n >append</span><span class=p >([</span><span class=n >val</span><span class=p >])</span>
        <span class=n >table</span><span class=o >.</span><span class=n >extend_right</span><span class=p >(</span><span class=n >SimpleTable</span><span class=p >(</span><span class=n >vals</span><span class=p >,</span> <span class=n >stubs</span><span class=o >=</span><span class=n >stubs</span><span class=p >))</span>
        <span class=n >smry</span><span class=o >.</span><span class=n >tables</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >table</span><span class=p >)</span>

        <span class=n >conf_int</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >conf_int</span><span class=p >())</span>
        <span class=n >conf_int_str</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=k >for</span> <span class=n >c</span> <span class=ow >in</span> <span class=n >conf_int</span><span class=p >:</span>
            <span class=n >conf_int_str</span><span class=o >.</span><span class=n >append</span><span class=p >(</span>
                <span class=s2 >"["</span>
                <span class=o >+</span> <span class=n >format_float_fixed</span><span class=p >(</span><span class=n >c</span><span class=p >[</span><span class=mi >0</span><span class=p >],</span> <span class=mi >7</span><span class=p >,</span> <span class=mi >3</span><span class=p >)</span>
                <span class=o >+</span> <span class=s2 >","</span>
                <span class=o >+</span> <span class=n >format_float_fixed</span><span class=p >(</span><span class=n >c</span><span class=p >[</span><span class=mi >1</span><span class=p >],</span> <span class=mi >7</span><span class=p >,</span> <span class=mi >3</span><span class=p >)</span>
                <span class=o >+</span> <span class=s2 >"]"</span>
            <span class=p >)</span>

        <span class=n >stubs</span> <span class=o >=</span> <span class=nb >list</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >_names</span><span class=p >)</span>
        <span class=n >header</span> <span class=o >=</span> <span class=p >[</span><span class=s2 >"coef"</span><span class=p >,</span> <span class=s2 >"std err"</span><span class=p >,</span> <span class=s2 >"t"</span><span class=p >,</span> <span class=s2 >"P&gt;|t|"</span><span class=p >,</span> <span class=s2 >"95.0% Conf. Int."</span><span class=p >]</span>
        <span class=n >table_vals</span> <span class=o >=</span> <span class=p >(</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >params</span><span class=p >,</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >std_err</span><span class=p >,</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >tvalues</span><span class=p >,</span>
            <span class=bp >self</span><span class=o >.</span><span class=n >pvalues</span><span class=p >,</span>
            <span class=n >conf_int_str</span><span class=p >,</span>
        <span class=p >)</span>
        <span class=c1 ># (0,0) is a dummy format</span>
        <span class=n >formats</span> <span class=o >=</span> <span class=p >[(</span><span class=mi >10</span><span class=p >,</span> <span class=mi >4</span><span class=p >),</span> <span class=p >(</span><span class=mi >9</span><span class=p >,</span> <span class=mi >3</span><span class=p >),</span> <span class=p >(</span><span class=mi >9</span><span class=p >,</span> <span class=mi >3</span><span class=p >),</span> <span class=p >(</span><span class=mi >9</span><span class=p >,</span> <span class=mi >3</span><span class=p >),</span> <span class=p >(</span><span class=mi >0</span><span class=p >,</span> <span class=mi >0</span><span class=p >)]</span>
        <span class=n >pos</span> <span class=o >=</span> <span class=mi >0</span>
        <span class=n >param_table_data</span> <span class=o >=</span> <span class=p >[]</span>
        <span class=k >for</span> <span class=n >_</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=nb >len</span><span class=p >(</span><span class=n >table_vals</span><span class=p >[</span><span class=mi >0</span><span class=p >])):</span>
            <span class=n >row</span> <span class=o >=</span> <span class=p >[]</span>
            <span class=k >for</span> <span class=n >i</span><span class=p >,</span> <span class=n >val</span> <span class=ow >in</span> <span class=nb >enumerate</span><span class=p >(</span><span class=n >table_vals</span><span class=p >):</span>
                <span class=k >if</span> <span class=nb >isinstance</span><span class=p >(</span><span class=n >val</span><span class=p >[</span><span class=n >pos</span><span class=p >],</span> <span class=n >np</span><span class=o >.</span><span class=n >float64</span><span class=p >):</span>
                    <span class=n >converted</span> <span class=o >=</span> <span class=n >format_float_fixed</span><span class=p >(</span><span class=n >val</span><span class=p >[</span><span class=n >pos</span><span class=p >],</span> <span class=o >*</span><span class=n >formats</span><span class=p >[</span><span class=n >i</span><span class=p >])</span>
                <span class=k >else</span><span class=p >:</span>
                    <span class=n >converted</span> <span class=o >=</span> <span class=n >val</span><span class=p >[</span><span class=n >pos</span><span class=p >]</span>
                <span class=n >row</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >converted</span><span class=p >)</span>
            <span class=n >pos</span> <span class=o >+=</span> <span class=mi >1</span>
            <span class=n >param_table_data</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >row</span><span class=p >)</span>

        <span class=n >mc</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >num_params</span>
        <span class=n >vc</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >volatility</span><span class=o >.</span><span class=n >num_params</span>
        <span class=n >dc</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >distribution</span><span class=o >.</span><span class=n >num_params</span>
        <span class=n >counts</span> <span class=o >=</span> <span class=p >(</span><span class=n >mc</span><span class=p >,</span> <span class=n >vc</span><span class=p >,</span> <span class=n >dc</span><span class=p >)</span>
        <span class=n >titles</span> <span class=o >=</span> <span class=p >(</span><span class=s2 >"Mean Model"</span><span class=p >,</span> <span class=s2 >"Volatility Model"</span><span class=p >,</span> <span class=s2 >"Distribution"</span><span class=p >)</span>
        <span class=n >total</span> <span class=o >=</span> <span class=mi >0</span>
        <span class=k >for</span> <span class=n >title</span><span class=p >,</span> <span class=n >count</span> <span class=ow >in</span> <span class=nb >zip</span><span class=p >(</span><span class=n >titles</span><span class=p >,</span> <span class=n >counts</span><span class=p >):</span>
            <span class=k >if</span> <span class=n >count</span> <span class=o >==</span> <span class=mi >0</span><span class=p >:</span>
                <span class=k >continue</span>

            <span class=n >table_data</span> <span class=o >=</span> <span class=n >param_table_data</span><span class=p >[</span><span class=n >total</span> <span class=p >:</span> <span class=n >total</span> <span class=o >+</span> <span class=n >count</span><span class=p >]</span>
            <span class=n >table_stubs</span> <span class=o >=</span> <span class=n >stubs</span><span class=p >[</span><span class=n >total</span> <span class=p >:</span> <span class=n >total</span> <span class=o >+</span> <span class=n >count</span><span class=p >]</span>
            <span class=n >total</span> <span class=o >+=</span> <span class=n >count</span>
            <span class=n >table</span> <span class=o >=</span> <span class=n >SimpleTable</span><span class=p >(</span>
                <span class=n >table_data</span><span class=p >,</span>
                <span class=n >stubs</span><span class=o >=</span><span class=n >table_stubs</span><span class=p >,</span>
                <span class=n >txt_fmt</span><span class=o >=</span><span class=n >fmt_params</span><span class=p >,</span>
                <span class=n >headers</span><span class=o >=</span><span class=n >header</span><span class=p >,</span>
                <span class=n >title</span><span class=o >=</span><span class=n >title</span><span class=p >,</span>
            <span class=p >)</span>
            <span class=n >smry</span><span class=o >.</span><span class=n >tables</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >table</span><span class=p >)</span>

        <span class=n >extra_text</span> <span class=o >=</span> <span class=p >[</span><span class=s2 >"Covariance estimator: "</span> <span class=o >+</span> <span class=bp >self</span><span class=o >.</span><span class=n >cov_type</span><span class=p >]</span>

        <span class=k >if</span> <span class=bp >self</span><span class=o >.</span><span class=n >convergence_flag</span><span class=p >:</span>
            <span class=n >string_message</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_optim_output</span><span class=o >.</span><span class=n >message</span>
            <span class=n >extra_text</span><span class=o >.</span><span class=n >append</span><span class=p >(</span><span class=n >CONVERGENCE_WARNGING</span><span class=o >.</span><span class=n >format</span><span class=p >(</span><span class=n >msg</span><span class=o >=</span><span class=n >string_message</span><span class=p >))</span>

        <span class=n >smry</span><span class=o >.</span><span class=n >add_extra_txt</span><span class=p >(</span><span class=n >extra_text</span><span class=p >)</span>
        <span class=k >return</span> <span class=n >smry</span></div>

<div class=viewcode-block  id=ARCHModelResult.param_cov ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.param_cov.html#arch.univariate.base.ARCHModelResult.param_cov">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >param_cov</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >:</span>
        <span class=sd >"""Parameter covariance"""</span>
        <span class=k >if</span> <span class=bp >self</span><span class=o >.</span><span class=n >_param_cov</span> <span class=ow >is</span> <span class=ow >not</span> <span class=kc >None</span><span class=p >:</span>
            <span class=n >param_cov</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >_param_cov</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=n >params</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >params</span><span class=p >)</span>
            <span class=k >if</span> <span class=bp >self</span><span class=o >.</span><span class=n >cov_type</span> <span class=o >==</span> <span class=s2 >"robust"</span><span class=p >:</span>
                <span class=n >param_cov</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >compute_param_cov</span><span class=p >(</span><span class=n >params</span><span class=p >)</span>
            <span class=k >else</span><span class=p >:</span>
                <span class=n >param_cov</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >compute_param_cov</span><span class=p >(</span><span class=n >params</span><span class=p >,</span> <span class=n >robust</span><span class=o >=</span><span class=kc >False</span><span class=p >)</span>
        <span class=k >return</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >(</span><span class=n >param_cov</span><span class=p >,</span> <span class=n >columns</span><span class=o >=</span><span class=bp >self</span><span class=o >.</span><span class=n >_names</span><span class=p >,</span> <span class=n >index</span><span class=o >=</span><span class=bp >self</span><span class=o >.</span><span class=n >_names</span><span class=p >)</span></div>

<div class=viewcode-block  id=ARCHModelResult.rsquared ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.rsquared.html#arch.univariate.base.ARCHModelResult.rsquared">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >rsquared</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >float</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        R-squared</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_r2</span></div>

<div class=viewcode-block  id=ARCHModelResult.fit_start ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.fit_start.html#arch.univariate.base.ARCHModelResult.fit_start">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >fit_start</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >int</span><span class=p >:</span>
        <span class=sd >"""Start of sample used to estimate parameters"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_fit_indices</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span></div>

<div class=viewcode-block  id=ARCHModelResult.fit_stop ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.fit_stop.html#arch.univariate.base.ARCHModelResult.fit_stop">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >fit_stop</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >int</span><span class=p >:</span>
        <span class=sd >"""End of sample used to estimate parameters"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_fit_indices</span><span class=p >[</span><span class=mi >1</span><span class=p >]</span></div>

<div class=viewcode-block  id=ARCHModelResult.rsquared_adj ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.rsquared_adj.html#arch.univariate.base.ARCHModelResult.rsquared_adj">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >rsquared_adj</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >float</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Degree of freedom adjusted R-squared</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=mi >1</span> <span class=o >-</span> <span class=p >(</span>
            <span class=p >(</span><span class=mi >1</span> <span class=o >-</span> <span class=bp >self</span><span class=o >.</span><span class=n >rsquared</span><span class=p >)</span> <span class=o >*</span> <span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >nobs</span> <span class=o >-</span> <span class=mi >1</span><span class=p >)</span> <span class=o >/</span> <span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >nobs</span> <span class=o >-</span> <span class=bp >self</span><span class=o >.</span><span class=n >model</span><span class=o >.</span><span class=n >num_params</span><span class=p >)</span>
        <span class=p >)</span></div>

<div class=viewcode-block  id=ARCHModelResult.pvalues ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.pvalues.html#arch.univariate.base.ARCHModelResult.pvalues">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >pvalues</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Array of p-values for the t-statistics</span>
<span class=sd >        """</span>
        <span class=n >pvals</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=n >stats</span><span class=o >.</span><span class=n >norm</span><span class=o >.</span><span class=n >sf</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >abs</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >tvalues</span><span class=p >))</span> <span class=o >*</span> <span class=mi >2</span><span class=p >,</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span><span class=p >)</span>
        <span class=k >return</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >(</span><span class=n >pvals</span><span class=p >,</span> <span class=n >index</span><span class=o >=</span><span class=bp >self</span><span class=o >.</span><span class=n >_names</span><span class=p >,</span> <span class=n >name</span><span class=o >=</span><span class=s2 >"pvalues"</span><span class=p >)</span></div>

<div class=viewcode-block  id=ARCHModelResult.std_err ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.std_err.html#arch.univariate.base.ARCHModelResult.std_err">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >std_err</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Array of parameter standard errors</span>
<span class=sd >        """</span>
        <span class=n >se</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >asarray</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >sqrt</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >diag</span><span class=p >(</span><span class=bp >self</span><span class=o >.</span><span class=n >param_cov</span><span class=p >)),</span> <span class=n >dtype</span><span class=o >=</span><span class=nb >float</span><span class=p >)</span>
        <span class=k >return</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >(</span><span class=n >se</span><span class=p >,</span> <span class=n >index</span><span class=o >=</span><span class=bp >self</span><span class=o >.</span><span class=n >_names</span><span class=p >,</span> <span class=n >name</span><span class=o >=</span><span class=s2 >"std_err"</span><span class=p >)</span></div>

<div class=viewcode-block  id=ARCHModelResult.tvalues ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.tvalues.html#arch.univariate.base.ARCHModelResult.tvalues">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >tvalues</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >Series</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Array of t-statistics testing the null that the coefficient are 0</span>
<span class=sd >        """</span>
        <span class=n >tvalues</span> <span class=o >=</span> <span class=bp >self</span><span class=o >.</span><span class=n >params</span> <span class=o >/</span> <span class=bp >self</span><span class=o >.</span><span class=n >std_err</span>
        <span class=n >tvalues</span><span class=o >.</span><span class=n >name</span> <span class=o >=</span> <span class=s2 >"tvalues"</span>
        <span class=k >return</span> <span class=n >tvalues</span></div>

<div class=viewcode-block  id=ARCHModelResult.convergence_flag ><a class=viewcode-back  href="../../../univariate/generated/generated/arch.univariate.base.ARCHModelResult.convergence_flag.html#arch.univariate.base.ARCHModelResult.convergence_flag">[docs]</a>    <span class=nd >@cached_property</span>
    <span class=k >def</span> <span class=nf >convergence_flag</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=nb >int</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        scipy.optimize.minimize result flag</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_optim_output</span><span class=o >.</span><span class=n >status</span></div>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >optimization_result</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >OptimizeResult</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Information about the covergence of the loglikelihood optimization</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        optim_result : OptimizeResult</span>
<span class=sd >            Result from numerical optimization of the log-likelihood.</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_optim_output</span></div>


<span class=k >def</span> <span class=nf >_align_forecast</span><span class=p >(</span>
    <span class=n >f</span><span class=p >:</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >,</span> <span class=n >align</span><span class=p >:</span> <span class=n >Literal</span><span class=p >[</span><span class=s2 >"origin"</span><span class=p >,</span> <span class=s2 >"target"</span><span class=p >]</span>
<span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >:</span>
    <span class=k >if</span> <span class=n >align</span> <span class=o >==</span> <span class=s2 >"origin"</span><span class=p >:</span>
        <span class=k >return</span> <span class=n >f</span>
    <span class=k >elif</span> <span class=n >align</span> <span class=ow >in</span> <span class=p >(</span><span class=s2 >"target"</span><span class=p >,</span> <span class=s2 >"horizon"</span><span class=p >):</span>
        <span class=k >for</span> <span class=n >i</span><span class=p >,</span> <span class=n >col</span> <span class=ow >in</span> <span class=nb >enumerate</span><span class=p >(</span><span class=n >f</span><span class=p >):</span>
            <span class=n >f</span><span class=p >[</span><span class=n >col</span><span class=p >]</span> <span class=o >=</span> <span class=n >f</span><span class=p >[</span><span class=n >col</span><span class=p >]</span><span class=o >.</span><span class=n >shift</span><span class=p >(</span><span class=n >i</span> <span class=o >+</span> <span class=mi >1</span><span class=p >)</span>
        <span class=k >return</span> <span class=n >f</span>
    <span class=k >else</span><span class=p >:</span>
        <span class=k >raise</span> <span class=ne >ValueError</span><span class=p >(</span><span class=s2 >"Unknown alignment"</span><span class=p >)</span>


<span class=k >def</span> <span class=nf >_format_forecasts</span><span class=p >(</span>
    <span class=n >values</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span> <span class=n >index</span><span class=p >:</span> <span class=nb >list</span><span class=p >[</span><span class=n >Label</span><span class=p >]</span> <span class=o >|</span> <span class=n >pd</span><span class=o >.</span><span class=n >Index</span><span class=p >,</span> <span class=n >start_index</span><span class=p >:</span> <span class=nb >int</span>
<span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >:</span>
    <span class=n >horizon</span> <span class=o >=</span> <span class=n >values</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >1</span><span class=p >]</span>
    <span class=n >format_str</span> <span class=o >=</span> <span class=s2 >"{0:&gt;0"</span> <span class=o >+</span> <span class=nb >str</span><span class=p >(</span><span class=nb >int</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >ceil</span><span class=p >(</span><span class=n >np</span><span class=o >.</span><span class=n >log10</span><span class=p >(</span><span class=n >horizon</span> <span class=o >+</span> <span class=mf >0.5</span><span class=p >))))</span> <span class=o >+</span> <span class=s2 >"}"</span>
    <span class=n >columns</span> <span class=o >=</span> <span class=p >[</span><span class=s2 >"h."</span> <span class=o >+</span> <span class=n >format_str</span><span class=o >.</span><span class=n >format</span><span class=p >(</span><span class=n >h</span> <span class=o >+</span> <span class=mi >1</span><span class=p >)</span> <span class=k >for</span> <span class=n >h</span> <span class=ow >in</span> <span class=nb >range</span><span class=p >(</span><span class=n >horizon</span><span class=p >)]</span>
    <span class=n >forecasts</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >(</span>
        <span class=n >values</span><span class=p >,</span> <span class=n >index</span><span class=o >=</span><span class=n >index</span><span class=p >[</span><span class=n >start_index</span><span class=p >:],</span> <span class=n >columns</span><span class=o >=</span><span class=n >columns</span><span class=p >,</span> <span class=n >dtype</span><span class=o >=</span><span class=s2 >"float"</span>
    <span class=p >)</span>
    <span class=k >return</span> <span class=n >forecasts</span>


<div class=viewcode-block  id=ARCHModelForecastSimulation ><a class=viewcode-back  href="../../../univariate/generated/arch.univariate.base.ARCHModelForecastSimulation.html#arch.univariate.base.ARCHModelForecastSimulation">[docs]</a><span class=k >class</span> <span class=nc >ARCHModelForecastSimulation</span><span class=p >:</span>
    <span class=sd >"""</span>
<span class=sd >    Container for a simulation or bootstrap-based forecasts from an ARCH Model</span>

<span class=sd >    Parameters</span>
<span class=sd >    ----------</span>
<span class=sd >    index</span>
<span class=sd >    values</span>
<span class=sd >    residuals</span>
<span class=sd >    variances</span>
<span class=sd >    residual_variances</span>
<span class=sd >    """</span>

    <span class=k >def</span> <span class=fm >__init__</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >index</span><span class=p >:</span> <span class=nb >list</span><span class=p >[</span><span class=n >Label</span><span class=p >]</span> <span class=o >|</span> <span class=n >pd</span><span class=o >.</span><span class=n >Index</span><span class=p >,</span>
        <span class=n >values</span><span class=p >:</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >residuals</span><span class=p >:</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >variances</span><span class=p >:</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >residual_variances</span><span class=p >:</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span><span class=p >:</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_index</span> <span class=o >=</span> <span class=n >pd</span><span class=o >.</span><span class=n >Index</span><span class=p >(</span><span class=n >index</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_values</span> <span class=o >=</span> <span class=n >values</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_residuals</span> <span class=o >=</span> <span class=n >residuals</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_variances</span> <span class=o >=</span> <span class=n >variances</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_residual_variances</span> <span class=o >=</span> <span class=n >residual_variances</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >index</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >Index</span><span class=p >:</span>
        <span class=sd >"""The index aligned to dimension 0 of the simulation paths"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_index</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >values</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span><span class=p >:</span>
        <span class=sd >"""The values of the process"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_values</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >residuals</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span><span class=p >:</span>
        <span class=sd >"""Simulated residuals used to produce the values"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_residuals</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >variances</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span><span class=p >:</span>
        <span class=sd >"""Simulated variances of the values"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_variances</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >residual_variances</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span><span class=p >:</span>
        <span class=sd >"""Simulated variance of the residuals"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_residual_variances</span></div>


<span class=k >def</span> <span class=nf >_reindex</span><span class=p >(</span>
    <span class=n >a</span><span class=p >:</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span><span class=p >,</span> <span class=n >idx</span><span class=p >:</span> <span class=nb >list</span><span class=p >[</span><span class=n >Label</span><span class=p >]</span> <span class=o >|</span> <span class=n >pd</span><span class=o >.</span><span class=n >Index</span>
<span class=p >)</span> <span class=o >-&gt;</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span><span class=p >:</span>
    <span class=k >if</span> <span class=n >a</span> <span class=ow >is</span> <span class=kc >None</span><span class=p >:</span>
        <span class=k >return</span> <span class=n >a</span>
    <span class=k >assert</span> <span class=n >a</span> <span class=ow >is</span> <span class=ow >not</span> <span class=kc >None</span>
    <span class=n >actual</span> <span class=o >=</span> <span class=nb >len</span><span class=p >(</span><span class=n >idx</span><span class=p >)</span>
    <span class=n >obs</span> <span class=o >=</span> <span class=n >a</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >0</span><span class=p >]</span>
    <span class=k >if</span> <span class=n >actual</span> <span class=o >&gt;</span> <span class=n >obs</span><span class=p >:</span>
        <span class=n >addition</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >full</span><span class=p >((</span><span class=n >actual</span> <span class=o >-</span> <span class=n >obs</span><span class=p >,)</span> <span class=o >+</span> <span class=n >a</span><span class=o >.</span><span class=n >shape</span><span class=p >[</span><span class=mi >1</span><span class=p >:],</span> <span class=n >np</span><span class=o >.</span><span class=n >nan</span><span class=p >)</span>
        <span class=n >a</span> <span class=o >=</span> <span class=n >np</span><span class=o >.</span><span class=n >concatenate</span><span class=p >([</span><span class=n >addition</span><span class=p >,</span> <span class=n >a</span><span class=p >])</span>
    <span class=k >return</span> <span class=n >a</span>


<div class=viewcode-block  id=ARCHModelForecast ><a class=viewcode-back  href="../../../univariate/generated/arch.univariate.base.ARCHModelForecast.html#arch.univariate.base.ARCHModelForecast">[docs]</a><span class=k >class</span> <span class=nc >ARCHModelForecast</span><span class=p >:</span>
    <span class=sd >"""</span>
<span class=sd >    Container for forecasts from an ARCH Model</span>

<span class=sd >    Parameters</span>
<span class=sd >    ----------</span>
<span class=sd >    index : {list, ndarray}</span>
<span class=sd >    mean : ndarray</span>
<span class=sd >    variance : ndarray</span>
<span class=sd >    residual_variance : ndarray</span>
<span class=sd >    simulated_paths : ndarray, optional</span>
<span class=sd >    simulated_variances : ndarray, optional</span>
<span class=sd >    simulated_residual_variances : ndarray, optional</span>
<span class=sd >    simulated_residuals : ndarray, optional</span>
<span class=sd >    align : {'origin', 'target'}</span>
<span class=sd >    """</span>

    <span class=k >def</span> <span class=fm >__init__</span><span class=p >(</span>
        <span class=bp >self</span><span class=p >,</span>
        <span class=n >index</span><span class=p >:</span> <span class=nb >list</span><span class=p >[</span><span class=n >Label</span><span class=p >]</span> <span class=o >|</span> <span class=n >pd</span><span class=o >.</span><span class=n >Index</span><span class=p >,</span>
        <span class=n >start_index</span><span class=p >:</span> <span class=nb >int</span><span class=p >,</span>
        <span class=n >mean</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >variance</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >residual_variance</span><span class=p >:</span> <span class=n >Float64Array</span><span class=p >,</span>
        <span class=n >simulated_paths</span><span class=p >:</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >simulated_variances</span><span class=p >:</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >simulated_residual_variances</span><span class=p >:</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >simulated_residuals</span><span class=p >:</span> <span class=n >Float64Array</span> <span class=o >|</span> <span class=kc >None</span> <span class=o >=</span> <span class=kc >None</span><span class=p >,</span>
        <span class=n >align</span><span class=p >:</span> <span class=n >Literal</span><span class=p >[</span><span class=s2 >"origin"</span><span class=p >,</span> <span class=s2 >"target"</span><span class=p >]</span> <span class=o >=</span> <span class=s2 >"origin"</span><span class=p >,</span>
        <span class=o >*</span><span class=p >,</span>
        <span class=n >reindex</span><span class=p >:</span> <span class=nb >bool</span> <span class=o >=</span> <span class=kc >False</span><span class=p >,</span>
    <span class=p >)</span> <span class=o >-&gt;</span> <span class=kc >None</span><span class=p >:</span>
        <span class=n >mean_df</span> <span class=o >=</span> <span class=n >_format_forecasts</span><span class=p >(</span><span class=n >mean</span><span class=p >,</span> <span class=n >index</span><span class=p >,</span> <span class=n >start_index</span><span class=p >)</span>
        <span class=n >variance_df</span> <span class=o >=</span> <span class=n >_format_forecasts</span><span class=p >(</span><span class=n >variance</span><span class=p >,</span> <span class=n >index</span><span class=p >,</span> <span class=n >start_index</span><span class=p >)</span>
        <span class=n >residual_variance_df</span> <span class=o >=</span> <span class=n >_format_forecasts</span><span class=p >(</span><span class=n >residual_variance</span><span class=p >,</span> <span class=n >index</span><span class=p >,</span> <span class=n >start_index</span><span class=p >)</span>
        <span class=k >if</span> <span class=n >reindex</span><span class=p >:</span>
            <span class=n >mean_df</span> <span class=o >=</span> <span class=n >mean_df</span><span class=o >.</span><span class=n >reindex</span><span class=p >(</span><span class=n >index</span><span class=p >)</span>
            <span class=n >variance_df</span> <span class=o >=</span> <span class=n >variance_df</span><span class=o >.</span><span class=n >reindex</span><span class=p >(</span><span class=n >index</span><span class=p >)</span>
            <span class=n >residual_variance_df</span> <span class=o >=</span> <span class=n >residual_variance_df</span><span class=o >.</span><span class=n >reindex</span><span class=p >(</span><span class=n >index</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_mean</span> <span class=o >=</span> <span class=n >_align_forecast</span><span class=p >(</span><span class=n >mean_df</span><span class=p >,</span> <span class=n >align</span><span class=o >=</span><span class=n >align</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_variance</span> <span class=o >=</span> <span class=n >_align_forecast</span><span class=p >(</span><span class=n >variance_df</span><span class=p >,</span> <span class=n >align</span><span class=o >=</span><span class=n >align</span><span class=p >)</span>
        <span class=bp >self</span><span class=o >.</span><span class=n >_residual_variance</span> <span class=o >=</span> <span class=n >_align_forecast</span><span class=p >(</span><span class=n >residual_variance_df</span><span class=p >,</span> <span class=n >align</span><span class=o >=</span><span class=n >align</span><span class=p >)</span>

        <span class=k >if</span> <span class=n >reindex</span><span class=p >:</span>
            <span class=n >sim_index</span> <span class=o >=</span> <span class=n >index</span>
            <span class=n >simulated_paths</span> <span class=o >=</span> <span class=n >_reindex</span><span class=p >(</span><span class=n >simulated_paths</span><span class=p >,</span> <span class=n >index</span><span class=p >)</span>
            <span class=n >simulated_residuals</span> <span class=o >=</span> <span class=n >_reindex</span><span class=p >(</span><span class=n >simulated_residuals</span><span class=p >,</span> <span class=n >index</span><span class=p >)</span>
            <span class=n >simulated_variances</span> <span class=o >=</span> <span class=n >_reindex</span><span class=p >(</span><span class=n >simulated_variances</span><span class=p >,</span> <span class=n >index</span><span class=p >)</span>
            <span class=n >simulated_residual_variances</span> <span class=o >=</span> <span class=n >_reindex</span><span class=p >(</span><span class=n >simulated_residual_variances</span><span class=p >,</span> <span class=n >index</span><span class=p >)</span>
        <span class=k >else</span><span class=p >:</span>
            <span class=n >sim_index</span> <span class=o >=</span> <span class=n >index</span><span class=p >[</span><span class=n >start_index</span><span class=p >:]</span>

        <span class=bp >self</span><span class=o >.</span><span class=n >_sim</span> <span class=o >=</span> <span class=n >ARCHModelForecastSimulation</span><span class=p >(</span>
            <span class=n >sim_index</span><span class=p >,</span>
            <span class=n >simulated_paths</span><span class=p >,</span>
            <span class=n >simulated_residuals</span><span class=p >,</span>
            <span class=n >simulated_variances</span><span class=p >,</span>
            <span class=n >simulated_residual_variances</span><span class=p >,</span>
        <span class=p >)</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >mean</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >:</span>
        <span class=sd >"""Forecast values for the conditional mean of the process"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_mean</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >variance</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >:</span>
        <span class=sd >"""Forecast values for the conditional variance of the process"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_variance</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >residual_variance</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >pd</span><span class=o >.</span><span class=n >DataFrame</span><span class=p >:</span>
        <span class=sd >"""Forecast values for the conditional variance of the residuals"""</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_residual_variance</span>

    <span class=nd >@property</span>
    <span class=k >def</span> <span class=nf >simulations</span><span class=p >(</span><span class=bp >self</span><span class=p >)</span> <span class=o >-&gt;</span> <span class=n >ARCHModelForecastSimulation</span><span class=p >:</span>
        <span class=sd >"""</span>
<span class=sd >        Detailed simulation results if using a simulation-based method</span>

<span class=sd >        Returns</span>
<span class=sd >        -------</span>
<span class=sd >        ARCHModelForecastSimulation</span>
<span class=sd >            Container for simulation results</span>
<span class=sd >        """</span>
        <span class=k >return</span> <span class=bp >self</span><span class=o >.</span><span class=n >_sim</span></div>
</pre></div> </article> </div> </div> </main> </div> <footer class=md-footer > <div class=md-footer-nav > <nav class="md-footer-nav__inner md-grid"> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright > <div class=md-footer-copyright__highlight > &#169; Copyright 2021, Kevin Sheppard. </div> Created using <a href="http://www.sphinx-doc.org/">Sphinx</a> 5.0.2. and <a href="https://github.com/bashtage/sphinx-material/">Material for Sphinx</a> </div> </div> </div> </footer> <script src="../../../_static/javascripts/application.js"></script> <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>